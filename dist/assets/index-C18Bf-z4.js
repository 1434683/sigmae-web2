function d_(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function h_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var jx={exports:{}},hc={},Cx={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oa=Symbol.for("react.element"),f_=Symbol.for("react.portal"),m_=Symbol.for("react.fragment"),p_=Symbol.for("react.strict_mode"),g_=Symbol.for("react.profiler"),x_=Symbol.for("react.provider"),y_=Symbol.for("react.context"),v_=Symbol.for("react.forward_ref"),w_=Symbol.for("react.suspense"),__=Symbol.for("react.memo"),E_=Symbol.for("react.lazy"),Wm=Symbol.iterator;function A_(t){return t===null||typeof t!="object"?null:(t=Wm&&t[Wm]||t["@@iterator"],typeof t=="function"?t:null)}var bx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Rx=Object.assign,Dx={};function No(t,e,n){this.props=t,this.context=e,this.refs=Dx,this.updater=n||bx}No.prototype.isReactComponent={};No.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};No.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kx(){}kx.prototype=No.prototype;function _h(t,e,n){this.props=t,this.context=e,this.refs=Dx,this.updater=n||bx}var Eh=_h.prototype=new kx;Eh.constructor=_h;Rx(Eh,No.prototype);Eh.isPureReactComponent=!0;var Hm=Array.isArray,Px=Object.prototype.hasOwnProperty,Ah={current:null},Ox={key:!0,ref:!0,__self:!0,__source:!0};function Lx(t,e,n){var r,s={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)Px.call(e,r)&&!Ox.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:oa,type:t,key:o,ref:a,props:s,_owner:Ah.current}}function S_(t,e){return{$$typeof:oa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sh(t){return typeof t=="object"&&t!==null&&t.$$typeof===oa}function N_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Qm=/\/+/g;function hu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?N_(""+t.key):e.toString(36)}function nl(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case oa:case f_:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+hu(a,0):r,Hm(s)?(n="",t!=null&&(n=t.replace(Qm,"$&/")+"/"),nl(s,e,n,"",function(d){return d})):s!=null&&(Sh(s)&&(s=S_(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Qm,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Hm(t))for(var c=0;c<t.length;c++){o=t[c];var u=r+hu(o,c);a+=nl(o,e,n,u,s)}else if(u=A_(t),typeof u=="function")for(t=u.call(t),c=0;!(o=t.next()).done;)o=o.value,u=r+hu(o,c++),a+=nl(o,e,n,u,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Da(t,e,n){if(t==null)return t;var r=[],s=0;return nl(t,r,"","",function(o){return e.call(n,o,s++)}),r}function I_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var zt={current:null},rl={transition:null},T_={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:rl,ReactCurrentOwner:Ah};function Vx(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:Da,forEach:function(t,e,n){Da(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Da(t,function(){e++}),e},toArray:function(t){return Da(t,function(e){return e})||[]},only:function(t){if(!Sh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ge.Component=No;ge.Fragment=m_;ge.Profiler=g_;ge.PureComponent=_h;ge.StrictMode=p_;ge.Suspense=w_;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T_;ge.act=Vx;ge.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Rx({},t.props),s=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=Ah.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)Px.call(e,u)&&!Ox.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:oa,type:t.type,key:s,ref:o,props:r,_owner:a}};ge.createContext=function(t){return t={$$typeof:y_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:x_,_context:t},t.Consumer=t};ge.createElement=Lx;ge.createFactory=function(t){var e=Lx.bind(null,t);return e.type=t,e};ge.createRef=function(){return{current:null}};ge.forwardRef=function(t){return{$$typeof:v_,render:t}};ge.isValidElement=Sh;ge.lazy=function(t){return{$$typeof:E_,_payload:{_status:-1,_result:t},_init:I_}};ge.memo=function(t,e){return{$$typeof:__,type:t,compare:e===void 0?null:e}};ge.startTransition=function(t){var e=rl.transition;rl.transition={};try{t()}finally{rl.transition=e}};ge.unstable_act=Vx;ge.useCallback=function(t,e){return zt.current.useCallback(t,e)};ge.useContext=function(t){return zt.current.useContext(t)};ge.useDebugValue=function(){};ge.useDeferredValue=function(t){return zt.current.useDeferredValue(t)};ge.useEffect=function(t,e){return zt.current.useEffect(t,e)};ge.useId=function(){return zt.current.useId()};ge.useImperativeHandle=function(t,e,n){return zt.current.useImperativeHandle(t,e,n)};ge.useInsertionEffect=function(t,e){return zt.current.useInsertionEffect(t,e)};ge.useLayoutEffect=function(t,e){return zt.current.useLayoutEffect(t,e)};ge.useMemo=function(t,e){return zt.current.useMemo(t,e)};ge.useReducer=function(t,e,n){return zt.current.useReducer(t,e,n)};ge.useRef=function(t){return zt.current.useRef(t)};ge.useState=function(t){return zt.current.useState(t)};ge.useSyncExternalStore=function(t,e,n){return zt.current.useSyncExternalStore(t,e,n)};ge.useTransition=function(){return zt.current.useTransition()};ge.version="18.3.1";Cx.exports=ge;var N=Cx.exports;const Nh=h_(N),j_=d_({__proto__:null,default:Nh},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C_=N,b_=Symbol.for("react.element"),R_=Symbol.for("react.fragment"),D_=Object.prototype.hasOwnProperty,k_=C_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,P_={key:!0,ref:!0,__self:!0,__source:!0};function Mx(t,e,n){var r,s={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)D_.call(e,r)&&!P_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:b_,type:t,key:o,ref:a,props:s,_owner:k_.current}}hc.Fragment=R_;hc.jsx=Mx;hc.jsxs=Mx;jx.exports=hc;var i=jx.exports,Ju={},Fx={exports:{}},un={},Bx={exports:{}},Ux={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(k,G){var W=k.length;k.push(G);e:for(;0<W;){var Z=W-1>>>1,ne=k[Z];if(0<s(ne,G))k[Z]=G,k[W]=ne,W=Z;else break e}}function n(k){return k.length===0?null:k[0]}function r(k){if(k.length===0)return null;var G=k[0],W=k.pop();if(W!==G){k[0]=W;e:for(var Z=0,ne=k.length,oe=ne>>>1;Z<oe;){var re=2*(Z+1)-1,Re=k[re],pe=re+1,tt=k[pe];if(0>s(Re,W))pe<ne&&0>s(tt,Re)?(k[Z]=tt,k[pe]=W,Z=pe):(k[Z]=Re,k[re]=W,Z=re);else if(pe<ne&&0>s(tt,W))k[Z]=tt,k[pe]=W,Z=pe;else break e}}return G}function s(k,G){var W=k.sortIndex-G.sortIndex;return W!==0?W:k.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var u=[],d=[],m=1,f=null,p=3,w=!1,C=!1,R=!1,D=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(k){for(var G=n(d);G!==null;){if(G.callback===null)r(d);else if(G.startTime<=k)r(d),G.sortIndex=G.expirationTime,e(u,G);else break;G=n(d)}}function L(k){if(R=!1,I(k),!C)if(n(u)!==null)C=!0,F(B);else{var G=n(d);G!==null&&O(L,G.startTime-k)}}function B(k,G){C=!1,R&&(R=!1,x(_),_=-1),w=!0;var W=p;try{for(I(G),f=n(u);f!==null&&(!(f.expirationTime>G)||k&&!b());){var Z=f.callback;if(typeof Z=="function"){f.callback=null,p=f.priorityLevel;var ne=Z(f.expirationTime<=G);G=t.unstable_now(),typeof ne=="function"?f.callback=ne:f===n(u)&&r(u),I(G)}else r(u);f=n(u)}if(f!==null)var oe=!0;else{var re=n(d);re!==null&&O(L,re.startTime-G),oe=!1}return oe}finally{f=null,p=W,w=!1}}var M=!1,S=null,_=-1,y=5,j=-1;function b(){return!(t.unstable_now()-j<y)}function T(){if(S!==null){var k=t.unstable_now();j=k;var G=!0;try{G=S(!0,k)}finally{G?E():(M=!1,S=null)}}else M=!1}var E;if(typeof v=="function")E=function(){v(T)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,P=Q.port2;Q.port1.onmessage=T,E=function(){P.postMessage(null)}}else E=function(){D(T,0)};function F(k){S=k,M||(M=!0,E())}function O(k,G){_=D(function(){k(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(k){k.callback=null},t.unstable_continueExecution=function(){C||w||(C=!0,F(B))},t.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<k?Math.floor(1e3/k):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(k){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var W=p;p=G;try{return k()}finally{p=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(k,G){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var W=p;p=k;try{return G()}finally{p=W}},t.unstable_scheduleCallback=function(k,G,W){var Z=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?Z+W:Z):W=Z,k){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=W+ne,k={id:m++,callback:G,priorityLevel:k,startTime:W,expirationTime:ne,sortIndex:-1},W>Z?(k.sortIndex=W,e(d,k),n(u)===null&&k===n(d)&&(R?(x(_),_=-1):R=!0,O(L,W-Z))):(k.sortIndex=ne,e(u,k),C||w||(C=!0,F(B))),k},t.unstable_shouldYield=b,t.unstable_wrapCallback=function(k){var G=p;return function(){var W=p;p=G;try{return k.apply(this,arguments)}finally{p=W}}}})(Ux);Bx.exports=Ux;var O_=Bx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L_=N,an=O_;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $x=new Set,Ri={};function Ts(t,e){co(t,e),co(t+"Capture",e)}function co(t,e){for(Ri[t]=e,t=0;t<e.length;t++)$x.add(e[t])}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zu=Object.prototype.hasOwnProperty,V_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Km={},Xm={};function M_(t){return Zu.call(Xm,t)?!0:Zu.call(Km,t)?!1:V_.test(t)?Xm[t]=!0:(Km[t]=!0,!1)}function F_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function B_(t,e,n,r){if(e===null||typeof e>"u"||F_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Gt(t,e,n,r,s,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var Tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tt[t]=new Gt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tt[e]=new Gt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tt[t]=new Gt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tt[t]=new Gt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tt[t]=new Gt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tt[t]=new Gt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tt[t]=new Gt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tt[t]=new Gt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tt[t]=new Gt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ih=/[\-:]([a-z])/g;function Th(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ih,Th);Tt[e]=new Gt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ih,Th);Tt[e]=new Gt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ih,Th);Tt[e]=new Gt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tt[t]=new Gt(t,1,!1,t.toLowerCase(),null,!1,!1)});Tt.xlinkHref=new Gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tt[t]=new Gt(t,1,!1,t.toLowerCase(),null,!0,!0)});function jh(t,e,n,r){var s=Tt.hasOwnProperty(e)?Tt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(B_(e,n,s,r)&&(n=null),r||s===null?M_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var sr=L_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ka=Symbol.for("react.element"),$s=Symbol.for("react.portal"),zs=Symbol.for("react.fragment"),Ch=Symbol.for("react.strict_mode"),ed=Symbol.for("react.profiler"),zx=Symbol.for("react.provider"),Gx=Symbol.for("react.context"),bh=Symbol.for("react.forward_ref"),td=Symbol.for("react.suspense"),nd=Symbol.for("react.suspense_list"),Rh=Symbol.for("react.memo"),xr=Symbol.for("react.lazy"),qx=Symbol.for("react.offscreen"),Ym=Symbol.iterator;function ei(t){return t===null||typeof t!="object"?null:(t=Ym&&t[Ym]||t["@@iterator"],typeof t=="function"?t:null)}var Ge=Object.assign,fu;function li(t){if(fu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);fu=e&&e[1]||""}return`
`+fu+t}var mu=!1;function pu(t,e){if(!t||mu)return"";mu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=r.stack.split(`
`),a=s.length-1,c=o.length-1;1<=a&&0<=c&&s[a]!==o[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==o[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==o[c]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=c);break}}}finally{mu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?li(t):""}function U_(t){switch(t.tag){case 5:return li(t.type);case 16:return li("Lazy");case 13:return li("Suspense");case 19:return li("SuspenseList");case 0:case 2:case 15:return t=pu(t.type,!1),t;case 11:return t=pu(t.type.render,!1),t;case 1:return t=pu(t.type,!0),t;default:return""}}function rd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zs:return"Fragment";case $s:return"Portal";case ed:return"Profiler";case Ch:return"StrictMode";case td:return"Suspense";case nd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Gx:return(t.displayName||"Context")+".Consumer";case zx:return(t._context.displayName||"Context")+".Provider";case bh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rh:return e=t.displayName||null,e!==null?e:rd(t.type)||"Memo";case xr:e=t._payload,t=t._init;try{return rd(t(e))}catch{}}return null}function $_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rd(e);case 8:return e===Ch?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Br(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Wx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function z_(t){var e=Wx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Pa(t){t._valueTracker||(t._valueTracker=z_(t))}function Hx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Wx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function El(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function sd(t,e){var n=e.checked;return Ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Jm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Br(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Qx(t,e){e=e.checked,e!=null&&jh(t,"checked",e,!1)}function od(t,e){Qx(t,e);var n=Br(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?id(t,e.type,n):e.hasOwnProperty("defaultValue")&&id(t,e.type,Br(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Zm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function id(t,e,n){(e!=="number"||El(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ci=Array.isArray;function to(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Br(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function ad(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return Ge({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ep(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(ci(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Br(n)}}function Kx(t,e){var n=Br(e.value),r=Br(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function tp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Xx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ld(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Xx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Oa,Yx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Oa=Oa||document.createElement("div"),Oa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Oa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Di(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var pi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},G_=["Webkit","ms","Moz","O"];Object.keys(pi).forEach(function(t){G_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pi[e]=pi[t]})});function Jx(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||pi.hasOwnProperty(t)&&pi[t]?(""+e).trim():e+"px"}function Zx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Jx(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var q_=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cd(t,e){if(e){if(q_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function ud(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dd=null;function Dh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var hd=null,no=null,ro=null;function np(t){if(t=la(t)){if(typeof hd!="function")throw Error(K(280));var e=t.stateNode;e&&(e=xc(e),hd(t.stateNode,t.type,e))}}function ey(t){no?ro?ro.push(t):ro=[t]:no=t}function ty(){if(no){var t=no,e=ro;if(ro=no=null,np(t),e)for(t=0;t<e.length;t++)np(e[t])}}function ny(t,e){return t(e)}function ry(){}var gu=!1;function sy(t,e,n){if(gu)return t(e,n);gu=!0;try{return ny(t,e,n)}finally{gu=!1,(no!==null||ro!==null)&&(ry(),ty())}}function ki(t,e){var n=t.stateNode;if(n===null)return null;var r=xc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var fd=!1;if(Xn)try{var ti={};Object.defineProperty(ti,"passive",{get:function(){fd=!0}}),window.addEventListener("test",ti,ti),window.removeEventListener("test",ti,ti)}catch{fd=!1}function W_(t,e,n,r,s,o,a,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(m){this.onError(m)}}var gi=!1,Al=null,Sl=!1,md=null,H_={onError:function(t){gi=!0,Al=t}};function Q_(t,e,n,r,s,o,a,c,u){gi=!1,Al=null,W_.apply(H_,arguments)}function K_(t,e,n,r,s,o,a,c,u){if(Q_.apply(this,arguments),gi){if(gi){var d=Al;gi=!1,Al=null}else throw Error(K(198));Sl||(Sl=!0,md=d)}}function js(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function oy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function rp(t){if(js(t)!==t)throw Error(K(188))}function X_(t){var e=t.alternate;if(!e){if(e=js(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return rp(s),t;if(o===r)return rp(s),e;o=o.sibling}throw Error(K(188))}if(n.return!==r.return)n=s,r=o;else{for(var a=!1,c=s.child;c;){if(c===n){a=!0,n=s,r=o;break}if(c===r){a=!0,r=s,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=s;break}if(c===r){a=!0,r=o,n=s;break}c=c.sibling}if(!a)throw Error(K(189))}}if(n.alternate!==r)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function iy(t){return t=X_(t),t!==null?ay(t):null}function ay(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ay(t);if(e!==null)return e;t=t.sibling}return null}var ly=an.unstable_scheduleCallback,sp=an.unstable_cancelCallback,Y_=an.unstable_shouldYield,J_=an.unstable_requestPaint,et=an.unstable_now,Z_=an.unstable_getCurrentPriorityLevel,kh=an.unstable_ImmediatePriority,cy=an.unstable_UserBlockingPriority,Nl=an.unstable_NormalPriority,e1=an.unstable_LowPriority,uy=an.unstable_IdlePriority,fc=null,Vn=null;function t1(t){if(Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(fc,t,void 0,(t.current.flags&128)===128)}catch{}}var Sn=Math.clz32?Math.clz32:s1,n1=Math.log,r1=Math.LN2;function s1(t){return t>>>=0,t===0?32:31-(n1(t)/r1|0)|0}var La=64,Va=4194304;function ui(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Il(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var c=a&~s;c!==0?r=ui(c):(o&=a,o!==0&&(r=ui(o)))}else a=n&~s,a!==0?r=ui(a):o!==0&&(r=ui(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Sn(e),s=1<<n,r|=t[n],e&=~s;return r}function o1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function i1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-Sn(o),c=1<<a,u=s[a];u===-1?(!(c&n)||c&r)&&(s[a]=o1(c,e)):u<=e&&(t.expiredLanes|=c),o&=~c}}function pd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function dy(){var t=La;return La<<=1,!(La&4194240)&&(La=64),t}function xu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ia(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Sn(e),t[e]=n}function a1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Sn(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function Ph(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Sn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ie=0;function hy(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var fy,Oh,my,py,gy,gd=!1,Ma=[],Ir=null,Tr=null,jr=null,Pi=new Map,Oi=new Map,vr=[],l1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function op(t,e){switch(t){case"focusin":case"focusout":Ir=null;break;case"dragenter":case"dragleave":Tr=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":Pi.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oi.delete(e.pointerId)}}function ni(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=la(e),e!==null&&Oh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function c1(t,e,n,r,s){switch(e){case"focusin":return Ir=ni(Ir,t,e,n,r,s),!0;case"dragenter":return Tr=ni(Tr,t,e,n,r,s),!0;case"mouseover":return jr=ni(jr,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return Pi.set(o,ni(Pi.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Oi.set(o,ni(Oi.get(o)||null,t,e,n,r,s)),!0}return!1}function xy(t){var e=hs(t.target);if(e!==null){var n=js(e);if(n!==null){if(e=n.tag,e===13){if(e=oy(n),e!==null){t.blockedOn=e,gy(t.priority,function(){my(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function sl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=xd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);dd=r,n.target.dispatchEvent(r),dd=null}else return e=la(n),e!==null&&Oh(e),t.blockedOn=n,!1;e.shift()}return!0}function ip(t,e,n){sl(t)&&n.delete(e)}function u1(){gd=!1,Ir!==null&&sl(Ir)&&(Ir=null),Tr!==null&&sl(Tr)&&(Tr=null),jr!==null&&sl(jr)&&(jr=null),Pi.forEach(ip),Oi.forEach(ip)}function ri(t,e){t.blockedOn===e&&(t.blockedOn=null,gd||(gd=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,u1)))}function Li(t){function e(s){return ri(s,t)}if(0<Ma.length){ri(Ma[0],t);for(var n=1;n<Ma.length;n++){var r=Ma[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ir!==null&&ri(Ir,t),Tr!==null&&ri(Tr,t),jr!==null&&ri(jr,t),Pi.forEach(e),Oi.forEach(e),n=0;n<vr.length;n++)r=vr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<vr.length&&(n=vr[0],n.blockedOn===null);)xy(n),n.blockedOn===null&&vr.shift()}var so=sr.ReactCurrentBatchConfig,Tl=!0;function d1(t,e,n,r){var s=Ie,o=so.transition;so.transition=null;try{Ie=1,Lh(t,e,n,r)}finally{Ie=s,so.transition=o}}function h1(t,e,n,r){var s=Ie,o=so.transition;so.transition=null;try{Ie=4,Lh(t,e,n,r)}finally{Ie=s,so.transition=o}}function Lh(t,e,n,r){if(Tl){var s=xd(t,e,n,r);if(s===null)Tu(t,e,r,jl,n),op(t,r);else if(c1(s,t,e,n,r))r.stopPropagation();else if(op(t,r),e&4&&-1<l1.indexOf(t)){for(;s!==null;){var o=la(s);if(o!==null&&fy(o),o=xd(t,e,n,r),o===null&&Tu(t,e,r,jl,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else Tu(t,e,r,null,n)}}var jl=null;function xd(t,e,n,r){if(jl=null,t=Dh(r),t=hs(t),t!==null)if(e=js(t),e===null)t=null;else if(n=e.tag,n===13){if(t=oy(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return jl=t,null}function yy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z_()){case kh:return 1;case cy:return 4;case Nl:case e1:return 16;case uy:return 536870912;default:return 16}default:return 16}}var _r=null,Vh=null,ol=null;function vy(){if(ol)return ol;var t,e=Vh,n=e.length,r,s="value"in _r?_r.value:_r.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[o-r];r++);return ol=s.slice(t,1<r?1-r:void 0)}function il(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Fa(){return!0}function ap(){return!1}function dn(t){function e(n,r,s,o,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Fa:ap,this.isPropagationStopped=ap,this}return Ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fa)},persist:function(){},isPersistent:Fa}),e}var Io={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mh=dn(Io),aa=Ge({},Io,{view:0,detail:0}),f1=dn(aa),yu,vu,si,mc=Ge({},aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==si&&(si&&t.type==="mousemove"?(yu=t.screenX-si.screenX,vu=t.screenY-si.screenY):vu=yu=0,si=t),yu)},movementY:function(t){return"movementY"in t?t.movementY:vu}}),lp=dn(mc),m1=Ge({},mc,{dataTransfer:0}),p1=dn(m1),g1=Ge({},aa,{relatedTarget:0}),wu=dn(g1),x1=Ge({},Io,{animationName:0,elapsedTime:0,pseudoElement:0}),y1=dn(x1),v1=Ge({},Io,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),w1=dn(v1),_1=Ge({},Io,{data:0}),cp=dn(_1),E1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},A1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},S1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function N1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=S1[t])?!!e[t]:!1}function Fh(){return N1}var I1=Ge({},aa,{key:function(t){if(t.key){var e=E1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=il(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?A1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fh,charCode:function(t){return t.type==="keypress"?il(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?il(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),T1=dn(I1),j1=Ge({},mc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),up=dn(j1),C1=Ge({},aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fh}),b1=dn(C1),R1=Ge({},Io,{propertyName:0,elapsedTime:0,pseudoElement:0}),D1=dn(R1),k1=Ge({},mc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),P1=dn(k1),O1=[9,13,27,32],Bh=Xn&&"CompositionEvent"in window,xi=null;Xn&&"documentMode"in document&&(xi=document.documentMode);var L1=Xn&&"TextEvent"in window&&!xi,wy=Xn&&(!Bh||xi&&8<xi&&11>=xi),dp=" ",hp=!1;function _y(t,e){switch(t){case"keyup":return O1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ey(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Gs=!1;function V1(t,e){switch(t){case"compositionend":return Ey(e);case"keypress":return e.which!==32?null:(hp=!0,dp);case"textInput":return t=e.data,t===dp&&hp?null:t;default:return null}}function M1(t,e){if(Gs)return t==="compositionend"||!Bh&&_y(t,e)?(t=vy(),ol=Vh=_r=null,Gs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wy&&e.locale!=="ko"?null:e.data;default:return null}}var F1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!F1[t.type]:e==="textarea"}function Ay(t,e,n,r){ey(r),e=Cl(e,"onChange"),0<e.length&&(n=new Mh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var yi=null,Vi=null;function B1(t){Py(t,0)}function pc(t){var e=Hs(t);if(Hx(e))return t}function U1(t,e){if(t==="change")return e}var Sy=!1;if(Xn){var _u;if(Xn){var Eu="oninput"in document;if(!Eu){var mp=document.createElement("div");mp.setAttribute("oninput","return;"),Eu=typeof mp.oninput=="function"}_u=Eu}else _u=!1;Sy=_u&&(!document.documentMode||9<document.documentMode)}function pp(){yi&&(yi.detachEvent("onpropertychange",Ny),Vi=yi=null)}function Ny(t){if(t.propertyName==="value"&&pc(Vi)){var e=[];Ay(e,Vi,t,Dh(t)),sy(B1,e)}}function $1(t,e,n){t==="focusin"?(pp(),yi=e,Vi=n,yi.attachEvent("onpropertychange",Ny)):t==="focusout"&&pp()}function z1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return pc(Vi)}function G1(t,e){if(t==="click")return pc(e)}function q1(t,e){if(t==="input"||t==="change")return pc(e)}function W1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var In=typeof Object.is=="function"?Object.is:W1;function Mi(t,e){if(In(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Zu.call(e,s)||!In(t[s],e[s]))return!1}return!0}function gp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function xp(t,e){var n=gp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=gp(n)}}function Iy(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Iy(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ty(){for(var t=window,e=El();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=El(t.document)}return e}function Uh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function H1(t){var e=Ty(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Iy(n.ownerDocument.documentElement,n)){if(r!==null&&Uh(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=xp(n,o);var a=xp(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Q1=Xn&&"documentMode"in document&&11>=document.documentMode,qs=null,yd=null,vi=null,vd=!1;function yp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;vd||qs==null||qs!==El(r)||(r=qs,"selectionStart"in r&&Uh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vi&&Mi(vi,r)||(vi=r,r=Cl(yd,"onSelect"),0<r.length&&(e=new Mh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=qs)))}function Ba(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ws={animationend:Ba("Animation","AnimationEnd"),animationiteration:Ba("Animation","AnimationIteration"),animationstart:Ba("Animation","AnimationStart"),transitionend:Ba("Transition","TransitionEnd")},Au={},jy={};Xn&&(jy=document.createElement("div").style,"AnimationEvent"in window||(delete Ws.animationend.animation,delete Ws.animationiteration.animation,delete Ws.animationstart.animation),"TransitionEvent"in window||delete Ws.transitionend.transition);function gc(t){if(Au[t])return Au[t];if(!Ws[t])return t;var e=Ws[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in jy)return Au[t]=e[n];return t}var Cy=gc("animationend"),by=gc("animationiteration"),Ry=gc("animationstart"),Dy=gc("transitionend"),ky=new Map,vp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qr(t,e){ky.set(t,e),Ts(e,[t])}for(var Su=0;Su<vp.length;Su++){var Nu=vp[Su],K1=Nu.toLowerCase(),X1=Nu[0].toUpperCase()+Nu.slice(1);Qr(K1,"on"+X1)}Qr(Cy,"onAnimationEnd");Qr(by,"onAnimationIteration");Qr(Ry,"onAnimationStart");Qr("dblclick","onDoubleClick");Qr("focusin","onFocus");Qr("focusout","onBlur");Qr(Dy,"onTransitionEnd");co("onMouseEnter",["mouseout","mouseover"]);co("onMouseLeave",["mouseout","mouseover"]);co("onPointerEnter",["pointerout","pointerover"]);co("onPointerLeave",["pointerout","pointerover"]);Ts("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ts("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ts("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ts("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ts("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ts("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y1=new Set("cancel close invalid load scroll toggle".split(" ").concat(di));function wp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,K_(r,e,void 0,t),t.currentTarget=null}function Py(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var c=r[a],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==o&&s.isPropagationStopped())break e;wp(s,c,d),o=u}else for(a=0;a<r.length;a++){if(c=r[a],u=c.instance,d=c.currentTarget,c=c.listener,u!==o&&s.isPropagationStopped())break e;wp(s,c,d),o=u}}}if(Sl)throw t=md,Sl=!1,md=null,t}function Pe(t,e){var n=e[Sd];n===void 0&&(n=e[Sd]=new Set);var r=t+"__bubble";n.has(r)||(Oy(e,t,2,!1),n.add(r))}function Iu(t,e,n){var r=0;e&&(r|=4),Oy(n,t,r,e)}var Ua="_reactListening"+Math.random().toString(36).slice(2);function Fi(t){if(!t[Ua]){t[Ua]=!0,$x.forEach(function(n){n!=="selectionchange"&&(Y1.has(n)||Iu(n,!1,t),Iu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ua]||(e[Ua]=!0,Iu("selectionchange",!1,e))}}function Oy(t,e,n,r){switch(yy(e)){case 1:var s=d1;break;case 4:s=h1;break;default:s=Lh}n=s.bind(null,e,n,t),s=void 0,!fd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Tu(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;c!==null;){if(a=hs(c),a===null)return;if(u=a.tag,u===5||u===6){r=o=a;continue e}c=c.parentNode}}r=r.return}sy(function(){var d=o,m=Dh(n),f=[];e:{var p=ky.get(t);if(p!==void 0){var w=Mh,C=t;switch(t){case"keypress":if(il(n)===0)break e;case"keydown":case"keyup":w=T1;break;case"focusin":C="focus",w=wu;break;case"focusout":C="blur",w=wu;break;case"beforeblur":case"afterblur":w=wu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=lp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=p1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=b1;break;case Cy:case by:case Ry:w=y1;break;case Dy:w=D1;break;case"scroll":w=f1;break;case"wheel":w=P1;break;case"copy":case"cut":case"paste":w=w1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=up}var R=(e&4)!==0,D=!R&&t==="scroll",x=R?p!==null?p+"Capture":null:p;R=[];for(var v=d,I;v!==null;){I=v;var L=I.stateNode;if(I.tag===5&&L!==null&&(I=L,x!==null&&(L=ki(v,x),L!=null&&R.push(Bi(v,L,I)))),D)break;v=v.return}0<R.length&&(p=new w(p,C,null,n,m),f.push({event:p,listeners:R}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",p&&n!==dd&&(C=n.relatedTarget||n.fromElement)&&(hs(C)||C[Yn]))break e;if((w||p)&&(p=m.window===m?m:(p=m.ownerDocument)?p.defaultView||p.parentWindow:window,w?(C=n.relatedTarget||n.toElement,w=d,C=C?hs(C):null,C!==null&&(D=js(C),C!==D||C.tag!==5&&C.tag!==6)&&(C=null)):(w=null,C=d),w!==C)){if(R=lp,L="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(R=up,L="onPointerLeave",x="onPointerEnter",v="pointer"),D=w==null?p:Hs(w),I=C==null?p:Hs(C),p=new R(L,v+"leave",w,n,m),p.target=D,p.relatedTarget=I,L=null,hs(m)===d&&(R=new R(x,v+"enter",C,n,m),R.target=I,R.relatedTarget=D,L=R),D=L,w&&C)t:{for(R=w,x=C,v=0,I=R;I;I=Vs(I))v++;for(I=0,L=x;L;L=Vs(L))I++;for(;0<v-I;)R=Vs(R),v--;for(;0<I-v;)x=Vs(x),I--;for(;v--;){if(R===x||x!==null&&R===x.alternate)break t;R=Vs(R),x=Vs(x)}R=null}else R=null;w!==null&&_p(f,p,w,R,!1),C!==null&&D!==null&&_p(f,D,C,R,!0)}}e:{if(p=d?Hs(d):window,w=p.nodeName&&p.nodeName.toLowerCase(),w==="select"||w==="input"&&p.type==="file")var B=U1;else if(fp(p))if(Sy)B=q1;else{B=z1;var M=$1}else(w=p.nodeName)&&w.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(B=G1);if(B&&(B=B(t,d))){Ay(f,B,n,m);break e}M&&M(t,p,d),t==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&id(p,"number",p.value)}switch(M=d?Hs(d):window,t){case"focusin":(fp(M)||M.contentEditable==="true")&&(qs=M,yd=d,vi=null);break;case"focusout":vi=yd=qs=null;break;case"mousedown":vd=!0;break;case"contextmenu":case"mouseup":case"dragend":vd=!1,yp(f,n,m);break;case"selectionchange":if(Q1)break;case"keydown":case"keyup":yp(f,n,m)}var S;if(Bh)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Gs?_y(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(wy&&n.locale!=="ko"&&(Gs||_!=="onCompositionStart"?_==="onCompositionEnd"&&Gs&&(S=vy()):(_r=m,Vh="value"in _r?_r.value:_r.textContent,Gs=!0)),M=Cl(d,_),0<M.length&&(_=new cp(_,t,null,n,m),f.push({event:_,listeners:M}),S?_.data=S:(S=Ey(n),S!==null&&(_.data=S)))),(S=L1?V1(t,n):M1(t,n))&&(d=Cl(d,"onBeforeInput"),0<d.length&&(m=new cp("onBeforeInput","beforeinput",null,n,m),f.push({event:m,listeners:d}),m.data=S))}Py(f,e)})}function Bi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Cl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=ki(t,n),o!=null&&r.unshift(Bi(t,o,s)),o=ki(t,e),o!=null&&r.push(Bi(t,o,s))),t=t.return}return r}function Vs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function _p(t,e,n,r,s){for(var o=e._reactName,a=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=ki(n,o),u!=null&&a.unshift(Bi(n,u,c))):s||(u=ki(n,o),u!=null&&a.push(Bi(n,u,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var J1=/\r\n?/g,Z1=/\u0000|\uFFFD/g;function Ep(t){return(typeof t=="string"?t:""+t).replace(J1,`
`).replace(Z1,"")}function $a(t,e,n){if(e=Ep(e),Ep(t)!==e&&n)throw Error(K(425))}function bl(){}var wd=null,_d=null;function Ed(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ad=typeof setTimeout=="function"?setTimeout:void 0,eE=typeof clearTimeout=="function"?clearTimeout:void 0,Ap=typeof Promise=="function"?Promise:void 0,tE=typeof queueMicrotask=="function"?queueMicrotask:typeof Ap<"u"?function(t){return Ap.resolve(null).then(t).catch(nE)}:Ad;function nE(t){setTimeout(function(){throw t})}function ju(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Li(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Li(e)}function Cr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Sp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var To=Math.random().toString(36).slice(2),Ln="__reactFiber$"+To,Ui="__reactProps$"+To,Yn="__reactContainer$"+To,Sd="__reactEvents$"+To,rE="__reactListeners$"+To,sE="__reactHandles$"+To;function hs(t){var e=t[Ln];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Yn]||n[Ln]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Sp(t);t!==null;){if(n=t[Ln])return n;t=Sp(t)}return e}t=n,n=t.parentNode}return null}function la(t){return t=t[Ln]||t[Yn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function xc(t){return t[Ui]||null}var Nd=[],Qs=-1;function Kr(t){return{current:t}}function Le(t){0>Qs||(t.current=Nd[Qs],Nd[Qs]=null,Qs--)}function De(t,e){Qs++,Nd[Qs]=t.current,t.current=e}var Ur={},Vt=Kr(Ur),Qt=Kr(!1),ws=Ur;function uo(t,e){var n=t.type.contextTypes;if(!n)return Ur;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Kt(t){return t=t.childContextTypes,t!=null}function Rl(){Le(Qt),Le(Vt)}function Np(t,e,n){if(Vt.current!==Ur)throw Error(K(168));De(Vt,e),De(Qt,n)}function Ly(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(K(108,$_(t)||"Unknown",s));return Ge({},n,r)}function Dl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ur,ws=Vt.current,De(Vt,t),De(Qt,Qt.current),!0}function Ip(t,e,n){var r=t.stateNode;if(!r)throw Error(K(169));n?(t=Ly(t,e,ws),r.__reactInternalMemoizedMergedChildContext=t,Le(Qt),Le(Vt),De(Vt,t)):Le(Qt),De(Qt,n)}var qn=null,yc=!1,Cu=!1;function Vy(t){qn===null?qn=[t]:qn.push(t)}function oE(t){yc=!0,Vy(t)}function Xr(){if(!Cu&&qn!==null){Cu=!0;var t=0,e=Ie;try{var n=qn;for(Ie=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}qn=null,yc=!1}catch(s){throw qn!==null&&(qn=qn.slice(t+1)),ly(kh,Xr),s}finally{Ie=e,Cu=!1}}return null}var Ks=[],Xs=0,kl=null,Pl=0,hn=[],fn=0,_s=null,Wn=1,Hn="";function cs(t,e){Ks[Xs++]=Pl,Ks[Xs++]=kl,kl=t,Pl=e}function My(t,e,n){hn[fn++]=Wn,hn[fn++]=Hn,hn[fn++]=_s,_s=t;var r=Wn;t=Hn;var s=32-Sn(r)-1;r&=~(1<<s),n+=1;var o=32-Sn(e)+s;if(30<o){var a=s-s%5;o=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Wn=1<<32-Sn(e)+s|n<<s|r,Hn=o+t}else Wn=1<<o|n<<s|r,Hn=t}function $h(t){t.return!==null&&(cs(t,1),My(t,1,0))}function zh(t){for(;t===kl;)kl=Ks[--Xs],Ks[Xs]=null,Pl=Ks[--Xs],Ks[Xs]=null;for(;t===_s;)_s=hn[--fn],hn[fn]=null,Hn=hn[--fn],hn[fn]=null,Wn=hn[--fn],hn[fn]=null}var rn=null,tn=null,Me=!1,An=null;function Fy(t,e){var n=mn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Tp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rn=t,tn=Cr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rn=t,tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_s!==null?{id:Wn,overflow:Hn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=mn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,rn=t,tn=null,!0):!1;default:return!1}}function Id(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Td(t){if(Me){var e=tn;if(e){var n=e;if(!Tp(t,e)){if(Id(t))throw Error(K(418));e=Cr(n.nextSibling);var r=rn;e&&Tp(t,e)?Fy(r,n):(t.flags=t.flags&-4097|2,Me=!1,rn=t)}}else{if(Id(t))throw Error(K(418));t.flags=t.flags&-4097|2,Me=!1,rn=t}}}function jp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rn=t}function za(t){if(t!==rn)return!1;if(!Me)return jp(t),Me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ed(t.type,t.memoizedProps)),e&&(e=tn)){if(Id(t))throw By(),Error(K(418));for(;e;)Fy(t,e),e=Cr(e.nextSibling)}if(jp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){tn=Cr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}tn=null}}else tn=rn?Cr(t.stateNode.nextSibling):null;return!0}function By(){for(var t=tn;t;)t=Cr(t.nextSibling)}function ho(){tn=rn=null,Me=!1}function Gh(t){An===null?An=[t]:An.push(t)}var iE=sr.ReactCurrentBatchConfig;function oi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var r=n.stateNode}if(!r)throw Error(K(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var c=s.refs;a===null?delete c[o]:c[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function Ga(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Cp(t){var e=t._init;return e(t._payload)}function Uy(t){function e(x,v){if(t){var I=x.deletions;I===null?(x.deletions=[v],x.flags|=16):I.push(v)}}function n(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function r(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function s(x,v){return x=kr(x,v),x.index=0,x.sibling=null,x}function o(x,v,I){return x.index=I,t?(I=x.alternate,I!==null?(I=I.index,I<v?(x.flags|=2,v):I):(x.flags|=2,v)):(x.flags|=1048576,v)}function a(x){return t&&x.alternate===null&&(x.flags|=2),x}function c(x,v,I,L){return v===null||v.tag!==6?(v=Lu(I,x.mode,L),v.return=x,v):(v=s(v,I),v.return=x,v)}function u(x,v,I,L){var B=I.type;return B===zs?m(x,v,I.props.children,L,I.key):v!==null&&(v.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===xr&&Cp(B)===v.type)?(L=s(v,I.props),L.ref=oi(x,v,I),L.return=x,L):(L=fl(I.type,I.key,I.props,null,x.mode,L),L.ref=oi(x,v,I),L.return=x,L)}function d(x,v,I,L){return v===null||v.tag!==4||v.stateNode.containerInfo!==I.containerInfo||v.stateNode.implementation!==I.implementation?(v=Vu(I,x.mode,L),v.return=x,v):(v=s(v,I.children||[]),v.return=x,v)}function m(x,v,I,L,B){return v===null||v.tag!==7?(v=xs(I,x.mode,L,B),v.return=x,v):(v=s(v,I),v.return=x,v)}function f(x,v,I){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Lu(""+v,x.mode,I),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ka:return I=fl(v.type,v.key,v.props,null,x.mode,I),I.ref=oi(x,null,v),I.return=x,I;case $s:return v=Vu(v,x.mode,I),v.return=x,v;case xr:var L=v._init;return f(x,L(v._payload),I)}if(ci(v)||ei(v))return v=xs(v,x.mode,I,null),v.return=x,v;Ga(x,v)}return null}function p(x,v,I,L){var B=v!==null?v.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return B!==null?null:c(x,v,""+I,L);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case ka:return I.key===B?u(x,v,I,L):null;case $s:return I.key===B?d(x,v,I,L):null;case xr:return B=I._init,p(x,v,B(I._payload),L)}if(ci(I)||ei(I))return B!==null?null:m(x,v,I,L,null);Ga(x,I)}return null}function w(x,v,I,L,B){if(typeof L=="string"&&L!==""||typeof L=="number")return x=x.get(I)||null,c(v,x,""+L,B);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case ka:return x=x.get(L.key===null?I:L.key)||null,u(v,x,L,B);case $s:return x=x.get(L.key===null?I:L.key)||null,d(v,x,L,B);case xr:var M=L._init;return w(x,v,I,M(L._payload),B)}if(ci(L)||ei(L))return x=x.get(I)||null,m(v,x,L,B,null);Ga(v,L)}return null}function C(x,v,I,L){for(var B=null,M=null,S=v,_=v=0,y=null;S!==null&&_<I.length;_++){S.index>_?(y=S,S=null):y=S.sibling;var j=p(x,S,I[_],L);if(j===null){S===null&&(S=y);break}t&&S&&j.alternate===null&&e(x,S),v=o(j,v,_),M===null?B=j:M.sibling=j,M=j,S=y}if(_===I.length)return n(x,S),Me&&cs(x,_),B;if(S===null){for(;_<I.length;_++)S=f(x,I[_],L),S!==null&&(v=o(S,v,_),M===null?B=S:M.sibling=S,M=S);return Me&&cs(x,_),B}for(S=r(x,S);_<I.length;_++)y=w(S,x,_,I[_],L),y!==null&&(t&&y.alternate!==null&&S.delete(y.key===null?_:y.key),v=o(y,v,_),M===null?B=y:M.sibling=y,M=y);return t&&S.forEach(function(b){return e(x,b)}),Me&&cs(x,_),B}function R(x,v,I,L){var B=ei(I);if(typeof B!="function")throw Error(K(150));if(I=B.call(I),I==null)throw Error(K(151));for(var M=B=null,S=v,_=v=0,y=null,j=I.next();S!==null&&!j.done;_++,j=I.next()){S.index>_?(y=S,S=null):y=S.sibling;var b=p(x,S,j.value,L);if(b===null){S===null&&(S=y);break}t&&S&&b.alternate===null&&e(x,S),v=o(b,v,_),M===null?B=b:M.sibling=b,M=b,S=y}if(j.done)return n(x,S),Me&&cs(x,_),B;if(S===null){for(;!j.done;_++,j=I.next())j=f(x,j.value,L),j!==null&&(v=o(j,v,_),M===null?B=j:M.sibling=j,M=j);return Me&&cs(x,_),B}for(S=r(x,S);!j.done;_++,j=I.next())j=w(S,x,_,j.value,L),j!==null&&(t&&j.alternate!==null&&S.delete(j.key===null?_:j.key),v=o(j,v,_),M===null?B=j:M.sibling=j,M=j);return t&&S.forEach(function(T){return e(x,T)}),Me&&cs(x,_),B}function D(x,v,I,L){if(typeof I=="object"&&I!==null&&I.type===zs&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case ka:e:{for(var B=I.key,M=v;M!==null;){if(M.key===B){if(B=I.type,B===zs){if(M.tag===7){n(x,M.sibling),v=s(M,I.props.children),v.return=x,x=v;break e}}else if(M.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===xr&&Cp(B)===M.type){n(x,M.sibling),v=s(M,I.props),v.ref=oi(x,M,I),v.return=x,x=v;break e}n(x,M);break}else e(x,M);M=M.sibling}I.type===zs?(v=xs(I.props.children,x.mode,L,I.key),v.return=x,x=v):(L=fl(I.type,I.key,I.props,null,x.mode,L),L.ref=oi(x,v,I),L.return=x,x=L)}return a(x);case $s:e:{for(M=I.key;v!==null;){if(v.key===M)if(v.tag===4&&v.stateNode.containerInfo===I.containerInfo&&v.stateNode.implementation===I.implementation){n(x,v.sibling),v=s(v,I.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else e(x,v);v=v.sibling}v=Vu(I,x.mode,L),v.return=x,x=v}return a(x);case xr:return M=I._init,D(x,v,M(I._payload),L)}if(ci(I))return C(x,v,I,L);if(ei(I))return R(x,v,I,L);Ga(x,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,v!==null&&v.tag===6?(n(x,v.sibling),v=s(v,I),v.return=x,x=v):(n(x,v),v=Lu(I,x.mode,L),v.return=x,x=v),a(x)):n(x,v)}return D}var fo=Uy(!0),$y=Uy(!1),Ol=Kr(null),Ll=null,Ys=null,qh=null;function Wh(){qh=Ys=Ll=null}function Hh(t){var e=Ol.current;Le(Ol),t._currentValue=e}function jd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function oo(t,e){Ll=t,qh=Ys=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ht=!0),t.firstContext=null)}function gn(t){var e=t._currentValue;if(qh!==t)if(t={context:t,memoizedValue:e,next:null},Ys===null){if(Ll===null)throw Error(K(308));Ys=t,Ll.dependencies={lanes:0,firstContext:t}}else Ys=Ys.next=t;return e}var fs=null;function Qh(t){fs===null?fs=[t]:fs.push(t)}function zy(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Qh(e)):(n.next=s.next,s.next=n),e.interleaved=n,Jn(t,r)}function Jn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var yr=!1;function Kh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function br(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Se&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Jn(t,n)}return s=r.interleaved,s===null?(e.next=e,Qh(r)):(e.next=s.next,s.next=e),r.interleaved=e,Jn(t,n)}function al(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ph(t,n)}}function bp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Vl(t,e,n,r){var s=t.updateQueue;yr=!1;var o=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,a===null?o=d:a.next=d,a=u;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==a&&(c===null?m.firstBaseUpdate=d:c.next=d,m.lastBaseUpdate=u))}if(o!==null){var f=s.baseState;a=0,m=d=u=null,c=o;do{var p=c.lane,w=c.eventTime;if((r&p)===p){m!==null&&(m=m.next={eventTime:w,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var C=t,R=c;switch(p=e,w=n,R.tag){case 1:if(C=R.payload,typeof C=="function"){f=C.call(w,f,p);break e}f=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=R.payload,p=typeof C=="function"?C.call(w,f,p):C,p==null)break e;f=Ge({},f,p);break e;case 2:yr=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[c]:p.push(c))}else w={eventTime:w,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(d=m=w,u=f):m=m.next=w,a|=p;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;p=c,c=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(m===null&&(u=f),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=m,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);As|=a,t.lanes=a,t.memoizedState=f}}function Rp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(K(191,s));s.call(r)}}}var ca={},Mn=Kr(ca),$i=Kr(ca),zi=Kr(ca);function ms(t){if(t===ca)throw Error(K(174));return t}function Xh(t,e){switch(De(zi,e),De($i,t),De(Mn,ca),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ld(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ld(e,t)}Le(Mn),De(Mn,e)}function mo(){Le(Mn),Le($i),Le(zi)}function qy(t){ms(zi.current);var e=ms(Mn.current),n=ld(e,t.type);e!==n&&(De($i,t),De(Mn,n))}function Yh(t){$i.current===t&&(Le(Mn),Le($i))}var Ue=Kr(0);function Ml(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var bu=[];function Jh(){for(var t=0;t<bu.length;t++)bu[t]._workInProgressVersionPrimary=null;bu.length=0}var ll=sr.ReactCurrentDispatcher,Ru=sr.ReactCurrentBatchConfig,Es=0,$e=null,ht=null,vt=null,Fl=!1,wi=!1,Gi=0,aE=0;function bt(){throw Error(K(321))}function Zh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!In(t[n],e[n]))return!1;return!0}function ef(t,e,n,r,s,o){if(Es=o,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ll.current=t===null||t.memoizedState===null?dE:hE,t=n(r,s),wi){o=0;do{if(wi=!1,Gi=0,25<=o)throw Error(K(301));o+=1,vt=ht=null,e.updateQueue=null,ll.current=fE,t=n(r,s)}while(wi)}if(ll.current=Bl,e=ht!==null&&ht.next!==null,Es=0,vt=ht=$e=null,Fl=!1,e)throw Error(K(300));return t}function tf(){var t=Gi!==0;return Gi=0,t}function Pn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?$e.memoizedState=vt=t:vt=vt.next=t,vt}function xn(){if(ht===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=ht.next;var e=vt===null?$e.memoizedState:vt.next;if(e!==null)vt=e,ht=t;else{if(t===null)throw Error(K(310));ht=t,t={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},vt===null?$e.memoizedState=vt=t:vt=vt.next=t}return vt}function qi(t,e){return typeof e=="function"?e(t):e}function Du(t){var e=xn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=ht,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var c=a=null,u=null,d=o;do{var m=d.lane;if((Es&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=f,a=r):u=u.next=f,$e.lanes|=m,As|=m}d=d.next}while(d!==null&&d!==o);u===null?a=r:u.next=c,In(r,e.memoizedState)||(Ht=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,$e.lanes|=o,As|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ku(t){var e=xn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do o=t(o,a.action),a=a.next;while(a!==s);In(o,e.memoizedState)||(Ht=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Wy(){}function Hy(t,e){var n=$e,r=xn(),s=e(),o=!In(r.memoizedState,s);if(o&&(r.memoizedState=s,Ht=!0),r=r.queue,nf(Xy.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||vt!==null&&vt.memoizedState.tag&1){if(n.flags|=2048,Wi(9,Ky.bind(null,n,r,s,e),void 0,null),_t===null)throw Error(K(349));Es&30||Qy(n,e,s)}return s}function Qy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ky(t,e,n,r){e.value=n,e.getSnapshot=r,Yy(e)&&Jy(t)}function Xy(t,e,n){return n(function(){Yy(e)&&Jy(t)})}function Yy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!In(t,n)}catch{return!0}}function Jy(t){var e=Jn(t,1);e!==null&&Nn(e,t,1,-1)}function Dp(t){var e=Pn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:t},e.queue=t,t=t.dispatch=uE.bind(null,$e,t),[e.memoizedState,t]}function Wi(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Zy(){return xn().memoizedState}function cl(t,e,n,r){var s=Pn();$e.flags|=t,s.memoizedState=Wi(1|e,n,void 0,r===void 0?null:r)}function vc(t,e,n,r){var s=xn();r=r===void 0?null:r;var o=void 0;if(ht!==null){var a=ht.memoizedState;if(o=a.destroy,r!==null&&Zh(r,a.deps)){s.memoizedState=Wi(e,n,o,r);return}}$e.flags|=t,s.memoizedState=Wi(1|e,n,o,r)}function kp(t,e){return cl(8390656,8,t,e)}function nf(t,e){return vc(2048,8,t,e)}function e0(t,e){return vc(4,2,t,e)}function t0(t,e){return vc(4,4,t,e)}function n0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function r0(t,e,n){return n=n!=null?n.concat([t]):null,vc(4,4,n0.bind(null,e,t),n)}function rf(){}function s0(t,e){var n=xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function o0(t,e){var n=xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function i0(t,e,n){return Es&21?(In(n,e)||(n=dy(),$e.lanes|=n,As|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ht=!0),t.memoizedState=n)}function lE(t,e){var n=Ie;Ie=n!==0&&4>n?n:4,t(!0);var r=Ru.transition;Ru.transition={};try{t(!1),e()}finally{Ie=n,Ru.transition=r}}function a0(){return xn().memoizedState}function cE(t,e,n){var r=Dr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},l0(t))c0(e,n);else if(n=zy(t,e,n,r),n!==null){var s=$t();Nn(n,t,r,s),u0(n,e,r)}}function uE(t,e,n){var r=Dr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(l0(t))c0(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,c=o(a,n);if(s.hasEagerState=!0,s.eagerState=c,In(c,a)){var u=e.interleaved;u===null?(s.next=s,Qh(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=zy(t,e,s,r),n!==null&&(s=$t(),Nn(n,t,r,s),u0(n,e,r))}}function l0(t){var e=t.alternate;return t===$e||e!==null&&e===$e}function c0(t,e){wi=Fl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function u0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ph(t,n)}}var Bl={readContext:gn,useCallback:bt,useContext:bt,useEffect:bt,useImperativeHandle:bt,useInsertionEffect:bt,useLayoutEffect:bt,useMemo:bt,useReducer:bt,useRef:bt,useState:bt,useDebugValue:bt,useDeferredValue:bt,useTransition:bt,useMutableSource:bt,useSyncExternalStore:bt,useId:bt,unstable_isNewReconciler:!1},dE={readContext:gn,useCallback:function(t,e){return Pn().memoizedState=[t,e===void 0?null:e],t},useContext:gn,useEffect:kp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,cl(4194308,4,n0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return cl(4194308,4,t,e)},useInsertionEffect:function(t,e){return cl(4,2,t,e)},useMemo:function(t,e){var n=Pn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Pn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=cE.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var e=Pn();return t={current:t},e.memoizedState=t},useState:Dp,useDebugValue:rf,useDeferredValue:function(t){return Pn().memoizedState=t},useTransition:function(){var t=Dp(!1),e=t[0];return t=lE.bind(null,t[1]),Pn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$e,s=Pn();if(Me){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),_t===null)throw Error(K(349));Es&30||Qy(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,kp(Xy.bind(null,r,o,t),[t]),r.flags|=2048,Wi(9,Ky.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Pn(),e=_t.identifierPrefix;if(Me){var n=Hn,r=Wn;n=(r&~(1<<32-Sn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Gi++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=aE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},hE={readContext:gn,useCallback:s0,useContext:gn,useEffect:nf,useImperativeHandle:r0,useInsertionEffect:e0,useLayoutEffect:t0,useMemo:o0,useReducer:Du,useRef:Zy,useState:function(){return Du(qi)},useDebugValue:rf,useDeferredValue:function(t){var e=xn();return i0(e,ht.memoizedState,t)},useTransition:function(){var t=Du(qi)[0],e=xn().memoizedState;return[t,e]},useMutableSource:Wy,useSyncExternalStore:Hy,useId:a0,unstable_isNewReconciler:!1},fE={readContext:gn,useCallback:s0,useContext:gn,useEffect:nf,useImperativeHandle:r0,useInsertionEffect:e0,useLayoutEffect:t0,useMemo:o0,useReducer:ku,useRef:Zy,useState:function(){return ku(qi)},useDebugValue:rf,useDeferredValue:function(t){var e=xn();return ht===null?e.memoizedState=t:i0(e,ht.memoizedState,t)},useTransition:function(){var t=ku(qi)[0],e=xn().memoizedState;return[t,e]},useMutableSource:Wy,useSyncExternalStore:Hy,useId:a0,unstable_isNewReconciler:!1};function _n(t,e){if(t&&t.defaultProps){e=Ge({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Cd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ge({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var wc={isMounted:function(t){return(t=t._reactInternals)?js(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=$t(),s=Dr(t),o=Qn(r,s);o.payload=e,n!=null&&(o.callback=n),e=br(t,o,s),e!==null&&(Nn(e,t,s,r),al(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=$t(),s=Dr(t),o=Qn(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=br(t,o,s),e!==null&&(Nn(e,t,s,r),al(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=$t(),r=Dr(t),s=Qn(n,r);s.tag=2,e!=null&&(s.callback=e),e=br(t,s,r),e!==null&&(Nn(e,t,r,n),al(e,t,r))}};function Pp(t,e,n,r,s,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!Mi(n,r)||!Mi(s,o):!0}function d0(t,e,n){var r=!1,s=Ur,o=e.contextType;return typeof o=="object"&&o!==null?o=gn(o):(s=Kt(e)?ws:Vt.current,r=e.contextTypes,o=(r=r!=null)?uo(t,s):Ur),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=wc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function Op(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&wc.enqueueReplaceState(e,e.state,null)}function bd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Kh(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=gn(o):(o=Kt(e)?ws:Vt.current,s.context=uo(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Cd(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&wc.enqueueReplaceState(s,s.state,null),Vl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function po(t,e){try{var n="",r=e;do n+=U_(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Pu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Rd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var mE=typeof WeakMap=="function"?WeakMap:Map;function h0(t,e,n){n=Qn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){$l||($l=!0,Ud=r),Rd(t,e)},n}function f0(t,e,n){n=Qn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Rd(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Rd(t,e),typeof r!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Lp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new mE;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=jE.bind(null,t,e,n),e.then(t,t))}function Vp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Mp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qn(-1,1),e.tag=2,br(n,e,1))),n.lanes|=1),t)}var pE=sr.ReactCurrentOwner,Ht=!1;function Bt(t,e,n,r){e.child=t===null?$y(e,null,n,r):fo(e,t.child,n,r)}function Fp(t,e,n,r,s){n=n.render;var o=e.ref;return oo(e,s),r=ef(t,e,n,r,o,s),n=tf(),t!==null&&!Ht?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Zn(t,e,s)):(Me&&n&&$h(e),e.flags|=1,Bt(t,e,r,s),e.child)}function Bp(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!hf(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,m0(t,e,o,r,s)):(t=fl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:Mi,n(a,r)&&t.ref===e.ref)return Zn(t,e,s)}return e.flags|=1,t=kr(o,r),t.ref=e.ref,t.return=e,e.child=t}function m0(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(Mi(o,r)&&t.ref===e.ref)if(Ht=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(Ht=!0);else return e.lanes=t.lanes,Zn(t,e,s)}return Dd(t,e,n,r,s)}function p0(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(Zs,Zt),Zt|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,De(Zs,Zt),Zt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,De(Zs,Zt),Zt|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,De(Zs,Zt),Zt|=r;return Bt(t,e,s,n),e.child}function g0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Dd(t,e,n,r,s){var o=Kt(n)?ws:Vt.current;return o=uo(e,o),oo(e,s),n=ef(t,e,n,r,o,s),r=tf(),t!==null&&!Ht?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Zn(t,e,s)):(Me&&r&&$h(e),e.flags|=1,Bt(t,e,n,s),e.child)}function Up(t,e,n,r,s){if(Kt(n)){var o=!0;Dl(e)}else o=!1;if(oo(e,s),e.stateNode===null)ul(t,e),d0(e,n,r),bd(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,c=e.memoizedProps;a.props=c;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=gn(d):(d=Kt(n)?ws:Vt.current,d=uo(e,d));var m=n.getDerivedStateFromProps,f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||u!==d)&&Op(e,a,r,d),yr=!1;var p=e.memoizedState;a.state=p,Vl(e,r,a,s),u=e.memoizedState,c!==r||p!==u||Qt.current||yr?(typeof m=="function"&&(Cd(e,n,m,r),u=e.memoizedState),(c=yr||Pp(e,n,c,r,p,u,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=d,r=c):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Gy(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:_n(e.type,c),a.props=d,f=e.pendingProps,p=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=gn(u):(u=Kt(n)?ws:Vt.current,u=uo(e,u));var w=n.getDerivedStateFromProps;(m=typeof w=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==f||p!==u)&&Op(e,a,r,u),yr=!1,p=e.memoizedState,a.state=p,Vl(e,r,a,s);var C=e.memoizedState;c!==f||p!==C||Qt.current||yr?(typeof w=="function"&&(Cd(e,n,w,r),C=e.memoizedState),(d=yr||Pp(e,n,d,r,p,C,u)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,C,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,C,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),a.props=r,a.state=C,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return kd(t,e,n,r,o,s)}function kd(t,e,n,r,s,o){g0(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&Ip(e,n,!1),Zn(t,e,o);r=e.stateNode,pE.current=e;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=fo(e,t.child,null,o),e.child=fo(e,null,c,o)):Bt(t,e,c,o),e.memoizedState=r.state,s&&Ip(e,n,!0),e.child}function x0(t){var e=t.stateNode;e.pendingContext?Np(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Np(t,e.context,!1),Xh(t,e.containerInfo)}function $p(t,e,n,r,s){return ho(),Gh(s),e.flags|=256,Bt(t,e,n,r),e.child}var Pd={dehydrated:null,treeContext:null,retryLane:0};function Od(t){return{baseLanes:t,cachePool:null,transitions:null}}function y0(t,e,n){var r=e.pendingProps,s=Ue.current,o=!1,a=(e.flags&128)!==0,c;if((c=a)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),De(Ue,s&1),t===null)return Td(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Ac(a,r,0,null),t=xs(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Od(n),e.memoizedState=Pd,t):sf(e,a));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return gE(t,e,a,r,c,s,n);if(o){o=r.fallback,a=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=kr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?o=kr(c,o):(o=xs(o,a,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=t.child.memoizedState,a=a===null?Od(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=Pd,r}return o=t.child,t=o.sibling,r=kr(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function sf(t,e){return e=Ac({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function qa(t,e,n,r){return r!==null&&Gh(r),fo(e,t.child,null,n),t=sf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gE(t,e,n,r,s,o,a){if(n)return e.flags&256?(e.flags&=-257,r=Pu(Error(K(422))),qa(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Ac({mode:"visible",children:r.children},s,0,null),o=xs(o,s,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&fo(e,t.child,null,a),e.child.memoizedState=Od(a),e.memoizedState=Pd,o);if(!(e.mode&1))return qa(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,o=Error(K(419)),r=Pu(o,r,void 0),qa(t,e,a,r)}if(c=(a&t.childLanes)!==0,Ht||c){if(r=_t,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Jn(t,s),Nn(r,t,s,-1))}return df(),r=Pu(Error(K(421))),qa(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=CE.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,tn=Cr(s.nextSibling),rn=e,Me=!0,An=null,t!==null&&(hn[fn++]=Wn,hn[fn++]=Hn,hn[fn++]=_s,Wn=t.id,Hn=t.overflow,_s=e),e=sf(e,r.children),e.flags|=4096,e)}function zp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),jd(t.return,e,n)}function Ou(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function v0(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(Bt(t,e,r.children,n),r=Ue.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&zp(t,n,e);else if(t.tag===19)zp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(De(Ue,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ml(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ou(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ml(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ou(e,!0,n,null,o);break;case"together":Ou(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ul(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Zn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),As|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=kr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=kr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function xE(t,e,n){switch(e.tag){case 3:x0(e),ho();break;case 5:qy(e);break;case 1:Kt(e.type)&&Dl(e);break;case 4:Xh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;De(Ol,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(De(Ue,Ue.current&1),e.flags|=128,null):n&e.child.childLanes?y0(t,e,n):(De(Ue,Ue.current&1),t=Zn(t,e,n),t!==null?t.sibling:null);De(Ue,Ue.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return v0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),De(Ue,Ue.current),r)break;return null;case 22:case 23:return e.lanes=0,p0(t,e,n)}return Zn(t,e,n)}var w0,Ld,_0,E0;w0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ld=function(){};_0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ms(Mn.current);var o=null;switch(n){case"input":s=sd(t,s),r=sd(t,r),o=[];break;case"select":s=Ge({},s,{value:void 0}),r=Ge({},r,{value:void 0}),o=[];break;case"textarea":s=ad(t,s),r=ad(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=bl)}cd(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ri.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(o||(o=[]),o.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(o=o||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ri.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Pe("scroll",t),o||c===u||(o=[])):(o=o||[]).push(d,u))}n&&(o=o||[]).push("style",n);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};E0=function(t,e,n,r){n!==r&&(e.flags|=4)};function ii(t,e){if(!Me)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Rt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function yE(t,e,n){var r=e.pendingProps;switch(zh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(e),null;case 1:return Kt(e.type)&&Rl(),Rt(e),null;case 3:return r=e.stateNode,mo(),Le(Qt),Le(Vt),Jh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(za(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,An!==null&&(Gd(An),An=null))),Ld(t,e),Rt(e),null;case 5:Yh(e);var s=ms(zi.current);if(n=e.type,t!==null&&e.stateNode!=null)_0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return Rt(e),null}if(t=ms(Mn.current),za(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Ln]=e,r[Ui]=o,t=(e.mode&1)!==0,n){case"dialog":Pe("cancel",r),Pe("close",r);break;case"iframe":case"object":case"embed":Pe("load",r);break;case"video":case"audio":for(s=0;s<di.length;s++)Pe(di[s],r);break;case"source":Pe("error",r);break;case"img":case"image":case"link":Pe("error",r),Pe("load",r);break;case"details":Pe("toggle",r);break;case"input":Jm(r,o),Pe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Pe("invalid",r);break;case"textarea":ep(r,o),Pe("invalid",r)}cd(n,o),s=null;for(var a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="children"?typeof c=="string"?r.textContent!==c&&(o.suppressHydrationWarning!==!0&&$a(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(o.suppressHydrationWarning!==!0&&$a(r.textContent,c,t),s=["children",""+c]):Ri.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&Pe("scroll",r)}switch(n){case"input":Pa(r),Zm(r,o,!0);break;case"textarea":Pa(r),tp(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=bl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Xx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Ln]=e,t[Ui]=r,w0(t,e,!1,!1),e.stateNode=t;e:{switch(a=ud(n,r),n){case"dialog":Pe("cancel",t),Pe("close",t),s=r;break;case"iframe":case"object":case"embed":Pe("load",t),s=r;break;case"video":case"audio":for(s=0;s<di.length;s++)Pe(di[s],t);s=r;break;case"source":Pe("error",t),s=r;break;case"img":case"image":case"link":Pe("error",t),Pe("load",t),s=r;break;case"details":Pe("toggle",t),s=r;break;case"input":Jm(t,r),s=sd(t,r),Pe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ge({},r,{value:void 0}),Pe("invalid",t);break;case"textarea":ep(t,r),s=ad(t,r),Pe("invalid",t);break;default:s=r}cd(n,s),c=s;for(o in c)if(c.hasOwnProperty(o)){var u=c[o];o==="style"?Zx(t,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Yx(t,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Di(t,u):typeof u=="number"&&Di(t,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ri.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Pe("scroll",t):u!=null&&jh(t,o,u,a))}switch(n){case"input":Pa(t),Zm(t,r,!1);break;case"textarea":Pa(t),tp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Br(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?to(t,!!r.multiple,o,!1):r.defaultValue!=null&&to(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=bl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Rt(e),null;case 6:if(t&&e.stateNode!=null)E0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(n=ms(zi.current),ms(Mn.current),za(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ln]=e,(o=r.nodeValue!==n)&&(t=rn,t!==null))switch(t.tag){case 3:$a(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&$a(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ln]=e,e.stateNode=r}return Rt(e),null;case 13:if(Le(Ue),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Me&&tn!==null&&e.mode&1&&!(e.flags&128))By(),ho(),e.flags|=98560,o=!1;else if(o=za(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(K(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(K(317));o[Ln]=e}else ho(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Rt(e),o=!1}else An!==null&&(Gd(An),An=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ue.current&1?mt===0&&(mt=3):df())),e.updateQueue!==null&&(e.flags|=4),Rt(e),null);case 4:return mo(),Ld(t,e),t===null&&Fi(e.stateNode.containerInfo),Rt(e),null;case 10:return Hh(e.type._context),Rt(e),null;case 17:return Kt(e.type)&&Rl(),Rt(e),null;case 19:if(Le(Ue),o=e.memoizedState,o===null)return Rt(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)ii(o,!1);else{if(mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ml(t),a!==null){for(e.flags|=128,ii(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return De(Ue,Ue.current&1|2),e.child}t=t.sibling}o.tail!==null&&et()>go&&(e.flags|=128,r=!0,ii(o,!1),e.lanes=4194304)}else{if(!r)if(t=Ml(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ii(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Me)return Rt(e),null}else 2*et()-o.renderingStartTime>go&&n!==1073741824&&(e.flags|=128,r=!0,ii(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=et(),e.sibling=null,n=Ue.current,De(Ue,r?n&1|2:n&1),e):(Rt(e),null);case 22:case 23:return uf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Zt&1073741824&&(Rt(e),e.subtreeFlags&6&&(e.flags|=8192)):Rt(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function vE(t,e){switch(zh(e),e.tag){case 1:return Kt(e.type)&&Rl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mo(),Le(Qt),Le(Vt),Jh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yh(e),null;case 13:if(Le(Ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));ho()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Le(Ue),null;case 4:return mo(),null;case 10:return Hh(e.type._context),null;case 22:case 23:return uf(),null;case 24:return null;default:return null}}var Wa=!1,Lt=!1,wE=typeof WeakSet=="function"?WeakSet:Set,te=null;function Js(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ke(t,e,r)}else n.current=null}function Vd(t,e,n){try{n()}catch(r){Ke(t,e,r)}}var Gp=!1;function _E(t,e){if(wd=Tl,t=Ty(),Uh(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,c=-1,u=-1,d=0,m=0,f=t,p=null;t:for(;;){for(var w;f!==n||s!==0&&f.nodeType!==3||(c=a+s),f!==o||r!==0&&f.nodeType!==3||(u=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(w=f.firstChild)!==null;)p=f,f=w;for(;;){if(f===t)break t;if(p===n&&++d===s&&(c=a),p===o&&++m===r&&(u=a),(w=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=w}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(_d={focusedElem:t,selectionRange:n},Tl=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var R=C.memoizedProps,D=C.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?R:_n(e.type,R),D);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(L){Ke(e,e.return,L)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return C=Gp,Gp=!1,C}function _i(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&Vd(e,n,o)}s=s.next}while(s!==r)}}function _c(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Md(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function A0(t){var e=t.alternate;e!==null&&(t.alternate=null,A0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ln],delete e[Ui],delete e[Sd],delete e[rE],delete e[sE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function S0(t){return t.tag===5||t.tag===3||t.tag===4}function qp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||S0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Fd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=bl));else if(r!==4&&(t=t.child,t!==null))for(Fd(t,e,n),t=t.sibling;t!==null;)Fd(t,e,n),t=t.sibling}function Bd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Bd(t,e,n),t=t.sibling;t!==null;)Bd(t,e,n),t=t.sibling}var At=null,En=!1;function mr(t,e,n){for(n=n.child;n!==null;)N0(t,e,n),n=n.sibling}function N0(t,e,n){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(fc,n)}catch{}switch(n.tag){case 5:Lt||Js(n,e);case 6:var r=At,s=En;At=null,mr(t,e,n),At=r,En=s,At!==null&&(En?(t=At,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):At.removeChild(n.stateNode));break;case 18:At!==null&&(En?(t=At,n=n.stateNode,t.nodeType===8?ju(t.parentNode,n):t.nodeType===1&&ju(t,n),Li(t)):ju(At,n.stateNode));break;case 4:r=At,s=En,At=n.stateNode.containerInfo,En=!0,mr(t,e,n),At=r,En=s;break;case 0:case 11:case 14:case 15:if(!Lt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Vd(n,e,a),s=s.next}while(s!==r)}mr(t,e,n);break;case 1:if(!Lt&&(Js(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Ke(n,e,c)}mr(t,e,n);break;case 21:mr(t,e,n);break;case 22:n.mode&1?(Lt=(r=Lt)||n.memoizedState!==null,mr(t,e,n),Lt=r):mr(t,e,n);break;default:mr(t,e,n)}}function Wp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new wE),e.forEach(function(r){var s=bE.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function vn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,a=e,c=a;e:for(;c!==null;){switch(c.tag){case 5:At=c.stateNode,En=!1;break e;case 3:At=c.stateNode.containerInfo,En=!0;break e;case 4:At=c.stateNode.containerInfo,En=!0;break e}c=c.return}if(At===null)throw Error(K(160));N0(o,a,s),At=null,En=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Ke(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)I0(e,t),e=e.sibling}function I0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(vn(e,t),Dn(t),r&4){try{_i(3,t,t.return),_c(3,t)}catch(R){Ke(t,t.return,R)}try{_i(5,t,t.return)}catch(R){Ke(t,t.return,R)}}break;case 1:vn(e,t),Dn(t),r&512&&n!==null&&Js(n,n.return);break;case 5:if(vn(e,t),Dn(t),r&512&&n!==null&&Js(n,n.return),t.flags&32){var s=t.stateNode;try{Di(s,"")}catch(R){Ke(t,t.return,R)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&o.type==="radio"&&o.name!=null&&Qx(s,o),ud(c,a);var d=ud(c,o);for(a=0;a<u.length;a+=2){var m=u[a],f=u[a+1];m==="style"?Zx(s,f):m==="dangerouslySetInnerHTML"?Yx(s,f):m==="children"?Di(s,f):jh(s,m,f,d)}switch(c){case"input":od(s,o);break;case"textarea":Kx(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var w=o.value;w!=null?to(s,!!o.multiple,w,!1):p!==!!o.multiple&&(o.defaultValue!=null?to(s,!!o.multiple,o.defaultValue,!0):to(s,!!o.multiple,o.multiple?[]:"",!1))}s[Ui]=o}catch(R){Ke(t,t.return,R)}}break;case 6:if(vn(e,t),Dn(t),r&4){if(t.stateNode===null)throw Error(K(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(R){Ke(t,t.return,R)}}break;case 3:if(vn(e,t),Dn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Li(e.containerInfo)}catch(R){Ke(t,t.return,R)}break;case 4:vn(e,t),Dn(t);break;case 13:vn(e,t),Dn(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(lf=et())),r&4&&Wp(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(Lt=(d=Lt)||m,vn(e,t),Lt=d):vn(e,t),Dn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!m&&t.mode&1)for(te=t,m=t.child;m!==null;){for(f=te=m;te!==null;){switch(p=te,w=p.child,p.tag){case 0:case 11:case 14:case 15:_i(4,p,p.return);break;case 1:Js(p,p.return);var C=p.stateNode;if(typeof C.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(R){Ke(r,n,R)}}break;case 5:Js(p,p.return);break;case 22:if(p.memoizedState!==null){Qp(f);continue}}w!==null?(w.return=p,te=w):Qp(f)}m=m.sibling}e:for(m=null,f=t;;){if(f.tag===5){if(m===null){m=f;try{s=f.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(c=f.stateNode,u=f.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Jx("display",a))}catch(R){Ke(t,t.return,R)}}}else if(f.tag===6){if(m===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(R){Ke(t,t.return,R)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;m===f&&(m=null),f=f.return}m===f&&(m=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:vn(e,t),Dn(t),r&4&&Wp(t);break;case 21:break;default:vn(e,t),Dn(t)}}function Dn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(S0(n)){var r=n;break e}n=n.return}throw Error(K(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Di(s,""),r.flags&=-33);var o=qp(t);Bd(t,o,s);break;case 3:case 4:var a=r.stateNode.containerInfo,c=qp(t);Fd(t,c,a);break;default:throw Error(K(161))}}catch(u){Ke(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function EE(t,e,n){te=t,T0(t)}function T0(t,e,n){for(var r=(t.mode&1)!==0;te!==null;){var s=te,o=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Wa;if(!a){var c=s.alternate,u=c!==null&&c.memoizedState!==null||Lt;c=Wa;var d=Lt;if(Wa=a,(Lt=u)&&!d)for(te=s;te!==null;)a=te,u=a.child,a.tag===22&&a.memoizedState!==null?Kp(s):u!==null?(u.return=a,te=u):Kp(s);for(;o!==null;)te=o,T0(o),o=o.sibling;te=s,Wa=c,Lt=d}Hp(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,te=o):Hp(t)}}function Hp(t){for(;te!==null;){var e=te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Lt||_c(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Lt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:_n(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Rp(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Rp(e,a,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var f=m.dehydrated;f!==null&&Li(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}Lt||e.flags&512&&Md(e)}catch(p){Ke(e,e.return,p)}}if(e===t){te=null;break}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}}function Qp(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,te=n;break}te=e.return}}function Kp(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{_c(4,e)}catch(u){Ke(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ke(e,s,u)}}var o=e.return;try{Md(e)}catch(u){Ke(e,o,u)}break;case 5:var a=e.return;try{Md(e)}catch(u){Ke(e,a,u)}}}catch(u){Ke(e,e.return,u)}if(e===t){te=null;break}var c=e.sibling;if(c!==null){c.return=e.return,te=c;break}te=e.return}}var AE=Math.ceil,Ul=sr.ReactCurrentDispatcher,of=sr.ReactCurrentOwner,pn=sr.ReactCurrentBatchConfig,Se=0,_t=null,it=null,It=0,Zt=0,Zs=Kr(0),mt=0,Hi=null,As=0,Ec=0,af=0,Ei=null,Wt=null,lf=0,go=1/0,Gn=null,$l=!1,Ud=null,Rr=null,Ha=!1,Er=null,zl=0,Ai=0,$d=null,dl=-1,hl=0;function $t(){return Se&6?et():dl!==-1?dl:dl=et()}function Dr(t){return t.mode&1?Se&2&&It!==0?It&-It:iE.transition!==null?(hl===0&&(hl=dy()),hl):(t=Ie,t!==0||(t=window.event,t=t===void 0?16:yy(t.type)),t):1}function Nn(t,e,n,r){if(50<Ai)throw Ai=0,$d=null,Error(K(185));ia(t,n,r),(!(Se&2)||t!==_t)&&(t===_t&&(!(Se&2)&&(Ec|=n),mt===4&&wr(t,It)),Xt(t,r),n===1&&Se===0&&!(e.mode&1)&&(go=et()+500,yc&&Xr()))}function Xt(t,e){var n=t.callbackNode;i1(t,e);var r=Il(t,t===_t?It:0);if(r===0)n!==null&&sp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&sp(n),e===1)t.tag===0?oE(Xp.bind(null,t)):Vy(Xp.bind(null,t)),tE(function(){!(Se&6)&&Xr()}),n=null;else{switch(hy(r)){case 1:n=kh;break;case 4:n=cy;break;case 16:n=Nl;break;case 536870912:n=uy;break;default:n=Nl}n=O0(n,j0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function j0(t,e){if(dl=-1,hl=0,Se&6)throw Error(K(327));var n=t.callbackNode;if(io()&&t.callbackNode!==n)return null;var r=Il(t,t===_t?It:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Gl(t,r);else{e=r;var s=Se;Se|=2;var o=b0();(_t!==t||It!==e)&&(Gn=null,go=et()+500,gs(t,e));do try{IE();break}catch(c){C0(t,c)}while(!0);Wh(),Ul.current=o,Se=s,it!==null?e=0:(_t=null,It=0,e=mt)}if(e!==0){if(e===2&&(s=pd(t),s!==0&&(r=s,e=zd(t,s))),e===1)throw n=Hi,gs(t,0),wr(t,r),Xt(t,et()),n;if(e===6)wr(t,r);else{if(s=t.current.alternate,!(r&30)&&!SE(s)&&(e=Gl(t,r),e===2&&(o=pd(t),o!==0&&(r=o,e=zd(t,o))),e===1))throw n=Hi,gs(t,0),wr(t,r),Xt(t,et()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:us(t,Wt,Gn);break;case 3:if(wr(t,r),(r&130023424)===r&&(e=lf+500-et(),10<e)){if(Il(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){$t(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ad(us.bind(null,t,Wt,Gn),e);break}us(t,Wt,Gn);break;case 4:if(wr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Sn(r);o=1<<a,a=e[a],a>s&&(s=a),r&=~o}if(r=s,r=et()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*AE(r/1960))-r,10<r){t.timeoutHandle=Ad(us.bind(null,t,Wt,Gn),r);break}us(t,Wt,Gn);break;case 5:us(t,Wt,Gn);break;default:throw Error(K(329))}}}return Xt(t,et()),t.callbackNode===n?j0.bind(null,t):null}function zd(t,e){var n=Ei;return t.current.memoizedState.isDehydrated&&(gs(t,e).flags|=256),t=Gl(t,e),t!==2&&(e=Wt,Wt=n,e!==null&&Gd(e)),t}function Gd(t){Wt===null?Wt=t:Wt.push.apply(Wt,t)}function SE(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!In(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wr(t,e){for(e&=~af,e&=~Ec,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Sn(e),r=1<<n;t[n]=-1,e&=~r}}function Xp(t){if(Se&6)throw Error(K(327));io();var e=Il(t,0);if(!(e&1))return Xt(t,et()),null;var n=Gl(t,e);if(t.tag!==0&&n===2){var r=pd(t);r!==0&&(e=r,n=zd(t,r))}if(n===1)throw n=Hi,gs(t,0),wr(t,e),Xt(t,et()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,us(t,Wt,Gn),Xt(t,et()),null}function cf(t,e){var n=Se;Se|=1;try{return t(e)}finally{Se=n,Se===0&&(go=et()+500,yc&&Xr())}}function Ss(t){Er!==null&&Er.tag===0&&!(Se&6)&&io();var e=Se;Se|=1;var n=pn.transition,r=Ie;try{if(pn.transition=null,Ie=1,t)return t()}finally{Ie=r,pn.transition=n,Se=e,!(Se&6)&&Xr()}}function uf(){Zt=Zs.current,Le(Zs)}function gs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,eE(n)),it!==null)for(n=it.return;n!==null;){var r=n;switch(zh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Rl();break;case 3:mo(),Le(Qt),Le(Vt),Jh();break;case 5:Yh(r);break;case 4:mo();break;case 13:Le(Ue);break;case 19:Le(Ue);break;case 10:Hh(r.type._context);break;case 22:case 23:uf()}n=n.return}if(_t=t,it=t=kr(t.current,null),It=Zt=e,mt=0,Hi=null,af=Ec=As=0,Wt=Ei=null,fs!==null){for(e=0;e<fs.length;e++)if(n=fs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=s,r.next=a}n.pending=r}fs=null}return t}function C0(t,e){do{var n=it;try{if(Wh(),ll.current=Bl,Fl){for(var r=$e.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Fl=!1}if(Es=0,vt=ht=$e=null,wi=!1,Gi=0,of.current=null,n===null||n.return===null){mt=1,Hi=e,it=null;break}e:{var o=t,a=n.return,c=n,u=e;if(e=It,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=c,f=m.tag;if(!(m.mode&1)&&(f===0||f===11||f===15)){var p=m.alternate;p?(m.updateQueue=p.updateQueue,m.memoizedState=p.memoizedState,m.lanes=p.lanes):(m.updateQueue=null,m.memoizedState=null)}var w=Vp(a);if(w!==null){w.flags&=-257,Mp(w,a,c,o,e),w.mode&1&&Lp(o,d,e),e=w,u=d;var C=e.updateQueue;if(C===null){var R=new Set;R.add(u),e.updateQueue=R}else C.add(u);break e}else{if(!(e&1)){Lp(o,d,e),df();break e}u=Error(K(426))}}else if(Me&&c.mode&1){var D=Vp(a);if(D!==null){!(D.flags&65536)&&(D.flags|=256),Mp(D,a,c,o,e),Gh(po(u,c));break e}}o=u=po(u,c),mt!==4&&(mt=2),Ei===null?Ei=[o]:Ei.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var x=h0(o,u,e);bp(o,x);break e;case 1:c=u;var v=o.type,I=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Rr===null||!Rr.has(I)))){o.flags|=65536,e&=-e,o.lanes|=e;var L=f0(o,c,e);bp(o,L);break e}}o=o.return}while(o!==null)}D0(n)}catch(B){e=B,it===n&&n!==null&&(it=n=n.return);continue}break}while(!0)}function b0(){var t=Ul.current;return Ul.current=Bl,t===null?Bl:t}function df(){(mt===0||mt===3||mt===2)&&(mt=4),_t===null||!(As&268435455)&&!(Ec&268435455)||wr(_t,It)}function Gl(t,e){var n=Se;Se|=2;var r=b0();(_t!==t||It!==e)&&(Gn=null,gs(t,e));do try{NE();break}catch(s){C0(t,s)}while(!0);if(Wh(),Se=n,Ul.current=r,it!==null)throw Error(K(261));return _t=null,It=0,mt}function NE(){for(;it!==null;)R0(it)}function IE(){for(;it!==null&&!Y_();)R0(it)}function R0(t){var e=P0(t.alternate,t,Zt);t.memoizedProps=t.pendingProps,e===null?D0(t):it=e,of.current=null}function D0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=vE(n,e),n!==null){n.flags&=32767,it=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{mt=6,it=null;return}}else if(n=yE(n,e,Zt),n!==null){it=n;return}if(e=e.sibling,e!==null){it=e;return}it=e=t}while(e!==null);mt===0&&(mt=5)}function us(t,e,n){var r=Ie,s=pn.transition;try{pn.transition=null,Ie=1,TE(t,e,n,r)}finally{pn.transition=s,Ie=r}return null}function TE(t,e,n,r){do io();while(Er!==null);if(Se&6)throw Error(K(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(a1(t,o),t===_t&&(it=_t=null,It=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ha||(Ha=!0,O0(Nl,function(){return io(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=pn.transition,pn.transition=null;var a=Ie;Ie=1;var c=Se;Se|=4,of.current=null,_E(t,n),I0(n,t),H1(_d),Tl=!!wd,_d=wd=null,t.current=n,EE(n),J_(),Se=c,Ie=a,pn.transition=o}else t.current=n;if(Ha&&(Ha=!1,Er=t,zl=s),o=t.pendingLanes,o===0&&(Rr=null),t1(n.stateNode),Xt(t,et()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if($l)throw $l=!1,t=Ud,Ud=null,t;return zl&1&&t.tag!==0&&io(),o=t.pendingLanes,o&1?t===$d?Ai++:(Ai=0,$d=t):Ai=0,Xr(),null}function io(){if(Er!==null){var t=hy(zl),e=pn.transition,n=Ie;try{if(pn.transition=null,Ie=16>t?16:t,Er===null)var r=!1;else{if(t=Er,Er=null,zl=0,Se&6)throw Error(K(331));var s=Se;for(Se|=4,te=t.current;te!==null;){var o=te,a=o.child;if(te.flags&16){var c=o.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(te=d;te!==null;){var m=te;switch(m.tag){case 0:case 11:case 15:_i(8,m,o)}var f=m.child;if(f!==null)f.return=m,te=f;else for(;te!==null;){m=te;var p=m.sibling,w=m.return;if(A0(m),m===d){te=null;break}if(p!==null){p.return=w,te=p;break}te=w}}}var C=o.alternate;if(C!==null){var R=C.child;if(R!==null){C.child=null;do{var D=R.sibling;R.sibling=null,R=D}while(R!==null)}}te=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,te=a;else e:for(;te!==null;){if(o=te,o.flags&2048)switch(o.tag){case 0:case 11:case 15:_i(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,te=x;break e}te=o.return}}var v=t.current;for(te=v;te!==null;){a=te;var I=a.child;if(a.subtreeFlags&2064&&I!==null)I.return=a,te=I;else e:for(a=v;te!==null;){if(c=te,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:_c(9,c)}}catch(B){Ke(c,c.return,B)}if(c===a){te=null;break e}var L=c.sibling;if(L!==null){L.return=c.return,te=L;break e}te=c.return}}if(Se=s,Xr(),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(fc,t)}catch{}r=!0}return r}finally{Ie=n,pn.transition=e}}return!1}function Yp(t,e,n){e=po(n,e),e=h0(t,e,1),t=br(t,e,1),e=$t(),t!==null&&(ia(t,1,e),Xt(t,e))}function Ke(t,e,n){if(t.tag===3)Yp(t,t,n);else for(;e!==null;){if(e.tag===3){Yp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rr===null||!Rr.has(r))){t=po(n,t),t=f0(e,t,1),e=br(e,t,1),t=$t(),e!==null&&(ia(e,1,t),Xt(e,t));break}}e=e.return}}function jE(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=$t(),t.pingedLanes|=t.suspendedLanes&n,_t===t&&(It&n)===n&&(mt===4||mt===3&&(It&130023424)===It&&500>et()-lf?gs(t,0):af|=n),Xt(t,e)}function k0(t,e){e===0&&(t.mode&1?(e=Va,Va<<=1,!(Va&130023424)&&(Va=4194304)):e=1);var n=$t();t=Jn(t,e),t!==null&&(ia(t,e,n),Xt(t,n))}function CE(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),k0(t,n)}function bE(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),k0(t,n)}var P0;P0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qt.current)Ht=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ht=!1,xE(t,e,n);Ht=!!(t.flags&131072)}else Ht=!1,Me&&e.flags&1048576&&My(e,Pl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ul(t,e),t=e.pendingProps;var s=uo(e,Vt.current);oo(e,n),s=ef(null,e,r,t,s,n);var o=tf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Kt(r)?(o=!0,Dl(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Kh(e),s.updater=wc,e.stateNode=s,s._reactInternals=e,bd(e,r,t,n),e=kd(null,e,r,!0,o,n)):(e.tag=0,Me&&o&&$h(e),Bt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ul(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=DE(r),t=_n(r,t),s){case 0:e=Dd(null,e,r,t,n);break e;case 1:e=Up(null,e,r,t,n);break e;case 11:e=Fp(null,e,r,t,n);break e;case 14:e=Bp(null,e,r,_n(r.type,t),n);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:_n(r,s),Dd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:_n(r,s),Up(t,e,r,s,n);case 3:e:{if(x0(e),t===null)throw Error(K(387));r=e.pendingProps,o=e.memoizedState,s=o.element,Gy(t,e),Vl(e,r,null,n);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=po(Error(K(423)),e),e=$p(t,e,r,n,s);break e}else if(r!==s){s=po(Error(K(424)),e),e=$p(t,e,r,n,s);break e}else for(tn=Cr(e.stateNode.containerInfo.firstChild),rn=e,Me=!0,An=null,n=$y(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ho(),r===s){e=Zn(t,e,n);break e}Bt(t,e,r,n)}e=e.child}return e;case 5:return qy(e),t===null&&Td(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,a=s.children,Ed(r,s)?a=null:o!==null&&Ed(r,o)&&(e.flags|=32),g0(t,e),Bt(t,e,a,n),e.child;case 6:return t===null&&Td(e),null;case 13:return y0(t,e,n);case 4:return Xh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=fo(e,null,r,n):Bt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:_n(r,s),Fp(t,e,r,s,n);case 7:return Bt(t,e,e.pendingProps,n),e.child;case 8:return Bt(t,e,e.pendingProps.children,n),e.child;case 12:return Bt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,a=s.value,De(Ol,r._currentValue),r._currentValue=a,o!==null)if(In(o.value,a)){if(o.children===s.children&&!Qt.current){e=Zn(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var c=o.dependencies;if(c!==null){a=o.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=Qn(-1,n&-n),u.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),jd(o.return,n,e),c.lanes|=n;break}u=u.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(K(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),jd(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Bt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,oo(e,n),s=gn(s),r=r(s),e.flags|=1,Bt(t,e,r,n),e.child;case 14:return r=e.type,s=_n(r,e.pendingProps),s=_n(r.type,s),Bp(t,e,r,s,n);case 15:return m0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:_n(r,s),ul(t,e),e.tag=1,Kt(r)?(t=!0,Dl(e)):t=!1,oo(e,n),d0(e,r,s),bd(e,r,s,n),kd(null,e,r,!0,t,n);case 19:return v0(t,e,n);case 22:return p0(t,e,n)}throw Error(K(156,e.tag))};function O0(t,e){return ly(t,e)}function RE(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(t,e,n,r){return new RE(t,e,n,r)}function hf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function DE(t){if(typeof t=="function")return hf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===bh)return 11;if(t===Rh)return 14}return 2}function kr(t,e){var n=t.alternate;return n===null?(n=mn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function fl(t,e,n,r,s,o){var a=2;if(r=t,typeof t=="function")hf(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case zs:return xs(n.children,s,o,e);case Ch:a=8,s|=8;break;case ed:return t=mn(12,n,e,s|2),t.elementType=ed,t.lanes=o,t;case td:return t=mn(13,n,e,s),t.elementType=td,t.lanes=o,t;case nd:return t=mn(19,n,e,s),t.elementType=nd,t.lanes=o,t;case qx:return Ac(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case zx:a=10;break e;case Gx:a=9;break e;case bh:a=11;break e;case Rh:a=14;break e;case xr:a=16,r=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=mn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function xs(t,e,n,r){return t=mn(7,t,r,e),t.lanes=n,t}function Ac(t,e,n,r){return t=mn(22,t,r,e),t.elementType=qx,t.lanes=n,t.stateNode={isHidden:!1},t}function Lu(t,e,n){return t=mn(6,t,null,e),t.lanes=n,t}function Vu(t,e,n){return e=mn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function kE(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xu(0),this.expirationTimes=xu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ff(t,e,n,r,s,o,a,c,u){return t=new kE(t,e,n,c,u),e===1?(e=1,o===!0&&(e|=8)):e=0,o=mn(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kh(o),t}function PE(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$s,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function L0(t){if(!t)return Ur;t=t._reactInternals;e:{if(js(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Kt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(Kt(n))return Ly(t,n,e)}return e}function V0(t,e,n,r,s,o,a,c,u){return t=ff(n,r,!0,t,s,o,a,c,u),t.context=L0(null),n=t.current,r=$t(),s=Dr(n),o=Qn(r,s),o.callback=e??null,br(n,o,s),t.current.lanes=s,ia(t,s,r),Xt(t,r),t}function Sc(t,e,n,r){var s=e.current,o=$t(),a=Dr(s);return n=L0(n),e.context===null?e.context=n:e.pendingContext=n,e=Qn(o,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=br(s,e,a),t!==null&&(Nn(t,s,a,o),al(t,s,a)),a}function ql(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Jp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function mf(t,e){Jp(t,e),(t=t.alternate)&&Jp(t,e)}function OE(){return null}var M0=typeof reportError=="function"?reportError:function(t){console.error(t)};function pf(t){this._internalRoot=t}Nc.prototype.render=pf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));Sc(t,e,null,null)};Nc.prototype.unmount=pf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ss(function(){Sc(null,t,null,null)}),e[Yn]=null}};function Nc(t){this._internalRoot=t}Nc.prototype.unstable_scheduleHydration=function(t){if(t){var e=py();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vr.length&&e!==0&&e<vr[n].priority;n++);vr.splice(n,0,t),n===0&&xy(t)}};function gf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ic(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Zp(){}function LE(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var d=ql(a);o.call(d)}}var a=V0(e,r,t,0,null,!1,!1,"",Zp);return t._reactRootContainer=a,t[Yn]=a.current,Fi(t.nodeType===8?t.parentNode:t),Ss(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=ql(u);c.call(d)}}var u=ff(t,0,!1,null,null,!1,!1,"",Zp);return t._reactRootContainer=u,t[Yn]=u.current,Fi(t.nodeType===8?t.parentNode:t),Ss(function(){Sc(e,u,n,r)}),u}function Tc(t,e,n,r,s){var o=n._reactRootContainer;if(o){var a=o;if(typeof s=="function"){var c=s;s=function(){var u=ql(a);c.call(u)}}Sc(e,a,t,s)}else a=LE(n,e,t,s,r);return ql(a)}fy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ui(e.pendingLanes);n!==0&&(Ph(e,n|1),Xt(e,et()),!(Se&6)&&(go=et()+500,Xr()))}break;case 13:Ss(function(){var r=Jn(t,1);if(r!==null){var s=$t();Nn(r,t,1,s)}}),mf(t,1)}};Oh=function(t){if(t.tag===13){var e=Jn(t,134217728);if(e!==null){var n=$t();Nn(e,t,134217728,n)}mf(t,134217728)}};my=function(t){if(t.tag===13){var e=Dr(t),n=Jn(t,e);if(n!==null){var r=$t();Nn(n,t,e,r)}mf(t,e)}};py=function(){return Ie};gy=function(t,e){var n=Ie;try{return Ie=t,e()}finally{Ie=n}};hd=function(t,e,n){switch(e){case"input":if(od(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=xc(r);if(!s)throw Error(K(90));Hx(r),od(r,s)}}}break;case"textarea":Kx(t,n);break;case"select":e=n.value,e!=null&&to(t,!!n.multiple,e,!1)}};ny=cf;ry=Ss;var VE={usingClientEntryPoint:!1,Events:[la,Hs,xc,ey,ty,cf]},ai={findFiberByHostInstance:hs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ME={bundleType:ai.bundleType,version:ai.version,rendererPackageName:ai.rendererPackageName,rendererConfig:ai.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=iy(t),t===null?null:t.stateNode},findFiberByHostInstance:ai.findFiberByHostInstance||OE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qa.isDisabled&&Qa.supportsFiber)try{fc=Qa.inject(ME),Vn=Qa}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VE;un.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gf(e))throw Error(K(200));return PE(t,e,null,n)};un.createRoot=function(t,e){if(!gf(t))throw Error(K(299));var n=!1,r="",s=M0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ff(t,1,!1,null,null,n,!1,r,s),t[Yn]=e.current,Fi(t.nodeType===8?t.parentNode:t),new pf(e)};un.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=iy(e),t=t===null?null:t.stateNode,t};un.flushSync=function(t){return Ss(t)};un.hydrate=function(t,e,n){if(!Ic(e))throw Error(K(200));return Tc(null,t,e,!0,n)};un.hydrateRoot=function(t,e,n){if(!gf(t))throw Error(K(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",a=M0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=V0(e,null,t,1,n??null,s,!1,o,a),t[Yn]=e.current,Fi(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Nc(e)};un.render=function(t,e,n){if(!Ic(e))throw Error(K(200));return Tc(null,t,e,!1,n)};un.unmountComponentAtNode=function(t){if(!Ic(t))throw Error(K(40));return t._reactRootContainer?(Ss(function(){Tc(null,null,t,!1,function(){t._reactRootContainer=null,t[Yn]=null})}),!0):!1};un.unstable_batchedUpdates=cf;un.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ic(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return Tc(t,e,n,!1,r)};un.version="18.3.1-next-f1338f8080-20240426";function F0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(F0)}catch(t){console.error(t)}}F0(),Fx.exports=un;var FE=Fx.exports,eg=FE;Ju.createRoot=eg.createRoot,Ju.hydrateRoot=eg.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qi(){return Qi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qi.apply(this,arguments)}var Ar;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ar||(Ar={}));const tg="popstate";function BE(t){t===void 0&&(t={});function e(s,o){let{pathname:a="/",search:c="",hash:u=""}=Cs(s.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),qd("",{pathname:a,search:c,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(s,o){let a=s.document.querySelector("base"),c="";if(a&&a.getAttribute("href")){let u=s.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof o=="string"?o:Wl(o))}function r(s,o){xf(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return $E(e,n,r,t)}function ze(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function xf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UE(){return Math.random().toString(36).substr(2,8)}function ng(t,e){return{usr:t.state,key:t.key,idx:e}}function qd(t,e,n,r){return n===void 0&&(n=null),Qi({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Cs(e):e,{state:n,key:e&&e.key||r||UE()})}function Wl(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Cs(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function $E(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,a=s.history,c=Ar.Pop,u=null,d=m();d==null&&(d=0,a.replaceState(Qi({},a.state,{idx:d}),""));function m(){return(a.state||{idx:null}).idx}function f(){c=Ar.Pop;let D=m(),x=D==null?null:D-d;d=D,u&&u({action:c,location:R.location,delta:x})}function p(D,x){c=Ar.Push;let v=qd(R.location,D,x);n&&n(v,D),d=m()+1;let I=ng(v,d),L=R.createHref(v);try{a.pushState(I,"",L)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;s.location.assign(L)}o&&u&&u({action:c,location:R.location,delta:1})}function w(D,x){c=Ar.Replace;let v=qd(R.location,D,x);n&&n(v,D),d=m();let I=ng(v,d),L=R.createHref(v);a.replaceState(I,"",L),o&&u&&u({action:c,location:R.location,delta:0})}function C(D){let x=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof D=="string"?D:Wl(D);return v=v.replace(/ $/,"%20"),ze(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let R={get action(){return c},get location(){return t(s,a)},listen(D){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(tg,f),u=D,()=>{s.removeEventListener(tg,f),u=null}},createHref(D){return e(s,D)},createURL:C,encodeLocation(D){let x=C(D);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:w,go(D){return a.go(D)}};return R}var rg;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(rg||(rg={}));function zE(t,e,n){return n===void 0&&(n="/"),GE(t,e,n)}function GE(t,e,n,r){let s=typeof e=="string"?Cs(e):e,o=xo(s.pathname||"/",n);if(o==null)return null;let a=B0(t);qE(a);let c=null;for(let u=0;c==null&&u<a.length;++u){let d=n2(o);c=e2(a[u],d)}return c}function B0(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,a,c)=>{let u={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};u.relativePath.startsWith("/")&&(ze(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=Pr([r,u.relativePath]),m=n.concat(u);o.children&&o.children.length>0&&(ze(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),B0(o.children,e,m,d)),!(o.path==null&&!o.index)&&e.push({path:d,score:JE(d,o.index),routesMeta:m})};return t.forEach((o,a)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,a);else for(let u of U0(o.path))s(o,a,u)}),e}function U0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let a=U0(r.join("/")),c=[];return c.push(...a.map(u=>u===""?o:[o,u].join("/"))),s&&c.push(...a),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function qE(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:ZE(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const WE=/^:[\w-]+$/,HE=3,QE=2,KE=1,XE=10,YE=-2,sg=t=>t==="*";function JE(t,e){let n=t.split("/"),r=n.length;return n.some(sg)&&(r+=YE),e&&(r+=QE),n.filter(s=>!sg(s)).reduce((s,o)=>s+(WE.test(o)?HE:o===""?KE:XE),r)}function ZE(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function e2(t,e,n){let{routesMeta:r}=t,s={},o="/",a=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,m=o==="/"?e:e.slice(o.length)||"/",f=Wd({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},m),p=u.route;if(!f)return null;Object.assign(s,f.params),a.push({params:s,pathname:Pr([o,f.pathname]),pathnameBase:i2(Pr([o,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(o=Pr([o,f.pathnameBase]))}return a}function Wd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=t2(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let o=s[0],a=o.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((d,m,f)=>{let{paramName:p,isOptional:w}=m;if(p==="*"){let R=c[f]||"";a=o.slice(0,o.length-R.length).replace(/(.)\/+$/,"$1")}const C=c[f];return w&&!C?d[p]=void 0:d[p]=(C||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:a,pattern:t}}function t2(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),xf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function n2(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return xf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function xo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function r2(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Cs(t):t;return{pathname:n?n.startsWith("/")?n:s2(n,e):e,search:a2(r),hash:l2(s)}}function s2(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Mu(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function o2(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function yf(t,e){let n=o2(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function vf(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Cs(t):(s=Qi({},t),ze(!s.pathname||!s.pathname.includes("?"),Mu("?","pathname","search",s)),ze(!s.pathname||!s.pathname.includes("#"),Mu("#","pathname","hash",s)),ze(!s.search||!s.search.includes("#"),Mu("#","search","hash",s)));let o=t===""||s.pathname==="",a=o?"/":s.pathname,c;if(a==null)c=n;else{let f=e.length-1;if(!r&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}c=f>=0?e[f]:"/"}let u=r2(s,c),d=a&&a!=="/"&&a.endsWith("/"),m=(o||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||m)&&(u.pathname+="/"),u}const Pr=t=>t.join("/").replace(/\/\/+/g,"/"),i2=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),a2=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,l2=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function c2(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const $0=["post","put","patch","delete"];new Set($0);const u2=["get",...$0];new Set(u2);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ki(){return Ki=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ki.apply(this,arguments)}const jc=N.createContext(null),z0=N.createContext(null),or=N.createContext(null),Cc=N.createContext(null),zn=N.createContext({outlet:null,matches:[],isDataRoute:!1}),G0=N.createContext(null);function d2(t,e){let{relative:n}=e===void 0?{}:e;jo()||ze(!1);let{basename:r,navigator:s}=N.useContext(or),{hash:o,pathname:a,search:c}=bc(t,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:Pr([r,a])),s.createHref({pathname:u,search:c,hash:o})}function jo(){return N.useContext(Cc)!=null}function ir(){return jo()||ze(!1),N.useContext(Cc).location}function q0(t){N.useContext(or).static||N.useLayoutEffect(t)}function Yr(){let{isDataRoute:t}=N.useContext(zn);return t?T2():h2()}function h2(){jo()||ze(!1);let t=N.useContext(jc),{basename:e,future:n,navigator:r}=N.useContext(or),{matches:s}=N.useContext(zn),{pathname:o}=ir(),a=JSON.stringify(yf(s,n.v7_relativeSplatPath)),c=N.useRef(!1);return q0(()=>{c.current=!0}),N.useCallback(function(d,m){if(m===void 0&&(m={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let f=vf(d,JSON.parse(a),o,m.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Pr([e,f.pathname])),(m.replace?r.replace:r.push)(f,m.state,m)},[e,r,a,o,t])}const f2=N.createContext(null);function m2(t){let e=N.useContext(zn).outlet;return e&&N.createElement(f2.Provider,{value:t},e)}function p2(){let{matches:t}=N.useContext(zn),e=t[t.length-1];return e?e.params:{}}function bc(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=N.useContext(or),{matches:s}=N.useContext(zn),{pathname:o}=ir(),a=JSON.stringify(yf(s,r.v7_relativeSplatPath));return N.useMemo(()=>vf(t,JSON.parse(a),o,n==="path"),[t,a,o,n])}function g2(t,e){return x2(t,e)}function x2(t,e,n,r){jo()||ze(!1);let{navigator:s}=N.useContext(or),{matches:o}=N.useContext(zn),a=o[o.length-1],c=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let d=ir(),m;if(e){var f;let D=typeof e=="string"?Cs(e):e;u==="/"||(f=D.pathname)!=null&&f.startsWith(u)||ze(!1),m=D}else m=d;let p=m.pathname||"/",w=p;if(u!=="/"){let D=u.replace(/^\//,"").split("/");w="/"+p.replace(/^\//,"").split("/").slice(D.length).join("/")}let C=zE(t,{pathname:w}),R=E2(C&&C.map(D=>Object.assign({},D,{params:Object.assign({},c,D.params),pathname:Pr([u,s.encodeLocation?s.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?u:Pr([u,s.encodeLocation?s.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),o,n,r);return e&&R?N.createElement(Cc.Provider,{value:{location:Ki({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Ar.Pop}},R):R}function y2(){let t=I2(),e=c2(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:s},n):null,null)}const v2=N.createElement(y2,null);class w2 extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?N.createElement(zn.Provider,{value:this.props.routeContext},N.createElement(G0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function _2(t){let{routeContext:e,match:n,children:r}=t,s=N.useContext(jc);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(zn.Provider,{value:e},r)}function E2(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,c=(s=n)==null?void 0:s.errors;if(c!=null){let m=a.findIndex(f=>f.route.id&&(c==null?void 0:c[f.route.id])!==void 0);m>=0||ze(!1),a=a.slice(0,Math.min(a.length,m+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let m=0;m<a.length;m++){let f=a[m];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=m),f.route.id){let{loaderData:p,errors:w}=n,C=f.route.loader&&p[f.route.id]===void 0&&(!w||w[f.route.id]===void 0);if(f.route.lazy||C){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((m,f,p)=>{let w,C=!1,R=null,D=null;n&&(w=c&&f.route.id?c[f.route.id]:void 0,R=f.route.errorElement||v2,u&&(d<0&&p===0?(j2("route-fallback"),C=!0,D=null):d===p&&(C=!0,D=f.route.hydrateFallbackElement||null)));let x=e.concat(a.slice(0,p+1)),v=()=>{let I;return w?I=R:C?I=D:f.route.Component?I=N.createElement(f.route.Component,null):f.route.element?I=f.route.element:I=m,N.createElement(_2,{match:f,routeContext:{outlet:m,matches:x,isDataRoute:n!=null},children:I})};return n&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?N.createElement(w2,{location:n.location,revalidation:n.revalidation,component:R,error:w,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var W0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(W0||{}),H0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(H0||{});function A2(t){let e=N.useContext(jc);return e||ze(!1),e}function S2(t){let e=N.useContext(z0);return e||ze(!1),e}function N2(t){let e=N.useContext(zn);return e||ze(!1),e}function Q0(t){let e=N2(),n=e.matches[e.matches.length-1];return n.route.id||ze(!1),n.route.id}function I2(){var t;let e=N.useContext(G0),n=S2(),r=Q0();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function T2(){let{router:t}=A2(W0.UseNavigateStable),e=Q0(H0.UseNavigateStable),n=N.useRef(!1);return q0(()=>{n.current=!0}),N.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Ki({fromRouteId:e},o)))},[t,e])}const og={};function j2(t,e,n){og[t]||(og[t]=!0)}function C2(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function yo(t){let{to:e,replace:n,state:r,relative:s}=t;jo()||ze(!1);let{future:o,static:a}=N.useContext(or),{matches:c}=N.useContext(zn),{pathname:u}=ir(),d=Yr(),m=vf(e,yf(c,o.v7_relativeSplatPath),u,s==="path"),f=JSON.stringify(m);return N.useEffect(()=>d(JSON.parse(f),{replace:n,state:r,relative:s}),[d,f,s,n,r]),null}function b2(t){return m2(t.context)}function dt(t){ze(!1)}function R2(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Ar.Pop,navigator:o,static:a=!1,future:c}=t;jo()&&ze(!1);let u=e.replace(/^\/*/,"/"),d=N.useMemo(()=>({basename:u,navigator:o,static:a,future:Ki({v7_relativeSplatPath:!1},c)}),[u,c,o,a]);typeof r=="string"&&(r=Cs(r));let{pathname:m="/",search:f="",hash:p="",state:w=null,key:C="default"}=r,R=N.useMemo(()=>{let D=xo(m,u);return D==null?null:{location:{pathname:D,search:f,hash:p,state:w,key:C},navigationType:s}},[u,m,f,p,w,C,s]);return R==null?null:N.createElement(or.Provider,{value:d},N.createElement(Cc.Provider,{children:n,value:R}))}function D2(t){let{children:e,location:n}=t;return g2(Hd(e),n)}new Promise(()=>{});function Hd(t,e){e===void 0&&(e=[]);let n=[];return N.Children.forEach(t,(r,s)=>{if(!N.isValidElement(r))return;let o=[...e,s];if(r.type===N.Fragment){n.push.apply(n,Hd(r.props.children,o));return}r.type!==dt&&ze(!1),!r.props.index||!r.props.children||ze(!1);let a={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Hd(r.props.children,o)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hl(){return Hl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hl.apply(this,arguments)}function K0(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function k2(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function P2(t,e){return t.button===0&&(!e||e==="_self")&&!k2(t)}function Qd(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function O2(t,e){let n=Qd(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(o=>{n.append(s,o)})}),n}const L2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],V2=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],M2="6";try{window.__reactRouterVersion=M2}catch{}const F2=N.createContext({isTransitioning:!1}),B2="startTransition",ig=j_[B2];function U2(t){let{basename:e,children:n,future:r,window:s}=t,o=N.useRef();o.current==null&&(o.current=BE({window:s,v5Compat:!0}));let a=o.current,[c,u]=N.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},m=N.useCallback(f=>{d&&ig?ig(()=>u(f)):u(f)},[u,d]);return N.useLayoutEffect(()=>a.listen(m),[a,m]),N.useEffect(()=>C2(r),[r]),N.createElement(R2,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:a,future:r})}const $2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",z2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xi=N.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:o,replace:a,state:c,target:u,to:d,preventScrollReset:m,viewTransition:f}=e,p=K0(e,L2),{basename:w}=N.useContext(or),C,R=!1;if(typeof d=="string"&&z2.test(d)&&(C=d,$2))try{let I=new URL(window.location.href),L=d.startsWith("//")?new URL(I.protocol+d):new URL(d),B=xo(L.pathname,w);L.origin===I.origin&&B!=null?d=B+L.search+L.hash:R=!0}catch{}let D=d2(d,{relative:s}),x=q2(d,{replace:a,state:c,target:u,preventScrollReset:m,relative:s,viewTransition:f});function v(I){r&&r(I),I.defaultPrevented||x(I)}return N.createElement("a",Hl({},p,{href:C||D,onClick:R||o?r:v,ref:n,target:u}))}),Ka=N.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:o="",end:a=!1,style:c,to:u,viewTransition:d,children:m}=e,f=K0(e,V2),p=bc(u,{relative:f.relative}),w=ir(),C=N.useContext(z0),{navigator:R,basename:D}=N.useContext(or),x=C!=null&&W2(p)&&d===!0,v=R.encodeLocation?R.encodeLocation(p).pathname:p.pathname,I=w.pathname,L=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;s||(I=I.toLowerCase(),L=L?L.toLowerCase():null,v=v.toLowerCase()),L&&D&&(L=xo(L,D)||L);const B=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let M=I===v||!a&&I.startsWith(v)&&I.charAt(B)==="/",S=L!=null&&(L===v||!a&&L.startsWith(v)&&L.charAt(v.length)==="/"),_={isActive:M,isPending:S,isTransitioning:x},y=M?r:void 0,j;typeof o=="function"?j=o(_):j=[o,M?"active":null,S?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let b=typeof c=="function"?c(_):c;return N.createElement(Xi,Hl({},f,{"aria-current":y,className:j,ref:n,style:b,to:u,viewTransition:d}),typeof m=="function"?m(_):m)});var Kd;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Kd||(Kd={}));var ag;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(ag||(ag={}));function G2(t){let e=N.useContext(jc);return e||ze(!1),e}function q2(t,e){let{target:n,replace:r,state:s,preventScrollReset:o,relative:a,viewTransition:c}=e===void 0?{}:e,u=Yr(),d=ir(),m=bc(t,{relative:a});return N.useCallback(f=>{if(P2(f,n)){f.preventDefault();let p=r!==void 0?r:Wl(d)===Wl(m);u(t,{replace:p,state:s,preventScrollReset:o,relative:a,viewTransition:c})}},[d,u,m,r,s,n,t,o,a,c])}function X0(t){let e=N.useRef(Qd(t)),n=N.useRef(!1),r=ir(),s=N.useMemo(()=>O2(r.search,n.current?null:e.current),[r.search]),o=Yr(),a=N.useCallback((c,u)=>{const d=Qd(typeof c=="function"?c(s):c);n.current=!0,o("?"+d,u)},[o,s]);return[s,a]}function W2(t,e){e===void 0&&(e={});let n=N.useContext(F2);n==null&&ze(!1);let{basename:r}=G2(Kd.useViewTransitionState),s=bc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=xo(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=xo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Wd(s.pathname,a)!=null||Wd(s.pathname,o)!=null}const H2=()=>{};var lg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Q2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[n++],a=t[n++],c=t[n++],u=((s&7)<<18|(o&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const o=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|a&63)}}return e.join("")},J0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const o=t[s],a=s+1<t.length,c=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,m=o>>2,f=(o&3)<<4|c>>4;let p=(c&15)<<2|d>>6,w=d&63;u||(w=64,a||(p=64)),r.push(n[m],n[f],n[p],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Y0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Q2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const o=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,o==null||c==null||d==null||f==null)throw new K2;const p=o<<2|c>>4;if(r.push(p),d!==64){const w=c<<4&240|d>>2;if(r.push(w),f!==64){const C=d<<6&192|f;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class K2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const X2=function(t){const e=Y0(t);return J0.encodeByteArray(e,!0)},Ql=function(t){return X2(t).replace(/\./g,"")},Y2=function(t){try{return J0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2=()=>J2().__FIREBASE_DEFAULTS__,eA=()=>{if(typeof process>"u"||typeof lg>"u")return;const t=lg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},tA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Y2(t[1]);return e&&JSON.parse(e)},wf=()=>{try{return H2()||Z2()||eA()||tA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},nA=t=>{var e,n;return(n=(e=wf())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},rA=t=>{const e=nA(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Z0=()=>{var t;return(t=wf())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function oA(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ql(JSON.stringify(n)),Ql(JSON.stringify(a)),""].join(".")}const Si={};function aA(){const t={prod:[],emulator:[]};for(const e of Object.keys(Si))Si[e]?t.emulator.push(e):t.prod.push(e);return t}function lA(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let cg=!1;function cA(t,e){if(typeof window>"u"||typeof document>"u"||!_f(window.location.host)||Si[t]===e||Si[t]||cg)return;Si[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",o=aA().prod.length>0;function a(){const p=document.getElementById(r);p&&p.remove()}function c(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function u(p,w){p.setAttribute("width","24"),p.setAttribute("id",w),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{cg=!0,a()},p}function m(p,w){p.setAttribute("id",w),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=lA(r),w=n("text"),C=document.getElementById(w)||document.createElement("span"),R=n("learnmore"),D=document.getElementById(R)||document.createElement("a"),x=n("preprendIcon"),v=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const I=p.element;c(I),m(D,R);const L=d();u(v,x),I.append(v,C,D,L),document.body.appendChild(I)}o?(C.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function dA(){var e;const t=(e=wf())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hA(){return!dA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fA(){try{return typeof indexedDB=="object"}catch{return!1}}function mA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="FirebaseError";class Co extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=pA,Object.setPrototypeOf(this,Co.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ev.prototype.create)}}class ev{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],a=o?gA(o,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new Co(s,c,r)}}function gA(t,e){return t.replace(xA,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const xA=/\{\$([^}]+)}/g;function Kl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=t[s],a=e[s];if(ug(o)&&ug(a)){if(!Kl(o,a))return!1}else if(o!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function ug(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(t){return t&&t._delegate?t._delegate:t}class Yi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new sA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wA(e))try{this.getOrInitializeService({instanceIdentifier:ds})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=ds){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ds){return this.instances.has(e)}getOptions(e=ds){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);r===c&&a.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:vA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ds){return this.component?this.component.multipleInstances?e:ds:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vA(t){return t===ds?void 0:t}function wA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new yA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const EA={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},AA=Ee.INFO,SA={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},NA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=SA[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tv{constructor(e){this.name=e,this._logLevel=AA,this._logHandler=NA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?EA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}const IA=(t,e)=>e.some(n=>t instanceof n);let dg,hg;function TA(){return dg||(dg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jA(){return hg||(hg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nv=new WeakMap,Xd=new WeakMap,rv=new WeakMap,Fu=new WeakMap,Ef=new WeakMap;function CA(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{n(Or(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&nv.set(n,t)}).catch(()=>{}),Ef.set(e,t),e}function bA(t){if(Xd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Xd.set(t,e)}let Yd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Xd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||rv.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Or(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function RA(t){Yd=t(Yd)}function DA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Bu(this),e,...n);return rv.set(r,e.sort?e.sort():[e]),Or(r)}:jA().includes(t)?function(...e){return t.apply(Bu(this),e),Or(nv.get(this))}:function(...e){return Or(t.apply(Bu(this),e))}}function kA(t){return typeof t=="function"?DA(t):(t instanceof IDBTransaction&&bA(t),IA(t,TA())?new Proxy(t,Yd):t)}function Or(t){if(t instanceof IDBRequest)return CA(t);if(Fu.has(t))return Fu.get(t);const e=kA(t);return e!==t&&(Fu.set(t,e),Ef.set(e,t)),e}const Bu=t=>Ef.get(t);function PA(t,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const a=indexedDB.open(t,e),c=Or(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Or(a.result),u.oldVersion,u.newVersion,Or(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{o&&u.addEventListener("close",()=>o()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const OA=["get","getKey","getAll","getAllKeys","count"],LA=["put","add","delete","clear"],Uu=new Map;function fg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Uu.get(e))return Uu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=LA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||OA.includes(n)))return;const o=async function(a,...c){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return Uu.set(e,o),o}RA(t=>({...t,get:(e,n,r)=>fg(e,n)||t.get(e,n,r),has:(e,n)=>!!fg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(MA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function MA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Jd="@firebase/app",mg="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er=new tv("@firebase/app"),FA="@firebase/app-compat",BA="@firebase/analytics-compat",UA="@firebase/analytics",$A="@firebase/app-check-compat",zA="@firebase/app-check",GA="@firebase/auth",qA="@firebase/auth-compat",WA="@firebase/database",HA="@firebase/data-connect",QA="@firebase/database-compat",KA="@firebase/functions",XA="@firebase/functions-compat",YA="@firebase/installations",JA="@firebase/installations-compat",ZA="@firebase/messaging",eS="@firebase/messaging-compat",tS="@firebase/performance",nS="@firebase/performance-compat",rS="@firebase/remote-config",sS="@firebase/remote-config-compat",oS="@firebase/storage",iS="@firebase/storage-compat",aS="@firebase/firestore",lS="@firebase/ai",cS="@firebase/firestore-compat",uS="firebase",dS="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd="[DEFAULT]",hS={[Jd]:"fire-core",[FA]:"fire-core-compat",[UA]:"fire-analytics",[BA]:"fire-analytics-compat",[zA]:"fire-app-check",[$A]:"fire-app-check-compat",[GA]:"fire-auth",[qA]:"fire-auth-compat",[WA]:"fire-rtdb",[HA]:"fire-data-connect",[QA]:"fire-rtdb-compat",[KA]:"fire-fn",[XA]:"fire-fn-compat",[YA]:"fire-iid",[JA]:"fire-iid-compat",[ZA]:"fire-fcm",[eS]:"fire-fcm-compat",[tS]:"fire-perf",[nS]:"fire-perf-compat",[rS]:"fire-rc",[sS]:"fire-rc-compat",[oS]:"fire-gcs",[iS]:"fire-gcs-compat",[aS]:"fire-fst",[cS]:"fire-fst-compat",[lS]:"fire-vertex","fire-js":"fire-js",[uS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl=new Map,fS=new Map,eh=new Map;function pg(t,e){try{t.container.addComponent(e)}catch(n){er.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Yl(t){const e=t.name;if(eh.has(e))return er.debug(`There were multiple attempts to register component ${e}.`),!1;eh.set(e,t);for(const n of Xl.values())pg(n,t);for(const n of fS.values())pg(n,t);return!0}function mS(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function pS(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lr=new ev("app","Firebase",gS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Yi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS=dS;function sv(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Zd,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Lr.create("bad-app-name",{appName:String(s)});if(n||(n=Z0()),!n)throw Lr.create("no-options");const o=Xl.get(s);if(o){if(Kl(n,o.options)&&Kl(r,o.config))return o;throw Lr.create("duplicate-app",{appName:s})}const a=new _A(s);for(const u of eh.values())a.addComponent(u);const c=new xS(n,r,a);return Xl.set(s,c),c}function vS(t=Zd){const e=Xl.get(t);if(!e&&t===Zd&&Z0())return sv();if(!e)throw Lr.create("no-app",{appName:t});return e}function ao(t,e,n){let r=hS[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),er.warn(a.join(" "));return}Yl(new Yi(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="firebase-heartbeat-database",_S=1,Ji="firebase-heartbeat-store";let $u=null;function ov(){return $u||($u=PA(wS,_S,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ji)}catch(n){console.warn(n)}}}}).catch(t=>{throw Lr.create("idb-open",{originalErrorMessage:t.message})})),$u}async function ES(t){try{const n=(await ov()).transaction(Ji),r=await n.objectStore(Ji).get(iv(t));return await n.done,r}catch(e){if(e instanceof Co)er.warn(e.message);else{const n=Lr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});er.warn(n.message)}}}async function gg(t,e){try{const r=(await ov()).transaction(Ji,"readwrite");await r.objectStore(Ji).put(e,iv(t)),await r.done}catch(n){if(n instanceof Co)er.warn(n.message);else{const r=Lr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});er.warn(r.message)}}}function iv(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=1024,SS=30;class NS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new TS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=xg();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>SS){const a=jS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){er.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=xg(),{heartbeatsToSend:r,unsentEntries:s}=IS(this._heartbeatsCache.heartbeats),o=Ql(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return er.warn(n),""}}}function xg(){return new Date().toISOString().substring(0,10)}function IS(t,e=AS){const n=[];let r=t.slice();for(const s of t){const o=n.find(a=>a.agent===s.agent);if(o){if(o.dates.push(s.date),yg(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),yg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class TS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fA()?mA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ES(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function yg(t){return Ql(JSON.stringify({version:2,heartbeats:t})).length}function jS(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CS(t){Yl(new Yi("platform-logger",e=>new VA(e),"PRIVATE")),Yl(new Yi("heartbeat",e=>new NS(e),"PRIVATE")),ao(Jd,mg,t),ao(Jd,mg,"esm2020"),ao("fire-js","")}CS("");var bS="firebase",RS="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ao(bS,RS,"app");var vg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vr,av;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,_){function y(){}y.prototype=_.prototype,S.F=_.prototype,S.prototype=new y,S.prototype.constructor=S,S.D=function(j,b,T){for(var E=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)E[Q-2]=arguments[Q];return _.prototype[b].apply(j,E)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,_,y){y||(y=0);const j=Array(16);if(typeof _=="string")for(var b=0;b<16;++b)j[b]=_.charCodeAt(y++)|_.charCodeAt(y++)<<8|_.charCodeAt(y++)<<16|_.charCodeAt(y++)<<24;else for(b=0;b<16;++b)j[b]=_[y++]|_[y++]<<8|_[y++]<<16|_[y++]<<24;_=S.g[0],y=S.g[1],b=S.g[2];let T=S.g[3],E;E=_+(T^y&(b^T))+j[0]+3614090360&4294967295,_=y+(E<<7&4294967295|E>>>25),E=T+(b^_&(y^b))+j[1]+3905402710&4294967295,T=_+(E<<12&4294967295|E>>>20),E=b+(y^T&(_^y))+j[2]+606105819&4294967295,b=T+(E<<17&4294967295|E>>>15),E=y+(_^b&(T^_))+j[3]+3250441966&4294967295,y=b+(E<<22&4294967295|E>>>10),E=_+(T^y&(b^T))+j[4]+4118548399&4294967295,_=y+(E<<7&4294967295|E>>>25),E=T+(b^_&(y^b))+j[5]+1200080426&4294967295,T=_+(E<<12&4294967295|E>>>20),E=b+(y^T&(_^y))+j[6]+2821735955&4294967295,b=T+(E<<17&4294967295|E>>>15),E=y+(_^b&(T^_))+j[7]+4249261313&4294967295,y=b+(E<<22&4294967295|E>>>10),E=_+(T^y&(b^T))+j[8]+1770035416&4294967295,_=y+(E<<7&4294967295|E>>>25),E=T+(b^_&(y^b))+j[9]+2336552879&4294967295,T=_+(E<<12&4294967295|E>>>20),E=b+(y^T&(_^y))+j[10]+4294925233&4294967295,b=T+(E<<17&4294967295|E>>>15),E=y+(_^b&(T^_))+j[11]+2304563134&4294967295,y=b+(E<<22&4294967295|E>>>10),E=_+(T^y&(b^T))+j[12]+1804603682&4294967295,_=y+(E<<7&4294967295|E>>>25),E=T+(b^_&(y^b))+j[13]+4254626195&4294967295,T=_+(E<<12&4294967295|E>>>20),E=b+(y^T&(_^y))+j[14]+2792965006&4294967295,b=T+(E<<17&4294967295|E>>>15),E=y+(_^b&(T^_))+j[15]+1236535329&4294967295,y=b+(E<<22&4294967295|E>>>10),E=_+(b^T&(y^b))+j[1]+4129170786&4294967295,_=y+(E<<5&4294967295|E>>>27),E=T+(y^b&(_^y))+j[6]+3225465664&4294967295,T=_+(E<<9&4294967295|E>>>23),E=b+(_^y&(T^_))+j[11]+643717713&4294967295,b=T+(E<<14&4294967295|E>>>18),E=y+(T^_&(b^T))+j[0]+3921069994&4294967295,y=b+(E<<20&4294967295|E>>>12),E=_+(b^T&(y^b))+j[5]+3593408605&4294967295,_=y+(E<<5&4294967295|E>>>27),E=T+(y^b&(_^y))+j[10]+38016083&4294967295,T=_+(E<<9&4294967295|E>>>23),E=b+(_^y&(T^_))+j[15]+3634488961&4294967295,b=T+(E<<14&4294967295|E>>>18),E=y+(T^_&(b^T))+j[4]+3889429448&4294967295,y=b+(E<<20&4294967295|E>>>12),E=_+(b^T&(y^b))+j[9]+568446438&4294967295,_=y+(E<<5&4294967295|E>>>27),E=T+(y^b&(_^y))+j[14]+3275163606&4294967295,T=_+(E<<9&4294967295|E>>>23),E=b+(_^y&(T^_))+j[3]+4107603335&4294967295,b=T+(E<<14&4294967295|E>>>18),E=y+(T^_&(b^T))+j[8]+1163531501&4294967295,y=b+(E<<20&4294967295|E>>>12),E=_+(b^T&(y^b))+j[13]+2850285829&4294967295,_=y+(E<<5&4294967295|E>>>27),E=T+(y^b&(_^y))+j[2]+4243563512&4294967295,T=_+(E<<9&4294967295|E>>>23),E=b+(_^y&(T^_))+j[7]+1735328473&4294967295,b=T+(E<<14&4294967295|E>>>18),E=y+(T^_&(b^T))+j[12]+2368359562&4294967295,y=b+(E<<20&4294967295|E>>>12),E=_+(y^b^T)+j[5]+4294588738&4294967295,_=y+(E<<4&4294967295|E>>>28),E=T+(_^y^b)+j[8]+2272392833&4294967295,T=_+(E<<11&4294967295|E>>>21),E=b+(T^_^y)+j[11]+1839030562&4294967295,b=T+(E<<16&4294967295|E>>>16),E=y+(b^T^_)+j[14]+4259657740&4294967295,y=b+(E<<23&4294967295|E>>>9),E=_+(y^b^T)+j[1]+2763975236&4294967295,_=y+(E<<4&4294967295|E>>>28),E=T+(_^y^b)+j[4]+1272893353&4294967295,T=_+(E<<11&4294967295|E>>>21),E=b+(T^_^y)+j[7]+4139469664&4294967295,b=T+(E<<16&4294967295|E>>>16),E=y+(b^T^_)+j[10]+3200236656&4294967295,y=b+(E<<23&4294967295|E>>>9),E=_+(y^b^T)+j[13]+681279174&4294967295,_=y+(E<<4&4294967295|E>>>28),E=T+(_^y^b)+j[0]+3936430074&4294967295,T=_+(E<<11&4294967295|E>>>21),E=b+(T^_^y)+j[3]+3572445317&4294967295,b=T+(E<<16&4294967295|E>>>16),E=y+(b^T^_)+j[6]+76029189&4294967295,y=b+(E<<23&4294967295|E>>>9),E=_+(y^b^T)+j[9]+3654602809&4294967295,_=y+(E<<4&4294967295|E>>>28),E=T+(_^y^b)+j[12]+3873151461&4294967295,T=_+(E<<11&4294967295|E>>>21),E=b+(T^_^y)+j[15]+530742520&4294967295,b=T+(E<<16&4294967295|E>>>16),E=y+(b^T^_)+j[2]+3299628645&4294967295,y=b+(E<<23&4294967295|E>>>9),E=_+(b^(y|~T))+j[0]+4096336452&4294967295,_=y+(E<<6&4294967295|E>>>26),E=T+(y^(_|~b))+j[7]+1126891415&4294967295,T=_+(E<<10&4294967295|E>>>22),E=b+(_^(T|~y))+j[14]+2878612391&4294967295,b=T+(E<<15&4294967295|E>>>17),E=y+(T^(b|~_))+j[5]+4237533241&4294967295,y=b+(E<<21&4294967295|E>>>11),E=_+(b^(y|~T))+j[12]+1700485571&4294967295,_=y+(E<<6&4294967295|E>>>26),E=T+(y^(_|~b))+j[3]+2399980690&4294967295,T=_+(E<<10&4294967295|E>>>22),E=b+(_^(T|~y))+j[10]+4293915773&4294967295,b=T+(E<<15&4294967295|E>>>17),E=y+(T^(b|~_))+j[1]+2240044497&4294967295,y=b+(E<<21&4294967295|E>>>11),E=_+(b^(y|~T))+j[8]+1873313359&4294967295,_=y+(E<<6&4294967295|E>>>26),E=T+(y^(_|~b))+j[15]+4264355552&4294967295,T=_+(E<<10&4294967295|E>>>22),E=b+(_^(T|~y))+j[6]+2734768916&4294967295,b=T+(E<<15&4294967295|E>>>17),E=y+(T^(b|~_))+j[13]+1309151649&4294967295,y=b+(E<<21&4294967295|E>>>11),E=_+(b^(y|~T))+j[4]+4149444226&4294967295,_=y+(E<<6&4294967295|E>>>26),E=T+(y^(_|~b))+j[11]+3174756917&4294967295,T=_+(E<<10&4294967295|E>>>22),E=b+(_^(T|~y))+j[2]+718787259&4294967295,b=T+(E<<15&4294967295|E>>>17),E=y+(T^(b|~_))+j[9]+3951481745&4294967295,S.g[0]=S.g[0]+_&4294967295,S.g[1]=S.g[1]+(b+(E<<21&4294967295|E>>>11))&4294967295,S.g[2]=S.g[2]+b&4294967295,S.g[3]=S.g[3]+T&4294967295}r.prototype.v=function(S,_){_===void 0&&(_=S.length);const y=_-this.blockSize,j=this.C;let b=this.h,T=0;for(;T<_;){if(b==0)for(;T<=y;)s(this,S,T),T+=this.blockSize;if(typeof S=="string"){for(;T<_;)if(j[b++]=S.charCodeAt(T++),b==this.blockSize){s(this,j),b=0;break}}else for(;T<_;)if(j[b++]=S[T++],b==this.blockSize){s(this,j),b=0;break}}this.h=b,this.o+=_},r.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var _=1;_<S.length-8;++_)S[_]=0;_=this.o*8;for(var y=S.length-8;y<S.length;++y)S[y]=_&255,_/=256;for(this.v(S),S=Array(16),_=0,y=0;y<4;++y)for(let j=0;j<32;j+=8)S[_++]=this.g[y]>>>j&255;return S};function o(S,_){var y=c;return Object.prototype.hasOwnProperty.call(y,S)?y[S]:y[S]=_(S)}function a(S,_){this.h=_;const y=[];let j=!0;for(let b=S.length-1;b>=0;b--){const T=S[b]|0;j&&T==_||(y[b]=T,j=!1)}this.g=y}var c={};function u(S){return-128<=S&&S<128?o(S,function(_){return new a([_|0],_<0?-1:0)}):new a([S|0],S<0?-1:0)}function d(S){if(isNaN(S)||!isFinite(S))return f;if(S<0)return D(d(-S));const _=[];let y=1;for(let j=0;S>=y;j++)_[j]=S/y|0,y*=4294967296;return new a(_,0)}function m(S,_){if(S.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(S.charAt(0)=="-")return D(m(S.substring(1),_));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const y=d(Math.pow(_,8));let j=f;for(let T=0;T<S.length;T+=8){var b=Math.min(8,S.length-T);const E=parseInt(S.substring(T,T+b),_);b<8?(b=d(Math.pow(_,b)),j=j.j(b).add(d(E))):(j=j.j(y),j=j.add(d(E)))}return j}var f=u(0),p=u(1),w=u(16777216);t=a.prototype,t.m=function(){if(R(this))return-D(this).m();let S=0,_=1;for(let y=0;y<this.g.length;y++){const j=this.i(y);S+=(j>=0?j:4294967296+j)*_,_*=4294967296}return S},t.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(C(this))return"0";if(R(this))return"-"+D(this).toString(S);const _=d(Math.pow(S,6));var y=this;let j="";for(;;){const b=L(y,_).g;y=x(y,b.j(_));let T=((y.g.length>0?y.g[0]:y.h)>>>0).toString(S);if(y=b,C(y))return T+j;for(;T.length<6;)T="0"+T;j=T+j}},t.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function C(S){if(S.h!=0)return!1;for(let _=0;_<S.g.length;_++)if(S.g[_]!=0)return!1;return!0}function R(S){return S.h==-1}t.l=function(S){return S=x(this,S),R(S)?-1:C(S)?0:1};function D(S){const _=S.g.length,y=[];for(let j=0;j<_;j++)y[j]=~S.g[j];return new a(y,~S.h).add(p)}t.abs=function(){return R(this)?D(this):this},t.add=function(S){const _=Math.max(this.g.length,S.g.length),y=[];let j=0;for(let b=0;b<=_;b++){let T=j+(this.i(b)&65535)+(S.i(b)&65535),E=(T>>>16)+(this.i(b)>>>16)+(S.i(b)>>>16);j=E>>>16,T&=65535,E&=65535,y[b]=E<<16|T}return new a(y,y[y.length-1]&-2147483648?-1:0)};function x(S,_){return S.add(D(_))}t.j=function(S){if(C(this)||C(S))return f;if(R(this))return R(S)?D(this).j(D(S)):D(D(this).j(S));if(R(S))return D(this.j(D(S)));if(this.l(w)<0&&S.l(w)<0)return d(this.m()*S.m());const _=this.g.length+S.g.length,y=[];for(var j=0;j<2*_;j++)y[j]=0;for(j=0;j<this.g.length;j++)for(let b=0;b<S.g.length;b++){const T=this.i(j)>>>16,E=this.i(j)&65535,Q=S.i(b)>>>16,P=S.i(b)&65535;y[2*j+2*b]+=E*P,v(y,2*j+2*b),y[2*j+2*b+1]+=T*P,v(y,2*j+2*b+1),y[2*j+2*b+1]+=E*Q,v(y,2*j+2*b+1),y[2*j+2*b+2]+=T*Q,v(y,2*j+2*b+2)}for(S=0;S<_;S++)y[S]=y[2*S+1]<<16|y[2*S];for(S=_;S<2*_;S++)y[S]=0;return new a(y,0)};function v(S,_){for(;(S[_]&65535)!=S[_];)S[_+1]+=S[_]>>>16,S[_]&=65535,_++}function I(S,_){this.g=S,this.h=_}function L(S,_){if(C(_))throw Error("division by zero");if(C(S))return new I(f,f);if(R(S))return _=L(D(S),_),new I(D(_.g),D(_.h));if(R(_))return _=L(S,D(_)),new I(D(_.g),_.h);if(S.g.length>30){if(R(S)||R(_))throw Error("slowDivide_ only works with positive integers.");for(var y=p,j=_;j.l(S)<=0;)y=B(y),j=B(j);var b=M(y,1),T=M(j,1);for(j=M(j,2),y=M(y,2);!C(j);){var E=T.add(j);E.l(S)<=0&&(b=b.add(y),T=E),j=M(j,1),y=M(y,1)}return _=x(S,b.j(_)),new I(b,_)}for(b=f;S.l(_)>=0;){for(y=Math.max(1,Math.floor(S.m()/_.m())),j=Math.ceil(Math.log(y)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),T=d(y),E=T.j(_);R(E)||E.l(S)>0;)y-=j,T=d(y),E=T.j(_);C(T)&&(T=p),b=b.add(T),S=x(S,E)}return new I(b,S)}t.B=function(S){return L(this,S).h},t.and=function(S){const _=Math.max(this.g.length,S.g.length),y=[];for(let j=0;j<_;j++)y[j]=this.i(j)&S.i(j);return new a(y,this.h&S.h)},t.or=function(S){const _=Math.max(this.g.length,S.g.length),y=[];for(let j=0;j<_;j++)y[j]=this.i(j)|S.i(j);return new a(y,this.h|S.h)},t.xor=function(S){const _=Math.max(this.g.length,S.g.length),y=[];for(let j=0;j<_;j++)y[j]=this.i(j)^S.i(j);return new a(y,this.h^S.h)};function B(S){const _=S.g.length+1,y=[];for(let j=0;j<_;j++)y[j]=S.i(j)<<1|S.i(j-1)>>>31;return new a(y,S.h)}function M(S,_){const y=_>>5;_%=32;const j=S.g.length-y,b=[];for(let T=0;T<j;T++)b[T]=_>0?S.i(T+y)>>>_|S.i(T+y+1)<<32-_:S.i(T+y);return new a(b,S.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,av=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=m,Vr=a}).apply(typeof vg<"u"?vg:typeof self<"u"?self:typeof window<"u"?window:{});var Xa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var lv,hi,cv,ml,th,uv,dv,hv;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xa=="object"&&Xa];for(var h=0;h<l.length;++h){var g=l[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(l,h){if(h)e:{var g=r;l=l.split(".");for(var A=0;A<l.length-1;A++){var V=l[A];if(!(V in g))break e;g=g[V]}l=l[l.length-1],A=g[l],h=h(A),h!=A&&h!=null&&e(g,l,{configurable:!0,writable:!0,value:h})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(h){var g=[],A;for(A in h)Object.prototype.hasOwnProperty.call(h,A)&&g.push([A,h[A]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function u(l,h,g){return l.call.apply(l.bind,arguments)}function d(l,h,g){return d=u,d.apply(null,arguments)}function m(l,h){var g=Array.prototype.slice.call(arguments,1);return function(){var A=g.slice();return A.push.apply(A,arguments),l.apply(this,A)}}function f(l,h){function g(){}g.prototype=h.prototype,l.Z=h.prototype,l.prototype=new g,l.prototype.constructor=l,l.Ob=function(A,V,U){for(var X=Array(arguments.length-2),he=2;he<arguments.length;he++)X[he-2]=arguments[he];return h.prototype[V].apply(A,X)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function w(l){const h=l.length;if(h>0){const g=Array(h);for(let A=0;A<h;A++)g[A]=l[A];return g}return[]}function C(l,h){for(let A=1;A<arguments.length;A++){const V=arguments[A];var g=typeof V;if(g=g!="object"?g:V?Array.isArray(V)?"array":g:"null",g=="array"||g=="object"&&typeof V.length=="number"){g=l.length||0;const U=V.length||0;l.length=g+U;for(let X=0;X<U;X++)l[g+X]=V[X]}else l.push(V)}}class R{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function D(l){a.setTimeout(()=>{throw l},0)}function x(){var l=S;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class v{constructor(){this.h=this.g=null}add(h,g){const A=I.get();A.set(h,g),this.h?this.h.next=A:this.g=A,this.h=A}}var I=new R(()=>new L,l=>l.reset());class L{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let B,M=!1,S=new v,_=()=>{const l=Promise.resolve(void 0);B=()=>{l.then(y)}};function y(){for(var l;l=x();){try{l.h.call(l.g)}catch(g){D(g)}var h=I;h.j(l),h.h<100&&(h.h++,l.next=h.g,h.g=l)}M=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function b(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}b.prototype.h=function(){this.defaultPrevented=!0};var T=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};a.addEventListener("test",g,h),a.removeEventListener("test",g,h)}catch{}return l}();function E(l){return/^[\s\xa0]*$/.test(l)}function Q(l,h){b.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,h)}f(Q,b),Q.prototype.init=function(l,h){const g=this.type=l.type,A=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget,h||(g=="mouseover"?h=l.fromElement:g=="mouseout"&&(h=l.toElement)),this.relatedTarget=h,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&Q.Z.h.call(this)},Q.prototype.h=function(){Q.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var P="closure_listenable_"+(Math.random()*1e6|0),F=0;function O(l,h,g,A,V){this.listener=l,this.proxy=null,this.src=h,this.type=g,this.capture=!!A,this.ha=V,this.key=++F,this.da=this.fa=!1}function k(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function G(l,h,g){for(const A in l)h.call(g,l[A],A,l)}function W(l,h){for(const g in l)h.call(void 0,l[g],g,l)}function Z(l){const h={};for(const g in l)h[g]=l[g];return h}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function oe(l,h){let g,A;for(let V=1;V<arguments.length;V++){A=arguments[V];for(g in A)l[g]=A[g];for(let U=0;U<ne.length;U++)g=ne[U],Object.prototype.hasOwnProperty.call(A,g)&&(l[g]=A[g])}}function re(l){this.src=l,this.g={},this.h=0}re.prototype.add=function(l,h,g,A,V){const U=l.toString();l=this.g[U],l||(l=this.g[U]=[],this.h++);const X=pe(l,h,A,V);return X>-1?(h=l[X],g||(h.fa=!1)):(h=new O(h,this.src,U,!!A,V),h.fa=g,l.push(h)),h};function Re(l,h){const g=h.type;if(g in l.g){var A=l.g[g],V=Array.prototype.indexOf.call(A,h,void 0),U;(U=V>=0)&&Array.prototype.splice.call(A,V,1),U&&(k(h),l.g[g].length==0&&(delete l.g[g],l.h--))}}function pe(l,h,g,A){for(let V=0;V<l.length;++V){const U=l[V];if(!U.da&&U.listener==h&&U.capture==!!g&&U.ha==A)return V}return-1}var tt="closure_lm_"+(Math.random()*1e6|0),Yt={};function jn(l,h,g,A,V){if(Array.isArray(h)){for(let U=0;U<h.length;U++)jn(l,h[U],g,A,V);return null}return g=de(g),l&&l[P]?l.J(h,g,c(A)?!!A.capture:!1,V):$(l,h,g,!1,A,V)}function $(l,h,g,A,V,U){if(!h)throw Error("Invalid event type");const X=c(V)?!!V.capture:!!V;let he=Cn(l);if(he||(l[tt]=he=new re(l)),g=he.add(h,g,A,X,U),g.proxy)return g;if(A=se(),g.proxy=A,A.src=l,A.listener=g,l.addEventListener)T||(V=X),V===void 0&&(V=!1),l.addEventListener(h.toString(),A,V);else if(l.attachEvent)l.attachEvent(Ct(h.toString()),A);else if(l.addListener&&l.removeListener)l.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return g}function se(){function l(g){return h.call(l.src,l.listener,g)}const h=We;return l}function Ne(l,h,g,A,V){if(Array.isArray(h))for(var U=0;U<h.length;U++)Ne(l,h[U],g,A,V);else A=c(A)?!!A.capture:!!A,g=de(g),l&&l[P]?(l=l.i,U=String(h).toString(),U in l.g&&(h=l.g[U],g=pe(h,g,A,V),g>-1&&(k(h[g]),Array.prototype.splice.call(h,g,1),h.length==0&&(delete l.g[U],l.h--)))):l&&(l=Cn(l))&&(h=l.g[h.toString()],l=-1,h&&(l=pe(h,g,A,V)),(g=l>-1?h[l]:null)&&nt(g))}function nt(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[P])Re(h.i,l);else{var g=l.type,A=l.proxy;h.removeEventListener?h.removeEventListener(g,A,l.capture):h.detachEvent?h.detachEvent(Ct(g),A):h.addListener&&h.removeListener&&h.removeListener(A),(g=Cn(h))?(Re(g,l),g.h==0&&(g.src=null,h[tt]=null)):k(l)}}}function Ct(l){return l in Yt?Yt[l]:Yt[l]="on"+l}function We(l,h){if(l.da)l=!0;else{h=new Q(h,this);const g=l.listener,A=l.ha||l.src;l.fa&&nt(l),l=g.call(A,h)}return l}function Cn(l){return l=l[tt],l instanceof re?l:null}var Et="__closure_events_fn_"+(Math.random()*1e9>>>0);function de(l){return typeof l=="function"?l:(l[Et]||(l[Et]=function(h){return l.handleEvent(h)}),l[Et])}function He(){j.call(this),this.i=new re(this),this.M=this,this.G=null}f(He,j),He.prototype[P]=!0,He.prototype.removeEventListener=function(l,h,g,A){Ne(this,l,h,g,A)};function ct(l,h){var g,A=l.G;if(A)for(g=[];A;A=A.G)g.push(A);if(l=l.M,A=h.type||h,typeof h=="string")h=new b(h,l);else if(h instanceof b)h.target=h.target||l;else{var V=h;h=new b(A,l),oe(h,V)}V=!0;let U,X;if(g)for(X=g.length-1;X>=0;X--)U=h.g=g[X],V=ar(U,A,!0,h)&&V;if(U=h.g=l,V=ar(U,A,!0,h)&&V,V=ar(U,A,!1,h)&&V,g)for(X=0;X<g.length;X++)U=h.g=g[X],V=ar(U,A,!1,h)&&V}He.prototype.N=function(){if(He.Z.N.call(this),this.i){var l=this.i;for(const h in l.g){const g=l.g[h];for(let A=0;A<g.length;A++)k(g[A]);delete l.g[h],l.h--}}this.G=null},He.prototype.J=function(l,h,g,A){return this.i.add(String(l),h,!1,g,A)},He.prototype.K=function(l,h,g,A){return this.i.add(String(l),h,!0,g,A)};function ar(l,h,g,A){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();let V=!0;for(let U=0;U<h.length;++U){const X=h[U];if(X&&!X.da&&X.capture==g){const he=X.listener,ut=X.ha||X.src;X.fa&&Re(l.i,X),V=he.call(ut,A)!==!1&&V}}return V&&!A.defaultPrevented}function va(l,h){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:a.setTimeout(l,h||0)}function Lo(l){l.g=va(()=>{l.g=null,l.i&&(l.i=!1,Lo(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class wa extends j{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Lo(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function es(l){j.call(this),this.h=l,this.g={}}f(es,j);var ts=[];function Vo(l){G(l.g,function(h,g){this.g.hasOwnProperty(g)&&nt(h)},l),l.g={}}es.prototype.N=function(){es.Z.N.call(this),Vo(this)},es.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yn=a.JSON.stringify,Xc=a.JSON.parse,Yc=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Mo(){}function _a(){}var ns={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function H(){b.call(this,"d")}f(H,b);function fe(){b.call(this,"c")}f(fe,b);var gt={},rs=null;function ks(){return rs=rs||new He}gt.Ia="serverreachability";function Fo(l){b.call(this,gt.Ia,l)}f(Fo,b);function Bo(l){const h=ks();ct(h,new Fo(h))}gt.STAT_EVENT="statevent";function om(l,h){b.call(this,gt.STAT_EVENT,l),this.stat=h}f(om,b);function Mt(l){const h=ks();ct(h,new om(h,l))}gt.Ja="timingevent";function im(l,h){b.call(this,gt.Ja,l),this.size=h}f(im,b);function Uo(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function $o(){this.g=!0}$o.prototype.ua=function(){this.g=!1};function zw(l,h,g,A,V,U){l.info(function(){if(l.g)if(U){var X="",he=U.split("&");for(let je=0;je<he.length;je++){var ut=he[je].split("=");if(ut.length>1){const xt=ut[0];ut=ut[1];const Rn=xt.split("_");X=Rn.length>=2&&Rn[1]=="type"?X+(xt+"="+ut+"&"):X+(xt+"=redacted&")}}}else X=null;else X=U;return"XMLHTTP REQ ("+A+") [attempt "+V+"]: "+h+`
`+g+`
`+X})}function Gw(l,h,g,A,V,U,X){l.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+V+"]: "+h+`
`+g+`
`+U+" "+X})}function Ps(l,h,g,A){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+Ww(l,g)+(A?" "+A:"")})}function qw(l,h){l.info(function(){return"TIMEOUT: "+h})}$o.prototype.info=function(){};function Ww(l,h){if(!l.g)return h;if(!h)return null;try{const U=JSON.parse(h);if(U){for(l=0;l<U.length;l++)if(Array.isArray(U[l])){var g=U[l];if(!(g.length<2)){var A=g[1];if(Array.isArray(A)&&!(A.length<1)){var V=A[0];if(V!="noop"&&V!="stop"&&V!="close")for(let X=1;X<A.length;X++)A[X]=""}}}}return yn(U)}catch{return h}}var Ea={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},am={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},lm;function Jc(){}f(Jc,Mo),Jc.prototype.g=function(){return new XMLHttpRequest},lm=new Jc;function zo(l){return encodeURIComponent(String(l))}function Hw(l){var h=1;l=l.split(":");const g=[];for(;h>0&&l.length;)g.push(l.shift()),h--;return l.length&&g.push(l.join(":")),g}function lr(l,h,g,A){this.j=l,this.i=h,this.l=g,this.S=A||1,this.V=new es(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new cm}function cm(){this.i=null,this.g="",this.h=!1}var um={},Zc={};function eu(l,h,g){l.M=1,l.A=Sa(bn(h)),l.u=g,l.R=!0,dm(l,null)}function dm(l,h){l.F=Date.now(),Aa(l),l.B=bn(l.A);var g=l.B,A=l.S;Array.isArray(A)||(A=[String(A)]),Sm(g.i,"t",A),l.C=0,g=l.j.L,l.h=new cm,l.g=$m(l.j,g?h:null,!l.u),l.P>0&&(l.O=new wa(d(l.Y,l,l.g),l.P)),h=l.V,g=l.g,A=l.ba;var V="readystatechange";Array.isArray(V)||(V&&(ts[0]=V.toString()),V=ts);for(let U=0;U<V.length;U++){const X=jn(g,V[U],A||h.handleEvent,!1,h.h||h);if(!X)break;h.g[X.key]=X}h=l.J?Z(l.J):{},l.u?(l.v||(l.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,h)):(l.v="GET",l.g.ea(l.B,l.v,null,h)),Bo(),zw(l.i,l.v,l.B,l.l,l.S,l.u)}lr.prototype.ba=function(l){l=l.target;const h=this.O;h&&dr(l)==3?h.j():this.Y(l)},lr.prototype.Y=function(l){try{if(l==this.g)e:{const he=dr(this.g),ut=this.g.ya(),je=this.g.ca();if(!(he<3)&&(he!=3||this.g&&(this.h.h||this.g.la()||Rm(this.g)))){this.K||he!=4||ut==7||(ut==8||je<=0?Bo(3):Bo(2)),tu(this);var h=this.g.ca();this.X=h;var g=Qw(this);if(this.o=h==200,Gw(this.i,this.v,this.B,this.l,this.S,he,h),this.o){if(this.U&&!this.L){t:{if(this.g){var A,V=this.g;if((A=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(A)){var U=A;break t}}U=null}if(l=U)Ps(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,nu(this,l);else{this.o=!1,this.m=3,Mt(12),ss(this),Go(this);break e}}if(this.R){l=!0;let xt;for(;!this.K&&this.C<g.length;)if(xt=Kw(this,g),xt==Zc){he==4&&(this.m=4,Mt(14),l=!1),Ps(this.i,this.l,null,"[Incomplete Response]");break}else if(xt==um){this.m=4,Mt(15),Ps(this.i,this.l,g,"[Invalid Chunk]"),l=!1;break}else Ps(this.i,this.l,xt,null),nu(this,xt);if(hm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),he!=4||g.length!=0||this.h.h||(this.m=1,Mt(16),l=!1),this.o=this.o&&l,!l)Ps(this.i,this.l,g,"[Invalid Chunked Response]"),ss(this),Go(this);else if(g.length>0&&!this.W){this.W=!0;var X=this.j;X.g==this&&X.aa&&!X.P&&(X.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),uu(X),X.P=!0,Mt(11))}}else Ps(this.i,this.l,g,null),nu(this,g);he==4&&ss(this),this.o&&!this.K&&(he==4?Mm(this.j,this):(this.o=!1,Aa(this)))}else c_(this.g),h==400&&g.indexOf("Unknown SID")>0?(this.m=3,Mt(12)):(this.m=0,Mt(13)),ss(this),Go(this)}}}catch{}finally{}};function Qw(l){if(!hm(l))return l.g.la();const h=Rm(l.g);if(h==="")return"";let g="";const A=h.length,V=dr(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return ss(l),Go(l),"";l.h.i=new a.TextDecoder}for(let U=0;U<A;U++)l.h.h=!0,g+=l.h.i.decode(h[U],{stream:!(V&&U==A-1)});return h.length=0,l.h.g+=g,l.C=0,l.h.g}function hm(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function Kw(l,h){var g=l.C,A=h.indexOf(`
`,g);return A==-1?Zc:(g=Number(h.substring(g,A)),isNaN(g)?um:(A+=1,A+g>h.length?Zc:(h=h.slice(A,A+g),l.C=A+g,h)))}lr.prototype.cancel=function(){this.K=!0,ss(this)};function Aa(l){l.T=Date.now()+l.H,fm(l,l.H)}function fm(l,h){if(l.D!=null)throw Error("WatchDog timer not null");l.D=Uo(d(l.aa,l),h)}function tu(l){l.D&&(a.clearTimeout(l.D),l.D=null)}lr.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(qw(this.i,this.B),this.M!=2&&(Bo(),Mt(17)),ss(this),this.m=2,Go(this)):fm(this,this.T-l)};function Go(l){l.j.I==0||l.K||Mm(l.j,l)}function ss(l){tu(l);var h=l.O;h&&typeof h.dispose=="function"&&h.dispose(),l.O=null,Vo(l.V),l.g&&(h=l.g,l.g=null,h.abort(),h.dispose())}function nu(l,h){try{var g=l.j;if(g.I!=0&&(g.g==l||ru(g.h,l))){if(!l.L&&ru(g.h,l)&&g.I==3){try{var A=g.Ba.g.parse(h)}catch{A=null}if(Array.isArray(A)&&A.length==3){var V=A;if(V[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<l.F)Ca(g),Ta(g);else break e;cu(g),Mt(18)}}else g.xa=V[1],0<g.xa-g.K&&V[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=Uo(d(g.Va,g),6e3));gm(g.h)<=1&&g.ta&&(g.ta=void 0)}else is(g,11)}else if((l.L||g.g==l)&&Ca(g),!E(h))for(V=g.Ba.g.parse(h),h=0;h<V.length;h++){let je=V[h];const xt=je[0];if(!(xt<=g.K))if(g.K=xt,je=je[1],g.I==2)if(je[0]=="c"){g.M=je[1],g.ba=je[2];const Rn=je[3];Rn!=null&&(g.ka=Rn,g.j.info("VER="+g.ka));const as=je[4];as!=null&&(g.za=as,g.j.info("SVER="+g.za));const hr=je[5];hr!=null&&typeof hr=="number"&&hr>0&&(A=1.5*hr,g.O=A,g.j.info("backChannelRequestTimeoutMs_="+A)),A=g;const fr=l.g;if(fr){const Ra=fr.g?fr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ra){var U=A.h;U.g||Ra.indexOf("spdy")==-1&&Ra.indexOf("quic")==-1&&Ra.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(su(U,U.h),U.h=null))}if(A.G){const du=fr.g?fr.g.getResponseHeader("X-HTTP-Session-Id"):null;du&&(A.wa=du,ke(A.J,A.G,du))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-l.F,g.j.info("Handshake RTT: "+g.T+"ms")),A=g;var X=l;if(A.na=Um(A,A.L?A.ba:null,A.W),X.L){xm(A.h,X);var he=X,ut=A.O;ut&&(he.H=ut),he.D&&(tu(he),Aa(he)),A.g=X}else Lm(A);g.i.length>0&&ja(g)}else je[0]!="stop"&&je[0]!="close"||is(g,7);else g.I==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?is(g,7):lu(g):je[0]!="noop"&&g.l&&g.l.qa(je),g.A=0)}}Bo(4)}catch{}}var Xw=class{constructor(l,h){this.g=l,this.map=h}};function mm(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function pm(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function gm(l){return l.h?1:l.g?l.g.size:0}function ru(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function su(l,h){l.g?l.g.add(h):l.h=h}function xm(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}mm.prototype.cancel=function(){if(this.i=ym(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function ym(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const g of l.g.values())h=h.concat(g.G);return h}return w(l.i)}var vm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yw(l,h){if(l){l=l.split("&");for(let g=0;g<l.length;g++){const A=l[g].indexOf("=");let V,U=null;A>=0?(V=l[g].substring(0,A),U=l[g].substring(A+1)):V=l[g],h(V,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function cr(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;l instanceof cr?(this.l=l.l,qo(this,l.j),this.o=l.o,this.g=l.g,Wo(this,l.u),this.h=l.h,ou(this,Nm(l.i)),this.m=l.m):l&&(h=String(l).match(vm))?(this.l=!1,qo(this,h[1]||"",!0),this.o=Ho(h[2]||""),this.g=Ho(h[3]||"",!0),Wo(this,h[4]),this.h=Ho(h[5]||"",!0),ou(this,h[6]||"",!0),this.m=Ho(h[7]||"")):(this.l=!1,this.i=new Ko(null,this.l))}cr.prototype.toString=function(){const l=[];var h=this.j;h&&l.push(Qo(h,wm,!0),":");var g=this.g;return(g||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Qo(h,wm,!0),"@"),l.push(zo(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&l.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(Qo(g,g.charAt(0)=="/"?e_:Zw,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",Qo(g,n_)),l.join("")},cr.prototype.resolve=function(l){const h=bn(this);let g=!!l.j;g?qo(h,l.j):g=!!l.o,g?h.o=l.o:g=!!l.g,g?h.g=l.g:g=l.u!=null;var A=l.h;if(g)Wo(h,l.u);else if(g=!!l.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var V=h.h.lastIndexOf("/");V!=-1&&(A=h.h.slice(0,V+1)+A)}if(V=A,V==".."||V==".")A="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){A=V.lastIndexOf("/",0)==0,V=V.split("/");const U=[];for(let X=0;X<V.length;){const he=V[X++];he=="."?A&&X==V.length&&U.push(""):he==".."?((U.length>1||U.length==1&&U[0]!="")&&U.pop(),A&&X==V.length&&U.push("")):(U.push(he),A=!0)}A=U.join("/")}else A=V}return g?h.h=A:g=l.i.toString()!=="",g?ou(h,Nm(l.i)):g=!!l.m,g&&(h.m=l.m),h};function bn(l){return new cr(l)}function qo(l,h,g){l.j=g?Ho(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Wo(l,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);l.u=h}else l.u=null}function ou(l,h,g){h instanceof Ko?(l.i=h,r_(l.i,l.l)):(g||(h=Qo(h,t_)),l.i=new Ko(h,l.l))}function ke(l,h,g){l.i.set(h,g)}function Sa(l){return ke(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function Ho(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Qo(l,h,g){return typeof l=="string"?(l=encodeURI(l).replace(h,Jw),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Jw(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var wm=/[#\/\?@]/g,Zw=/[#\?:]/g,e_=/[#\?]/g,t_=/[#\?@]/g,n_=/#/g;function Ko(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function os(l){l.g||(l.g=new Map,l.h=0,l.i&&Yw(l.i,function(h,g){l.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=Ko.prototype,t.add=function(l,h){os(this),this.i=null,l=Os(this,l);let g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(h),this.h+=1,this};function _m(l,h){os(l),h=Os(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Em(l,h){return os(l),h=Os(l,h),l.g.has(h)}t.forEach=function(l,h){os(this),this.g.forEach(function(g,A){g.forEach(function(V){l.call(h,V,A,this)},this)},this)};function Am(l,h){os(l);let g=[];if(typeof h=="string")Em(l,h)&&(g=g.concat(l.g.get(Os(l,h))));else for(l=Array.from(l.g.values()),h=0;h<l.length;h++)g=g.concat(l[h]);return g}t.set=function(l,h){return os(this),this.i=null,l=Os(this,l),Em(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=Am(this,l),l.length>0?String(l[0]):h):h};function Sm(l,h,g){_m(l,h),g.length>0&&(l.i=null,l.g.set(Os(l,h),w(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(let A=0;A<h.length;A++){var g=h[A];const V=zo(g);g=Am(this,g);for(let U=0;U<g.length;U++){let X=V;g[U]!==""&&(X+="="+zo(g[U])),l.push(X)}}return this.i=l.join("&")};function Nm(l){const h=new Ko;return h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),h}function Os(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function r_(l,h){h&&!l.j&&(os(l),l.i=null,l.g.forEach(function(g,A){const V=A.toLowerCase();A!=V&&(_m(this,A),Sm(this,V,g))},l)),l.j=h}function s_(l,h){const g=new $o;if(a.Image){const A=new Image;A.onload=m(ur,g,"TestLoadImage: loaded",!0,h,A),A.onerror=m(ur,g,"TestLoadImage: error",!1,h,A),A.onabort=m(ur,g,"TestLoadImage: abort",!1,h,A),A.ontimeout=m(ur,g,"TestLoadImage: timeout",!1,h,A),a.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=l}else h(!1)}function o_(l,h){const g=new $o,A=new AbortController,V=setTimeout(()=>{A.abort(),ur(g,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:A.signal}).then(U=>{clearTimeout(V),U.ok?ur(g,"TestPingServer: ok",!0,h):ur(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(V),ur(g,"TestPingServer: error",!1,h)})}function ur(l,h,g,A,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),A(g)}catch{}}function i_(){this.g=new Yc}function iu(l){this.i=l.Sb||null,this.h=l.ab||!1}f(iu,Mo),iu.prototype.g=function(){return new Na(this.i,this.h)};function Na(l,h){He.call(this),this.H=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Na,He),t=Na.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=h,this.readyState=1,Yo(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(h.body=l),(this.H||a).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Xo(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Yo(this)),this.g&&(this.readyState=3,Yo(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Im(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Im(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Xo(this):Yo(this),this.readyState==3&&Im(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,Xo(this))},t.Na=function(l){this.g&&(this.response=l,Xo(this))},t.ga=function(){this.g&&Xo(this)};function Xo(l){l.readyState=4,l.l=null,l.j=null,l.B=null,Yo(l)}t.setRequestHeader=function(l,h){this.A.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=h.next();return l.join(`\r
`)};function Yo(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Na.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Tm(l){let h="";return G(l,function(g,A){h+=A,h+=":",h+=g,h+=`\r
`}),h}function au(l,h,g){e:{for(A in g){var A=!1;break e}A=!0}A||(g=Tm(g),typeof l=="string"?g!=null&&zo(g):ke(l,h,g))}function Qe(l){He.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Qe,He);var a_=/^https?$/i,l_=["POST","PUT"];t=Qe.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,h,g,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():lm.g(),this.g.onreadystatechange=p(d(this.Ca,this));try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(U){jm(this,U);return}if(l=g||"",g=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var V in A)g.set(V,A[V]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const U of A.keys())g.set(U,A.get(U));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(g.keys()).find(U=>U.toLowerCase()=="content-type"),V=a.FormData&&l instanceof a.FormData,!(Array.prototype.indexOf.call(l_,h,void 0)>=0)||A||V||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,X]of g)this.g.setRequestHeader(U,X);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(U){jm(this,U)}};function jm(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.o=5,Cm(l),Ia(l)}function Cm(l){l.A||(l.A=!0,ct(l,"complete"),ct(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,ct(this,"complete"),ct(this,"abort"),Ia(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ia(this,!0)),Qe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?bm(this):this.Xa())},t.Xa=function(){bm(this)};function bm(l){if(l.h&&typeof o<"u"){if(l.v&&dr(l)==4)setTimeout(l.Ca.bind(l),0);else if(ct(l,"readystatechange"),dr(l)==4){l.h=!1;try{const U=l.ca();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var A;if(A=U===0){let X=String(l.D).match(vm)[1]||null;!X&&a.self&&a.self.location&&(X=a.self.location.protocol.slice(0,-1)),A=!a_.test(X?X.toLowerCase():"")}g=A}if(g)ct(l,"complete"),ct(l,"success");else{l.o=6;try{var V=dr(l)>2?l.g.statusText:""}catch{V=""}l.l=V+" ["+l.ca()+"]",Cm(l)}}finally{Ia(l)}}}}function Ia(l,h){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const g=l.g;l.g=null,h||ct(l,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function dr(l){return l.g?l.g.readyState:0}t.ca=function(){try{return dr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),Xc(h)}};function Rm(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function c_(l){const h={};l=(l.g&&dr(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<l.length;A++){if(E(l[A]))continue;var g=Hw(l[A]);const V=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const U=h[V]||[];h[V]=U,U.push(g)}W(h,function(A){return A.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Jo(l,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||h}function Dm(l){this.za=0,this.i=[],this.j=new $o,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Jo("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Jo("baseRetryDelayMs",5e3,l),this.Za=Jo("retryDelaySeedMs",1e4,l),this.Ta=Jo("forwardChannelMaxRetries",2,l),this.va=Jo("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new mm(l&&l.concurrentRequestLimit),this.Ba=new i_,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Dm.prototype,t.ka=8,t.I=1,t.connect=function(l,h,g,A){Mt(0),this.W=l,this.H=h||{},g&&A!==void 0&&(this.H.OSID=g,this.H.OAID=A),this.F=this.X,this.J=Um(this,null,this.W),ja(this)};function lu(l){if(km(l),l.I==3){var h=l.V++,g=bn(l.J);if(ke(g,"SID",l.M),ke(g,"RID",h),ke(g,"TYPE","terminate"),Zo(l,g),h=new lr(l,l.j,h),h.M=2,h.A=Sa(bn(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(h.A.toString(),"")}catch{}!g&&a.Image&&(new Image().src=h.A,g=!0),g||(h.g=$m(h.j,null),h.g.ea(h.A)),h.F=Date.now(),Aa(h)}Bm(l)}function Ta(l){l.g&&(uu(l),l.g.cancel(),l.g=null)}function km(l){Ta(l),l.v&&(a.clearTimeout(l.v),l.v=null),Ca(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&a.clearTimeout(l.m),l.m=null)}function ja(l){if(!pm(l.h)&&!l.m){l.m=!0;var h=l.Ea;B||_(),M||(B(),M=!0),S.add(h,l),l.D=0}}function u_(l,h){return gm(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=h.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=Uo(d(l.Ea,l,h),Fm(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const V=new lr(this,this.j,l);let U=this.o;if(this.U&&(U?(U=Z(U),oe(U,this.U)):U=this.U),this.u!==null||this.R||(V.J=U,U=null),this.S)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var A=this.i[g];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(h+=A,h>4096){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=Om(this,V,h),g=bn(this.J),ke(g,"RID",l),ke(g,"CVER",22),this.G&&ke(g,"X-HTTP-Session-Id",this.G),Zo(this,g),U&&(this.R?h="headers="+zo(Tm(U))+"&"+h:this.u&&au(g,this.u,U)),su(this.h,V),this.Ra&&ke(g,"TYPE","init"),this.S?(ke(g,"$req",h),ke(g,"SID","null"),V.U=!0,eu(V,g,null)):eu(V,g,h),this.I=2}}else this.I==3&&(l?Pm(this,l):this.i.length==0||pm(this.h)||Pm(this))};function Pm(l,h){var g;h?g=h.l:g=l.V++;const A=bn(l.J);ke(A,"SID",l.M),ke(A,"RID",g),ke(A,"AID",l.K),Zo(l,A),l.u&&l.o&&au(A,l.u,l.o),g=new lr(l,l.j,g,l.D+1),l.u===null&&(g.J=l.o),h&&(l.i=h.G.concat(l.i)),h=Om(l,g,1e3),g.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),su(l.h,g),eu(g,A,h)}function Zo(l,h){l.H&&G(l.H,function(g,A){ke(h,A,g)}),l.l&&G({},function(g,A){ke(h,A,g)})}function Om(l,h,g){g=Math.min(l.i.length,g);const A=l.l?d(l.l.Ka,l.l,l):null;e:{var V=l.i;let he=-1;for(;;){const ut=["count="+g];he==-1?g>0?(he=V[0].g,ut.push("ofs="+he)):he=0:ut.push("ofs="+he);let je=!0;for(let xt=0;xt<g;xt++){var U=V[xt].g;const Rn=V[xt].map;if(U-=he,U<0)he=Math.max(0,V[xt].g-100),je=!1;else try{U="req"+U+"_"||"";try{var X=Rn instanceof Map?Rn:Object.entries(Rn);for(const[as,hr]of X){let fr=hr;c(hr)&&(fr=yn(hr)),ut.push(U+as+"="+encodeURIComponent(fr))}}catch(as){throw ut.push(U+"type="+encodeURIComponent("_badmap")),as}}catch{A&&A(Rn)}}if(je){X=ut.join("&");break e}}X=void 0}return l=l.i.splice(0,g),h.G=l,X}function Lm(l){if(!l.g&&!l.v){l.Y=1;var h=l.Da;B||_(),M||(B(),M=!0),S.add(h,l),l.A=0}}function cu(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=Uo(d(l.Da,l),Fm(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,Vm(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=Uo(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Mt(10),Ta(this),Vm(this))};function uu(l){l.B!=null&&(a.clearTimeout(l.B),l.B=null)}function Vm(l){l.g=new lr(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var h=bn(l.na);ke(h,"RID","rpc"),ke(h,"SID",l.M),ke(h,"AID",l.K),ke(h,"CI",l.F?"0":"1"),!l.F&&l.ia&&ke(h,"TO",l.ia),ke(h,"TYPE","xmlhttp"),Zo(l,h),l.u&&l.o&&au(h,l.u,l.o),l.O&&(l.g.H=l.O);var g=l.g;l=l.ba,g.M=1,g.A=Sa(bn(h)),g.u=null,g.R=!0,dm(g,l)}t.Va=function(){this.C!=null&&(this.C=null,Ta(this),cu(this),Mt(19))};function Ca(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Mm(l,h){var g=null;if(l.g==h){Ca(l),uu(l),l.g=null;var A=2}else if(ru(l.h,h))g=h.G,xm(l.h,h),A=1;else return;if(l.I!=0){if(h.o)if(A==1){g=h.u?h.u.length:0,h=Date.now()-h.F;var V=l.D;A=ks(),ct(A,new im(A,g)),ja(l)}else Lm(l);else if(V=h.m,V==3||V==0&&h.X>0||!(A==1&&u_(l,h)||A==2&&cu(l)))switch(g&&g.length>0&&(h=l.h,h.i=h.i.concat(g)),V){case 1:is(l,5);break;case 4:is(l,10);break;case 3:is(l,6);break;default:is(l,2)}}}function Fm(l,h){let g=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(g*=2),g*h}function is(l,h){if(l.j.info("Error code "+h),h==2){var g=d(l.bb,l),A=l.Ua;const V=!A;A=new cr(A||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||qo(A,"https"),Sa(A),V?s_(A.toString(),g):o_(A.toString(),g)}else Mt(2);l.I=0,l.l&&l.l.pa(h),Bm(l),km(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Mt(2)):(this.j.info("Failed to ping google.com"),Mt(1))};function Bm(l){if(l.I=0,l.ja=[],l.l){const h=ym(l.h);(h.length!=0||l.i.length!=0)&&(C(l.ja,h),C(l.ja,l.i),l.h.i.length=0,w(l.i),l.i.length=0),l.l.oa()}}function Um(l,h,g){var A=g instanceof cr?bn(g):new cr(g);if(A.g!="")h&&(A.g=h+"."+A.g),Wo(A,A.u);else{var V=a.location;A=V.protocol,h=h?h+"."+V.hostname:V.hostname,V=+V.port;const U=new cr(null);A&&qo(U,A),h&&(U.g=h),V&&Wo(U,V),g&&(U.h=g),A=U}return g=l.G,h=l.wa,g&&h&&ke(A,g,h),ke(A,"VER",l.ka),Zo(l,A),A}function $m(l,h,g){if(h&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Aa&&!l.ma?new Qe(new iu({ab:g})):new Qe(l.ma),h.Fa(l.L),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function zm(){}t=zm.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ba(){}ba.prototype.g=function(l,h){return new Jt(l,h)};function Jt(l,h){He.call(this),this.g=new Dm(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(l?l["X-WebChannel-Client-Profile"]=h.sa:l={"X-WebChannel-Client-Profile":h.sa}),this.g.U=l,(l=h&&h.Qb)&&!E(l)&&(this.g.u=l),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!E(h)&&(this.g.G=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Ls(this)}f(Jt,He),Jt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Jt.prototype.close=function(){lu(this.g)},Jt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.v&&(g={},g.__data__=yn(l),l=g);h.i.push(new Xw(h.Ya++,l)),h.I==3&&ja(h)},Jt.prototype.N=function(){this.g.l=null,delete this.j,lu(this.g),delete this.g,Jt.Z.N.call(this)};function Gm(l){H.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const g in h){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}f(Gm,H);function qm(){fe.call(this),this.status=1}f(qm,fe);function Ls(l){this.g=l}f(Ls,zm),Ls.prototype.ra=function(){ct(this.g,"a")},Ls.prototype.qa=function(l){ct(this.g,new Gm(l))},Ls.prototype.pa=function(l){ct(this.g,new qm)},Ls.prototype.oa=function(){ct(this.g,"b")},ba.prototype.createWebChannel=ba.prototype.g,Jt.prototype.send=Jt.prototype.o,Jt.prototype.open=Jt.prototype.m,Jt.prototype.close=Jt.prototype.close,hv=function(){return new ba},dv=function(){return ks()},uv=gt,th={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ea.NO_ERROR=0,Ea.TIMEOUT=8,Ea.HTTP_ERROR=6,ml=Ea,am.COMPLETE="complete",cv=am,_a.EventType=ns,ns.OPEN="a",ns.CLOSE="b",ns.ERROR="c",ns.MESSAGE="d",He.prototype.listen=He.prototype.J,hi=_a,Qe.prototype.listenOnce=Qe.prototype.K,Qe.prototype.getLastError=Qe.prototype.Ha,Qe.prototype.getLastErrorCode=Qe.prototype.ya,Qe.prototype.getStatus=Qe.prototype.ca,Qe.prototype.getResponseJson=Qe.prototype.La,Qe.prototype.getResponseText=Qe.prototype.la,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Fa,lv=Qe}).apply(typeof Xa<"u"?Xa:typeof self<"u"?self:typeof window<"u"?window:{});const wg="@firebase/firestore",_g="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ot.UNAUTHENTICATED=new Ot(null),Ot.GOOGLE_CREDENTIALS=new Ot("google-credentials-uid"),Ot.FIRST_PARTY=new Ot("first-party-uid"),Ot.MOCK_USER=new Ot("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bo="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns=new tv("@firebase/firestore");function Ms(){return Ns.logLevel}function ee(t,...e){if(Ns.logLevel<=Ee.DEBUG){const n=e.map(Af);Ns.debug(`Firestore (${bo}): ${t}`,...n)}}function tr(t,...e){if(Ns.logLevel<=Ee.ERROR){const n=e.map(Af);Ns.error(`Firestore (${bo}): ${t}`,...n)}}function vo(t,...e){if(Ns.logLevel<=Ee.WARN){const n=e.map(Af);Ns.warn(`Firestore (${bo}): ${t}`,...n)}}function Af(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,fv(t,r,n)}function fv(t,e,n){let r=`FIRESTORE (${bo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw tr(r),new Error(r)}function Ae(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||fv(e,s,r)}function ue(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends Co{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class DS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ot.UNAUTHENTICATED))}shutdown(){}}class kS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class PS{constructor(e){this.t=e,this.currentUser=Ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ae(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let o=new Kn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Kn,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Kn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ae(typeof r.accessToken=="string",31837,{l:r}),new mv(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ae(e===null||typeof e=="string",2055,{h:e}),new Ot(e)}}class OS{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ot.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class LS{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new OS(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Eg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class VS{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,pS(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ae(this.o===void 0,3512);const r=o=>{o.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,ee("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const s=o=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Eg(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ae(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Eg(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=MS(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<n&&(r+=e.charAt(s[o]%62))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function nh(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),o=e.charAt(r);if(s!==o)return zu(s)===zu(o)?xe(s,o):zu(s)?1:-1}return xe(t.length,e.length)}const FS=55296,BS=57343;function zu(t){const e=t.charCodeAt(0);return e>=FS&&e<=BS}function wo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ag="__name__";class On{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ae(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return On.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof On?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const o=On.compareSegments(e.get(s),n.get(s));if(o!==0)return o}return xe(e.length,n.length)}static compareSegments(e,n){const r=On.isNumericId(e),s=On.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?On.extractNumericId(e).compare(On.extractNumericId(n)):nh(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vr.fromString(e.substring(4,e.length-2))}}class Te extends On{construct(e,n,r){return new Te(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new J(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Te(n)}static emptyPath(){return new Te([])}}const US=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nt extends On{construct(e,n,r){return new Nt(e,n,r)}static isValidIdentifier(e){return US.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ag}static keyField(){return new Nt([Ag])}static fromServerFormat(e){const n=[];let r="",s=0;const o=()=>{if(r.length===0)throw new J(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new J(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new J(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(o(),s++)}if(o(),a)throw new J(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nt(n)}static emptyPath(){return new Nt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie(Te.fromString(e))}static fromName(e){return new ie(Te.fromString(e).popFirst(5))}static empty(){return new ie(Te.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Te.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Te.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new Te(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv(t,e,n){if(!n)throw new J(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $S(t,e,n,r){if(e===!0&&r===!0)throw new J(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Sg(t){if(!ie.isDocumentKey(t))throw new J(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ng(t){if(ie.isDocumentKey(t))throw new J(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function gv(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Rc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae(12329,{type:typeof t})}function sn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new J(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Rc(t);throw new J(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(t,e){const n={typeString:t};return e&&(n.value=e),n}function ua(t,e){if(!gv(t))throw new J(z.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const a=t[r];if(s&&typeof a!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(o!==void 0&&a!==o.value){n=`Expected '${r}' field to equal '${o.value}'`;break}}if(n)throw new J(z.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig=-62135596800,Tg=1e6;class Oe{static now(){return Oe.fromMillis(Date.now())}static fromDate(e){return Oe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Tg);return new Oe(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new J(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new J(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Ig)throw new J(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Tg}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Oe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ua(e,Oe._jsonSchema))return new Oe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Ig;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Oe._jsonSchemaVersion="firestore/timestamp/1.0",Oe._jsonSchema={type:lt("string",Oe._jsonSchemaVersion),seconds:lt("number"),nanoseconds:lt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{static fromTimestamp(e){return new ce(e)}static min(){return new ce(new Oe(0,0))}static max(){return new ce(new Oe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=-1;function zS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ce.fromTimestamp(r===1e9?new Oe(n+1,0):new Oe(n,r));return new $r(s,ie.empty(),e)}function GS(t){return new $r(t.readTime,t.key,Zi)}class $r{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new $r(ce.min(),ie.empty(),Zi)}static max(){return new $r(ce.max(),ie.empty(),Zi)}}function qS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class HS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ro(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==WS)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let s=0,o=0,a=!1;e.forEach(c=>{++s,c.next(()=>{++o,a&&o===s&&n()},u=>r(u))}),a=!0,o===s&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(s=>s?q.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,o)=>{r.push(n.call(this,s,o))}),this.waitFor(r)}static mapArray(e,n){return new q((r,s)=>{const o=e.length,a=new Array(o);let c=0;for(let u=0;u<o;u++){const d=u;n(e[d]).next(m=>{a[d]=m,++c,c===o&&r(a)},m=>s(m))}})}static doWhile(e,n){return new q((r,s)=>{const o=()=>{e()===!0?n().next(()=>{o()},s):r()};o()})}}function QS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Do(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Dc.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf=-1;function da(t){return t==null}function Jl(t){return t===0&&1/t==-1/0}function KS(t){return typeof t=="number"&&Number.isInteger(t)&&!Jl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv="";function XS(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=jg(e)),e=YS(t.get(n),e);return jg(e)}function YS(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const o=t.charAt(s);switch(o){case"\0":n+="";break;case xv:n+="";break;default:n+=o}}return n}function jg(t){return t+xv+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Jr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function yv(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e,n){this.comparator=e,this.root=n||St.EMPTY}insert(e,n){return new qe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,St.BLACK,null,null))}remove(e){return new qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ya(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ya(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ya(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ya(this.root,e,this.comparator,!0)}}class Ya{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class St{constructor(e,n,r,s,o){this.key=e,this.value=n,this.color=r??St.RED,this.left=s??St.EMPTY,this.right=o??St.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,o){return new St(e??this.key,n??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const o=r(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,n,r),null):o===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return St.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return St.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,St.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,St.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ae(27949);return e+(this.isRed()?0:1)}}St.EMPTY=null,St.RED=!0,St.BLACK=!1;St.EMPTY=new class{constructor(){this.size=0}get key(){throw ae(57766)}get value(){throw ae(16141)}get color(){throw ae(16727)}get left(){throw ae(29726)}get right(){throw ae(36894)}copy(e,n,r,s,o){return this}insert(e,n,r){return new St(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.comparator=e,this.data=new qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new bg(this.data.getIterator())}getIteratorFrom(e){return new bg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof pt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new pt(this.comparator);return n.data=e,n}}class bg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.fields=e,e.sort(Nt.comparator)}static empty(){return new nn([])}unionWith(e){let n=new pt(Nt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new nn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return wo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new vv("Invalid base64 string: "+o):o}}(e);return new jt(n)}static fromUint8Array(e){const n=function(s){let o="";for(let a=0;a<s.length;++a)o+=String.fromCharCode(s[a]);return o}(e);return new jt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jt.EMPTY_BYTE_STRING=new jt("");const JS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zr(t){if(Ae(!!t,39018),typeof t=="string"){let e=0;const n=JS.exec(t);if(Ae(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Je(t.seconds),nanos:Je(t.nanos)}}function Je(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Gr(t){return typeof t=="string"?jt.fromBase64String(t):jt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv="server_timestamp",_v="__type__",Ev="__previous_value__",Av="__local_write_time__";function If(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[_v])==null?void 0:r.stringValue)===wv}function kc(t){const e=t.mapValue.fields[Ev];return If(e)?kc(e):e}function ea(t){const e=zr(t.mapValue.fields[Av].timestampValue);return new Oe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,n,r,s,o,a,c,u,d,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=m}}const Zl="(default)";class ta{constructor(e,n){this.projectId=e,this.database=n||Zl}static empty(){return new ta("","")}get isDefaultDatabase(){return this.database===Zl}isEqual(e){return e instanceof ta&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sv="__type__",eN="__max__",Ja={mapValue:{}},Nv="__vector__",ec="value";function qr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?If(t)?4:nN(t)?9007199254740991:tN(t)?10:11:ae(28295,{value:t})}function $n(t,e){if(t===e)return!0;const n=qr(t);if(n!==qr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ea(t).isEqual(ea(e));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const a=zr(s.timestampValue),c=zr(o.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,o){return Gr(s.bytesValue).isEqual(Gr(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,o){return Je(s.geoPointValue.latitude)===Je(o.geoPointValue.latitude)&&Je(s.geoPointValue.longitude)===Je(o.geoPointValue.longitude)}(t,e);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return Je(s.integerValue)===Je(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const a=Je(s.doubleValue),c=Je(o.doubleValue);return a===c?Jl(a)===Jl(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return wo(t.arrayValue.values||[],e.arrayValue.values||[],$n);case 10:case 11:return function(s,o){const a=s.mapValue.fields||{},c=o.mapValue.fields||{};if(Cg(a)!==Cg(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!$n(a[u],c[u])))return!1;return!0}(t,e);default:return ae(52216,{left:t})}}function na(t,e){return(t.values||[]).find(n=>$n(n,e))!==void 0}function _o(t,e){if(t===e)return 0;const n=qr(t),r=qr(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(o,a){const c=Je(o.integerValue||o.doubleValue),u=Je(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return Rg(t.timestampValue,e.timestampValue);case 4:return Rg(ea(t),ea(e));case 5:return nh(t.stringValue,e.stringValue);case 6:return function(o,a){const c=Gr(o),u=Gr(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const c=o.split("/"),u=a.split("/");for(let d=0;d<c.length&&d<u.length;d++){const m=xe(c[d],u[d]);if(m!==0)return m}return xe(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const c=xe(Je(o.latitude),Je(a.latitude));return c!==0?c:xe(Je(o.longitude),Je(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Dg(t.arrayValue,e.arrayValue);case 10:return function(o,a){var p,w,C,R;const c=o.fields||{},u=a.fields||{},d=(p=c[ec])==null?void 0:p.arrayValue,m=(w=u[ec])==null?void 0:w.arrayValue,f=xe(((C=d==null?void 0:d.values)==null?void 0:C.length)||0,((R=m==null?void 0:m.values)==null?void 0:R.length)||0);return f!==0?f:Dg(d,m)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===Ja.mapValue&&a===Ja.mapValue)return 0;if(o===Ja.mapValue)return 1;if(a===Ja.mapValue)return-1;const c=o.fields||{},u=Object.keys(c),d=a.fields||{},m=Object.keys(d);u.sort(),m.sort();for(let f=0;f<u.length&&f<m.length;++f){const p=nh(u[f],m[f]);if(p!==0)return p;const w=_o(c[u[f]],d[m[f]]);if(w!==0)return w}return xe(u.length,m.length)}(t.mapValue,e.mapValue);default:throw ae(23264,{he:n})}}function Rg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=zr(t),r=zr(e),s=xe(n.seconds,r.seconds);return s!==0?s:xe(n.nanos,r.nanos)}function Dg(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const o=_o(n[s],r[s]);if(o)return o}return xe(n.length,r.length)}function Eo(t){return rh(t)}function rh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=zr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Gr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const o of n.values||[])s?s=!1:r+=",",r+=rh(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const a of r)o?o=!1:s+=",",s+=`${a}:${rh(n.fields[a])}`;return s+"}"}(t.mapValue):ae(61005,{value:t})}function pl(t){switch(qr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=kc(t);return e?16+pl(e):16;case 5:return 2*t.stringValue.length;case 6:return Gr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,o)=>s+pl(o),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Jr(r.fields,(o,a)=>{s+=o.length+pl(a)}),s}(t.mapValue);default:throw ae(13486,{value:t})}}function kg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function sh(t){return!!t&&"integerValue"in t}function Tf(t){return!!t&&"arrayValue"in t}function Pg(t){return!!t&&"nullValue"in t}function Og(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function gl(t){return!!t&&"mapValue"in t}function tN(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Sv])==null?void 0:r.stringValue)===Nv}function Ni(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Jr(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ni(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ni(t.arrayValue.values[n]);return e}return{...t}}function nN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===eN}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.value=e}static empty(){return new Ut({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!gl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ni(n)}setAll(e){let n=Nt.emptyPath(),r={},s=[];e.forEach((a,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}a?r[c.lastSegment()]=Ni(a):s.push(c.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,s)}delete(e){const n=this.field(e.popLast());gl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return $n(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];gl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Jr(n,(s,o)=>e[s]=o);for(const s of r)delete e[s]}clone(){return new Ut(Ni(this.value))}}function Iv(t){const e=[];return Jr(t.fields,(n,r)=>{const s=new Nt([n]);if(gl(r)){const o=Iv(r.mapValue).fields;if(o.length===0)e.push(s);else for(const a of o)e.push(s.child(a))}else e.push(s)}),new nn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,n,r,s,o,a,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=o,this.data=a,this.documentState=c}static newInvalidDocument(e){return new wt(e,0,ce.min(),ce.min(),ce.min(),Ut.empty(),0)}static newFoundDocument(e,n,r,s){return new wt(e,1,n,ce.min(),r,s,0)}static newNoDocument(e,n){return new wt(e,2,n,ce.min(),ce.min(),Ut.empty(),0)}static newUnknownDocument(e,n){return new wt(e,3,n,ce.min(),ce.min(),Ut.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,n){this.position=e,this.inclusive=n}}function Lg(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const o=e[s],a=t.position[s];if(o.field.isKeyField()?r=ie.comparator(ie.fromName(a.referenceValue),n.key):r=_o(a,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Vg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!$n(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,n="asc"){this.field=e,this.dir=n}}function rN(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{}class at extends Tv{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new oN(e,n,r):n==="array-contains"?new lN(e,r):n==="in"?new cN(e,r):n==="not-in"?new uN(e,r):n==="array-contains-any"?new dN(e,r):new at(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new iN(e,r):new aN(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(_o(n,this.value)):n!==null&&qr(this.value)===qr(n)&&this.matchesComparison(_o(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tn extends Tv{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Tn(e,n)}matches(e){return jv(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function jv(t){return t.op==="and"}function Cv(t){return sN(t)&&jv(t)}function sN(t){for(const e of t.filters)if(e instanceof Tn)return!1;return!0}function oh(t){if(t instanceof at)return t.field.canonicalString()+t.op.toString()+Eo(t.value);if(Cv(t))return t.filters.map(e=>oh(e)).join(",");{const e=t.filters.map(n=>oh(n)).join(",");return`${t.op}(${e})`}}function bv(t,e){return t instanceof at?function(r,s){return s instanceof at&&r.op===s.op&&r.field.isEqual(s.field)&&$n(r.value,s.value)}(t,e):t instanceof Tn?function(r,s){return s instanceof Tn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((o,a,c)=>o&&bv(a,s.filters[c]),!0):!1}(t,e):void ae(19439)}function Rv(t){return t instanceof at?function(n){return`${n.field.canonicalString()} ${n.op} ${Eo(n.value)}`}(t):t instanceof Tn?function(n){return n.op.toString()+" {"+n.getFilters().map(Rv).join(" ,")+"}"}(t):"Filter"}class oN extends at{constructor(e,n,r){super(e,n,r),this.key=ie.fromName(r.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class iN extends at{constructor(e,n){super(e,"in",n),this.keys=Dv("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class aN extends at{constructor(e,n){super(e,"not-in",n),this.keys=Dv("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Dv(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ie.fromName(r.referenceValue))}class lN extends at{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Tf(n)&&na(n.arrayValue,this.value)}}class cN extends at{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&na(this.value.arrayValue,n)}}class uN extends at{constructor(e,n){super(e,"not-in",n)}matches(e){if(na(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!na(this.value.arrayValue,n)}}class dN extends at{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Tf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>na(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e,n=null,r=[],s=[],o=null,a=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=a,this.endAt=c,this.Te=null}}function Mg(t,e=null,n=[],r=[],s=null,o=null,a=null){return new hN(t,e,n,r,s,o,a)}function jf(t){const e=ue(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>oh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),da(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Eo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Eo(r)).join(",")),e.Te=n}return e.Te}function Cf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!rN(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!bv(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Vg(t.startAt,e.startAt)&&Vg(t.endAt,e.endAt)}function ih(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e,n=null,r=[],s=[],o=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function fN(t,e,n,r,s,o,a,c){return new ha(t,e,n,r,s,o,a,c)}function bf(t){return new ha(t)}function Fg(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function kv(t){return t.collectionGroup!==null}function Ii(t){const e=ue(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new pt(Nt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new nc(o,r))}),n.has(Nt.keyField().canonicalString())||e.Ie.push(new nc(Nt.keyField(),r))}return e.Ie}function Fn(t){const e=ue(t);return e.Ee||(e.Ee=mN(e,Ii(t))),e.Ee}function mN(t,e){if(t.limitType==="F")return Mg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new nc(s.field,o)});const n=t.endAt?new tc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new tc(t.startAt.position,t.startAt.inclusive):null;return Mg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ah(t,e){const n=t.filters.concat([e]);return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function lh(t,e,n){return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Pc(t,e){return Cf(Fn(t),Fn(e))&&t.limitType===e.limitType}function Pv(t){return`${jf(Fn(t))}|lt:${t.limitType}`}function Fs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Rv(s)).join(", ")}]`),da(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Eo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Eo(s)).join(",")),`Target(${r})`}(Fn(t))}; limitType=${t.limitType})`}function Oc(t,e){return e.isFoundDocument()&&function(r,s){const o=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):ie.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,s){for(const o of Ii(r))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const o of r.filters)if(!o.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,c,u){const d=Lg(a,c,u);return a.inclusive?d<=0:d<0}(r.startAt,Ii(r),s)||r.endAt&&!function(a,c,u){const d=Lg(a,c,u);return a.inclusive?d>=0:d>0}(r.endAt,Ii(r),s))}(t,e)}function pN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Ov(t){return(e,n)=>{let r=!1;for(const s of Ii(t)){const o=gN(s,e,n);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function gN(t,e,n){const r=t.field.isKeyField()?ie.comparator(e.key,n.key):function(o,a,c){const u=a.data.field(o),d=c.data.field(o);return u!==null&&d!==null?_o(u,d):ae(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,o]of r)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Jr(this.inner,(n,r)=>{for(const[s,o]of r)e(s,o)})}isEmpty(){return yv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xN=new qe(ie.comparator);function nr(){return xN}const Lv=new qe(ie.comparator);function fi(...t){let e=Lv;for(const n of t)e=e.insert(n.key,n);return e}function Vv(t){let e=Lv;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ps(){return Ti()}function Mv(){return Ti()}function Ti(){return new bs(t=>t.toString(),(t,e)=>t.isEqual(e))}const yN=new qe(ie.comparator),vN=new pt(ie.comparator);function ye(...t){let e=vN;for(const n of t)e=e.add(n);return e}const wN=new pt(xe);function _N(){return wN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Jl(e)?"-0":e}}function Fv(t){return{integerValue:""+t}}function EN(t,e){return KS(e)?Fv(e):Rf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(){this._=void 0}}function AN(t,e,n){return t instanceof rc?function(s,o){const a={fields:{[_v]:{stringValue:wv},[Av]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&If(o)&&(o=kc(o)),o&&(a.fields[Ev]=o),{mapValue:a}}(n,e):t instanceof ra?Uv(t,e):t instanceof sa?$v(t,e):function(s,o){const a=Bv(s,o),c=Bg(a)+Bg(s.Ae);return sh(a)&&sh(s.Ae)?Fv(c):Rf(s.serializer,c)}(t,e)}function SN(t,e,n){return t instanceof ra?Uv(t,e):t instanceof sa?$v(t,e):n}function Bv(t,e){return t instanceof sc?function(r){return sh(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class rc extends Lc{}class ra extends Lc{constructor(e){super(),this.elements=e}}function Uv(t,e){const n=zv(e);for(const r of t.elements)n.some(s=>$n(s,r))||n.push(r);return{arrayValue:{values:n}}}class sa extends Lc{constructor(e){super(),this.elements=e}}function $v(t,e){let n=zv(e);for(const r of t.elements)n=n.filter(s=>!$n(s,r));return{arrayValue:{values:n}}}class sc extends Lc{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Bg(t){return Je(t.integerValue||t.doubleValue)}function zv(t){return Tf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function NN(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ra&&s instanceof ra||r instanceof sa&&s instanceof sa?wo(r.elements,s.elements,$n):r instanceof sc&&s instanceof sc?$n(r.Ae,s.Ae):r instanceof rc&&s instanceof rc}(t.transform,e.transform)}class IN{constructor(e,n){this.version=e,this.transformResults=n}}class ft{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ft}static exists(e){return new ft(void 0,e)}static updateTime(e){return new ft(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Vc{}function Gv(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Mc(t.key,ft.none()):new fa(t.key,t.data,ft.none());{const n=t.data,r=Ut.empty();let s=new pt(Nt.comparator);for(let o of e.fields)if(!s.has(o)){let a=n.field(o);a===null&&o.length>1&&(o=o.popLast(),a=n.field(o)),a===null?r.delete(o):r.set(o,a),s=s.add(o)}return new Zr(t.key,r,new nn(s.toArray()),ft.none())}}function TN(t,e,n){t instanceof fa?function(s,o,a){const c=s.value.clone(),u=$g(s.fieldTransforms,o,a.transformResults);c.setAll(u),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Zr?function(s,o,a){if(!xl(s.precondition,o))return void o.convertToUnknownDocument(a.version);const c=$g(s.fieldTransforms,o,a.transformResults),u=o.data;u.setAll(qv(s)),u.setAll(c),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function ji(t,e,n,r){return t instanceof fa?function(o,a,c,u){if(!xl(o.precondition,a))return c;const d=o.value.clone(),m=zg(o.fieldTransforms,u,a);return d.setAll(m),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Zr?function(o,a,c,u){if(!xl(o.precondition,a))return c;const d=zg(o.fieldTransforms,u,a),m=a.data;return m.setAll(qv(o)),m.setAll(d),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(o,a,c){return xl(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,n)}function jN(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),o=Bv(r.transform,s||null);o!=null&&(n===null&&(n=Ut.empty()),n.set(r.field,o))}return n||null}function Ug(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&wo(r,s,(o,a)=>NN(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class fa extends Vc{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Zr extends Vc{constructor(e,n,r,s,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function qv(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function $g(t,e,n){const r=new Map;Ae(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const o=t[s],a=o.transform,c=e.data.field(o.field);r.set(o.field,SN(a,c,n[s]))}return r}function zg(t,e,n){const r=new Map;for(const s of t){const o=s.transform,a=n.data.field(s.field);r.set(s.field,AN(o,a,e))}return r}class Mc extends Vc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Wv extends Vc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&TN(o,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ji(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ji(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Mv();return this.mutations.forEach(s=>{const o=e.get(s.key),a=o.overlayedDocument;let c=this.applyToLocalView(a,o.mutatedFields);c=n.has(s.key)?null:c;const u=Gv(a,c);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(ce.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ye())}isEqual(e){return this.batchId===e.batchId&&wo(this.mutations,e.mutations,(n,r)=>Ug(n,r))&&wo(this.baseMutations,e.baseMutations,(n,r)=>Ug(n,r))}}class Df{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ae(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return yN}();const o=e.mutations;for(let a=0;a<o.length;a++)s=s.insert(o[a].key,r[a].version);return new Df(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ot,_e;function Hv(t){switch(t){case z.OK:return ae(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return ae(15467,{code:t})}}function Qv(t){if(t===void 0)return tr("GRPC error has no .code"),z.UNKNOWN;switch(t){case ot.OK:return z.OK;case ot.CANCELLED:return z.CANCELLED;case ot.UNKNOWN:return z.UNKNOWN;case ot.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case ot.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case ot.INTERNAL:return z.INTERNAL;case ot.UNAVAILABLE:return z.UNAVAILABLE;case ot.UNAUTHENTICATED:return z.UNAUTHENTICATED;case ot.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case ot.NOT_FOUND:return z.NOT_FOUND;case ot.ALREADY_EXISTS:return z.ALREADY_EXISTS;case ot.PERMISSION_DENIED:return z.PERMISSION_DENIED;case ot.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case ot.ABORTED:return z.ABORTED;case ot.OUT_OF_RANGE:return z.OUT_OF_RANGE;case ot.UNIMPLEMENTED:return z.UNIMPLEMENTED;case ot.DATA_LOSS:return z.DATA_LOSS;default:return ae(39323,{code:t})}}(_e=ot||(ot={}))[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DN(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN=new Vr([4294967295,4294967295],0);function Gg(t){const e=DN().encode(t),n=new av;return n.update(e),new Uint8Array(n.digest())}function qg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Vr([n,r],0),new Vr([s,o],0)]}class kf{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new mi(`Invalid padding: ${n}`);if(r<0)throw new mi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new mi(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Vr.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Vr.fromNumber(r)));return s.compare(kN)===1&&(s=new Vr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Gg(e),[r,s]=qg(n);for(let o=0;o<this.hashCount;o++){const a=this.ye(r,s,o);if(!this.we(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new kf(o,s,n);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const n=Gg(e),[r,s]=qg(n);for(let o=0;o<this.hashCount;o++){const a=this.ye(r,s,o);this.Se(a)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class mi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,n,r,s,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ma.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Fc(ce.min(),s,new qe(xe),nr(),ye())}}class ma{constructor(e,n,r,s,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ma(r,n,ye(),ye(),ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class Kv{constructor(e,n){this.targetId=e,this.Ce=n}}class Xv{constructor(e,n,r=jt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Wg{constructor(){this.ve=0,this.Fe=Hg(),this.Me=jt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ye(),n=ye(),r=ye();return this.Fe.forEach((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ae(38017,{changeType:o})}}),new ma(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Hg()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ae(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class PN{constructor(e){this.Ge=e,this.ze=new Map,this.je=nr(),this.Je=Za(),this.He=Za(),this.Ye=new qe(xe)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ae(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const o=s.target;if(ih(o))if(r===0){const a=new ie(o.path);this.et(n,a,wt.newNoDocument(a,ce.min()))}else Ae(r===1,20013,{expectedCount:r});else{const a=this._t(n);if(a!==r){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:o=0}=n;let a,c;try{a=Gr(r).toUint8Array()}catch(u){if(u instanceof vv)return vo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new kf(a,s,o)}catch(u){return vo(u instanceof mi?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(o=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.et(n,o,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((o,a)=>{const c=this.ot(a);if(c){if(o.current&&ih(c.target)){const u=new ie(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,wt.newNoDocument(u,e))}o.Be&&(n.set(a,o.ke()),o.qe())}});let r=ye();this.He.forEach((o,a)=>{let c=!0;a.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));const s=new Fc(e,n,this.Ye,this.je,r);return this.je=nr(),this.Je=Za(),this.He=Za(),this.Ye=new qe(xe),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Wg,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new pt(xe),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new pt(xe),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Wg),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Za(){return new qe(ie.comparator)}function Hg(){return new qe(ie.comparator)}const ON={asc:"ASCENDING",desc:"DESCENDING"},LN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},VN={and:"AND",or:"OR"};class MN{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ch(t,e){return t.useProto3Json||da(e)?e:{value:e}}function oc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yv(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function FN(t,e){return oc(t,e.toTimestamp())}function on(t){return Ae(!!t,49232),ce.fromTimestamp(function(n){const r=zr(n);return new Oe(r.seconds,r.nanos)}(t))}function Pf(t,e){return uh(t,e).canonicalString()}function uh(t,e){const n=function(s){return new Te(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Jv(t){const e=Te.fromString(t);return Ae(sw(e),10190,{key:e.toString()}),e}function ic(t,e){return Pf(t.databaseId,e.path)}function Ci(t,e){const n=Jv(e);if(n.get(1)!==t.databaseId.projectId)throw new J(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new J(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(ew(n))}function Zv(t,e){return Pf(t.databaseId,e)}function BN(t){const e=Jv(t);return e.length===4?Te.emptyPath():ew(e)}function dh(t){return new Te(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ew(t){return Ae(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Qg(t,e,n){return{name:ic(t,e),fields:n.value.mapValue.fields}}function UN(t,e){return"found"in e?function(r,s){Ae(!!s.found,43571),s.found.name,s.found.updateTime;const o=Ci(r,s.found.name),a=on(s.found.updateTime),c=s.found.createTime?on(s.found.createTime):ce.min(),u=new Ut({mapValue:{fields:s.found.fields}});return wt.newFoundDocument(o,a,c,u)}(t,e):"missing"in e?function(r,s){Ae(!!s.missing,3894),Ae(!!s.readTime,22933);const o=Ci(r,s.missing),a=on(s.readTime);return wt.newNoDocument(o,a)}(t,e):ae(7234,{result:e})}function $N(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ae(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=function(d,m){return d.useProto3Json?(Ae(m===void 0||typeof m=="string",58123),jt.fromBase64String(m||"")):(Ae(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),jt.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){const m=d.code===void 0?z.UNKNOWN:Qv(d.code);return new J(m,d.message||"")}(a);n=new Xv(r,s,o,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ci(t,r.document.name),o=on(r.document.updateTime),a=r.document.createTime?on(r.document.createTime):ce.min(),c=new Ut({mapValue:{fields:r.document.fields}}),u=wt.newFoundDocument(s,o,a,c),d=r.targetIds||[],m=r.removedTargetIds||[];n=new yl(d,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ci(t,r.document),o=r.readTime?on(r.readTime):ce.min(),a=wt.newNoDocument(s,o),c=r.removedTargetIds||[];n=new yl([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ci(t,r.document),o=r.removedTargetIds||[];n=new yl([],o,s,null)}else{if(!("filter"in e))return ae(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:o}=r,a=new RN(s,o),c=r.targetId;n=new Kv(c,a)}}return n}function tw(t,e){let n;if(e instanceof fa)n={update:Qg(t,e.key,e.value)};else if(e instanceof Mc)n={delete:ic(t,e.key)};else if(e instanceof Zr)n={update:Qg(t,e.key,e.data),updateMask:YN(e.fieldMask)};else{if(!(e instanceof Wv))return ae(16599,{Vt:e.type});n={verify:ic(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,a){const c=a.transform;if(c instanceof rc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof ra)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof sa)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof sc)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw ae(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:FN(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ae(27497)}(t,e.precondition)),n}function zN(t,e){return t&&t.length>0?(Ae(e!==void 0,14353),t.map(n=>function(s,o){let a=s.updateTime?on(s.updateTime):on(o);return a.isEqual(ce.min())&&(a=on(o)),new IN(a,s.transformResults||[])}(n,e))):[]}function GN(t,e){return{documents:[Zv(t,e.path)]}}function qN(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Zv(t,s);const o=function(d){if(d.length!==0)return rw(Tn.create(d,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const a=function(d){if(d.length!==0)return d.map(m=>function(p){return{field:Bs(p.field),direction:QN(p.dir)}}(m))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const c=ch(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function WN(t){let e=BN(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ae(r===1,65062);const m=n.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let o=[];n.where&&(o=function(f){const p=nw(f);return p instanceof Tn&&Cv(p)?p.getFilters():[p]}(n.where));let a=[];n.orderBy&&(a=function(f){return f.map(p=>function(C){return new nc(Us(C.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(p))}(n.orderBy));let c=null;n.limit&&(c=function(f){let p;return p=typeof f=="object"?f.value:f,da(p)?null:p}(n.limit));let u=null;n.startAt&&(u=function(f){const p=!!f.before,w=f.values||[];return new tc(w,p)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const p=!f.before,w=f.values||[];return new tc(w,p)}(n.endAt)),fN(e,s,a,o,c,"F",u,d)}function HN(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function nw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Us(n.unaryFilter.field);return at.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Us(n.unaryFilter.field);return at.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Us(n.unaryFilter.field);return at.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Us(n.unaryFilter.field);return at.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ae(61313);default:return ae(60726)}}(t):t.fieldFilter!==void 0?function(n){return at.create(Us(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ae(58110);default:return ae(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Tn.create(n.compositeFilter.filters.map(r=>nw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ae(1026)}}(n.compositeFilter.op))}(t):ae(30097,{filter:t})}function QN(t){return ON[t]}function KN(t){return LN[t]}function XN(t){return VN[t]}function Bs(t){return{fieldPath:t.canonicalString()}}function Us(t){return Nt.fromServerFormat(t.fieldPath)}function rw(t){return t instanceof at?function(n){if(n.op==="=="){if(Og(n.value))return{unaryFilter:{field:Bs(n.field),op:"IS_NAN"}};if(Pg(n.value))return{unaryFilter:{field:Bs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Og(n.value))return{unaryFilter:{field:Bs(n.field),op:"IS_NOT_NAN"}};if(Pg(n.value))return{unaryFilter:{field:Bs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bs(n.field),op:KN(n.op),value:n.value}}}(t):t instanceof Tn?function(n){const r=n.getFilters().map(s=>rw(s));return r.length===1?r[0]:{compositeFilter:{op:XN(n.op),filters:r}}}(t):ae(54877,{filter:t})}function YN(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,n,r,s,o=ce.min(),a=ce.min(),c=jt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Sr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e){this.yt=e}}function ZN(t){const e=WN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?lh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(){this.Cn=new tI}addToCollectionParentIndex(e,n){return this.Cn.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve($r.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve($r.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class tI{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new pt(Te.comparator),o=!s.has(r);return this.index[n]=s.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new pt(Te.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ow=41943040;class qt{static withCacheSize(e){return new qt(e,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qt.DEFAULT_COLLECTION_PERCENTILE=10,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qt.DEFAULT=new qt(ow,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qt.DISABLED=new qt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ao(0)}static cr(){return new Ao(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="LruGarbageCollector",nI=1048576;function Yg([t,e],[n,r]){const s=xe(t,n);return s===0?xe(e,r):s}class rI{constructor(e){this.Ir=e,this.buffer=new pt(Yg),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Yg(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class sI{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(Xg,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Do(n)?ee(Xg,"Ignoring IndexedDB error during garbage collection: ",n):await Ro(n)}await this.Vr(3e5)})}}class oI{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve(Dc.ce);const r=new rI(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(Kg)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Kg):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,o,a,c,u,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,a=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,c=Date.now(),this.removeTargets(e,r,n))).next(f=>(o=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Ms()<=Ee.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${o} targets in `+(u-c)+`ms
	Removed ${f} documents in `+(d-u)+`ms
Total Duration: ${d-m}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:f})))}}function iI(t,e){return new oI(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(){this.changes=new bs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,wt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ji(r.mutation,s,nn.empty(),Oe.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ye()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ye()){const s=ps();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(o=>{let a=fi();return o.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=ps();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ye()))}populateOverlays(e,n,r){const s=[];return r.forEach(o=>{n.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((a,c)=>{n.set(a,c)})})}computeViews(e,n,r,s){let o=nr();const a=Ti(),c=function(){return Ti()}();return n.forEach((u,d)=>{const m=r.get(d.key);s.has(d.key)&&(m===void 0||m.mutation instanceof Zr)?o=o.insert(d.key,d):m!==void 0?(a.set(d.key,m.mutation.getFieldMask()),ji(m.mutation,d,m.mutation.getFieldMask(),Oe.now())):a.set(d.key,nn.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((d,m)=>a.set(d,m)),n.forEach((d,m)=>c.set(d,new lI(m,a.get(d)??null))),c))}recalculateAndSaveOverlays(e,n){const r=Ti();let s=new qe((a,c)=>a-c),o=ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const c of a)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let m=r.get(u)||nn.empty();m=c.applyToLocalView(d,m),r.set(u,m);const f=(s.get(c.batchId)||ye()).add(u);s=s.insert(c.batchId,f)})}).next(()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,m=u.value,f=Mv();m.forEach(p=>{if(!o.has(p)){const w=Gv(n.get(p),r.get(p));w!==null&&f.set(p,w),o=o.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,f))}return q.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return ie.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):kv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(o=>{const a=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-o.size):q.resolve(ps());let c=Zi,u=o;return a.next(d=>q.forEach(d,(m,f)=>(c<f.largestBatchId&&(c=f.largestBatchId),o.get(m)?q.resolve():this.remoteDocumentCache.getEntry(e,m).next(p=>{u=u.insert(m,p)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,u,d,ye())).next(m=>({batchId:c,changes:Vv(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(r=>{let s=fi();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const o=n.collectionGroup;let a=fi();return this.indexManager.getCollectionParents(e,o).next(c=>q.forEach(c,u=>{const d=function(f,p){return new ha(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(m=>{m.forEach((f,p)=>{a=a.insert(f,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,s))).next(a=>{o.forEach((u,d)=>{const m=d.getKey();a.get(m)===null&&(a=a.insert(m,wt.newInvalidDocument(m)))});let c=fi();return a.forEach((u,d)=>{const m=o.get(u);m!==void 0&&ji(m.mutation,d,nn.empty(),Oe.now()),Oc(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return q.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:on(s.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:ZN(s.bundledQuery),readTime:on(s.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(){this.overlays=new qe(ie.comparator),this.qr=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ps();return q.forEach(n,s=>this.getOverlay(e,s).next(o=>{o!==null&&r.set(s,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,o)=>{this.St(e,n,o)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const s=ps(),o=n.length+1,a=new ie(n.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===o&&u.largestBatchId>r&&s.set(u.getKey(),u)}return q.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let o=new qe((d,m)=>d-m);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let m=o.get(d.largestBatchId);m===null&&(m=ps(),o=o.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const c=ps(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,m)=>c.set(d,m)),!(c.size()>=s)););return q.resolve(c)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new bN(n,r));let o=this.qr.get(n);o===void 0&&(o=ye(),this.qr.set(n,o)),this.qr.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(){this.sessionToken=jt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(){this.Qr=new pt(yt.$r),this.Ur=new pt(yt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new yt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new yt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ie(new Te([])),r=new yt(n,e),s=new yt(n,e+1),o=[];return this.Ur.forEachInRange([r,s],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ie(new Te([])),r=new yt(n,e),s=new yt(n,e+1);let o=ye();return this.Ur.forEachInRange([r,s],a=>{o=o.add(a.key)}),o}containsKey(e){const n=new yt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class yt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ie.comparator(e.key,n.key)||xe(e.Yr,n.Yr)}static Kr(e,n){return xe(e.Yr,n.Yr)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new pt(yt.$r)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new CN(o,n,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new yt(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return q.resolve(a)}lookupMutationBatch(e,n){return q.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),o=s<0?0:s;return q.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Nf:this.tr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new yt(n,0),s=new yt(n,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,s],a=>{const c=this.Xr(a.Yr);o.push(c)}),q.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new pt(xe);return n.forEach(s=>{const o=new yt(s,0),a=new yt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],c=>{r=r.add(c.Yr)})}),q.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let o=r;ie.isDocumentKey(o)||(o=o.child(""));const a=new yt(new ie(o),0);let c=new pt(xe);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.Yr)),!0)},a),q.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ae(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return q.forEach(n.mutations,s=>{const o=new yt(s.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new yt(n,0),s=this.Zr.firstAfterOrEqual(r);return q.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(e){this.ri=e,this.docs=function(){return new qe(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),o=s?s.size:0,a=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():wt.newInvalidDocument(n))}getEntries(e,n){let r=nr();return n.forEach(s=>{const o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():wt.newInvalidDocument(s))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let o=nr();const a=n.path,c=new ie(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:m}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||qS(GS(m),r)<=0||(s.has(m.key)||Oc(n,m))&&(o=o.insert(m.key,m.mutableCopy()))}return q.resolve(o)}getAllFromCollectionGroup(e,n,r,s){ae(9500)}ii(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new pI(this)}getSize(e){return q.resolve(this.size)}}class pI extends aI{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e){this.persistence=e,this.si=new bs(n=>jf(n),Cf),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this.oi=0,this._i=new Of,this.targetCount=0,this.ai=Ao.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),q.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Ao(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.Pr(n),q.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let s=0;const o=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),q.waitFor(o).next(()=>s)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),q.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,o=[];return s&&n.forEach(a=>{o.push(s.markPotentiallyOrphaned(e,a))}),q.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,n){this.ui={},this.overlays={},this.ci=new Dc(0),this.li=!1,this.li=!0,this.hi=new hI,this.referenceDelegate=e(this),this.Pi=new gI(this),this.indexManager=new eI,this.remoteDocumentCache=function(s){return new mI(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new JN(n),this.Ii=new uI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new dI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new fI(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const s=new xI(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(o=>this.referenceDelegate.di(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Ai(e,n){return q.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class xI extends HS{constructor(e){super(),this.currentSequenceNumber=e}}class Lf{constructor(e){this.persistence=e,this.Ri=new Of,this.Vi=null}static mi(e){return new Lf(e)}get fi(){if(this.Vi)return this.Vi;throw ae(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),q.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(o=>this.fi.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,r=>{const s=ie.fromPath(r);return this.gi(e,s).next(o=>{o||n.removeEntry(s,ce.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return q.or([()=>q.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class ac{constructor(e,n){this.persistence=e,this.pi=new bs(r=>XS(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=iI(this,n)}static mi(e,n){return new ac(e,n)}Ei(){}di(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return q.forEach(this.pi,(r,s)=>this.br(e,r,s).next(o=>o?q.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(e,a=>this.br(e,a,n).next(c=>{c||(r++,o.removeEntry(a,ce.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=pl(e.data.value)),n}br(e,n,r){return q.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return q.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=ye(),s=ye();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new Vf(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return hA()?8:QS(uA())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const o={result:null};return this.ys(e,n).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,n,s,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new yI;return this.Ss(e,n,a).next(c=>{if(o.result=c,this.Vs)return this.bs(e,n,a,c.size)})}).next(()=>o.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Ms()<=Ee.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",Fs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(Ms()<=Ee.DEBUG&&ee("QueryEngine","Query:",Fs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Ms()<=Ee.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",Fs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fn(n))):q.resolve())}ys(e,n){if(Fg(n))return q.resolve(null);let r=Fn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=lh(n,null,"F"),r=Fn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const a=ye(...o);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.Ds(n,c);return this.Cs(n,d,a,u.readTime)?this.ys(e,lh(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,r,s){return Fg(n)||s.isEqual(ce.min())?q.resolve(null):this.ps.getDocuments(e,r).next(o=>{const a=this.Ds(n,o);return this.Cs(n,a,r,s)?q.resolve(null):(Ms()<=Ee.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Fs(n)),this.vs(e,a,n,zS(s,Zi)).next(c=>c))})}Ds(e,n){let r=new pt(Ov(e));return n.forEach((s,o)=>{Oc(e,o)&&(r=r.add(o))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(e,n,r){return Ms()<=Ee.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",Fs(n)),this.ps.getDocumentsMatchingQuery(e,n,$r.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(o=>(n.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf="LocalStore",wI=3e8;class _I{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new qe(xe),this.xs=new bs(o=>jf(o),Cf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cI(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function EI(t,e,n,r){return new _I(t,e,n,r)}async function aw(t,e){const n=ue(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const a=[],c=[];let u=ye();for(const d of s){a.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}for(const d of o){c.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:c}))})})}function AI(t,e){const n=ue(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),o=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,d,m){const f=d.batch,p=f.keys();let w=q.resolve();return p.forEach(C=>{w=w.next(()=>m.getEntry(u,C)).next(R=>{const D=d.docVersions.get(C);Ae(D!==null,48541),R.version.compareTo(D)<0&&(f.applyToRemoteDocument(R,d),R.isValidDocument()&&(R.setReadTime(d.commitVersion),m.addEntry(R)))})}),w.next(()=>c.mutationQueue.removeMutationBatch(u,f))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=ye();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function lw(t){const e=ue(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function SI(t,e){const n=ue(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const c=[];e.targetChanges.forEach((m,f)=>{const p=s.get(f);if(!p)return;c.push(n.Pi.removeMatchingKeys(o,m.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(o,m.addedDocuments,f)));let w=p.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(f)!==null?w=w.withResumeToken(jt.EMPTY_BYTE_STRING,ce.min()).withLastLimboFreeSnapshotVersion(ce.min()):m.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(m.resumeToken,r)),s=s.insert(f,w),function(R,D,x){return R.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=wI?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(p,w,m)&&c.push(n.Pi.updateTargetData(o,w))});let u=nr(),d=ye();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(o,m))}),c.push(NI(o,a,e.documentUpdates).next(m=>{u=m.ks,d=m.qs})),!r.isEqual(ce.min())){const m=n.Pi.getLastRemoteSnapshotVersion(o).next(f=>n.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r));c.push(m)}return q.waitFor(c).next(()=>a.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,u,d)).next(()=>u)}).then(o=>(n.Ms=s,o))}function NI(t,e,n){let r=ye(),s=ye();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let a=nr();return n.forEach((c,u)=>{const d=o.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(ce.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):ee(Mf,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{ks:a,qs:s}})}function II(t,e){const n=ue(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Nf),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function TI(t,e){const n=ue(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(o=>o?(s=o,q.resolve(s)):n.Pi.allocateTargetId(r).next(a=>(s=new Sr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function hh(t,e,n){const r=ue(t),s=r.Ms.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Do(a))throw a;ee(Mf,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Jg(t,e,n){const r=ue(t);let s=ce.min(),o=ye();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,m){const f=ue(u),p=f.xs.get(m);return p!==void 0?q.resolve(f.Ms.get(p)):f.Pi.getTargetData(d,m)}(r,a,Fn(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{o=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(a,e,n?s:ce.min(),n?o:ye())).next(c=>(jI(r,pN(e),c),{documents:c,Qs:o})))}function jI(t,e,n){let r=t.Os.get(e)||ce.min();n.forEach((s,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.Os.set(e,r)}class Zg{constructor(){this.activeTargetIds=_N()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class CI{constructor(){this.Mo=new Zg,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Zg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex="ConnectivityMonitor";class tx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(ex,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(ex,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let el=null;function fh(){return el===null?el=function(){return 268435456+Math.round(2147483648*Math.random())}():el++,"0x"+el.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gu="RestConnection",RI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class DI{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Zl?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,o){const a=fh(),c=this.zo(e,n.toUriEncodedString());ee(Gu,`Sending RPC '${e}' ${a}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,o);const{host:d}=new URL(c),m=_f(d);return this.Jo(e,c,u,r,m).then(f=>(ee(Gu,`Received RPC '${e}' ${a}: `,f),f),f=>{throw vo(Gu,`RPC '${e}' ${a} failed with error: `,f,"url: ",c,"request:",r),f})}Ho(e,n,r,s,o,a){return this.Go(e,n,r,s,o)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+bo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>e[o]=s),r&&r.headers.forEach((s,o)=>e[o]=s)}zo(e,n){const r=RI[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dt="WebChannelConnection";class PI extends DI{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,o){const a=fh();return new Promise((c,u)=>{const d=new lv;d.setWithCredentials(!0),d.listenOnce(cv.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case ml.NO_ERROR:const f=d.getResponseJson();ee(Dt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),c(f);break;case ml.TIMEOUT:ee(Dt,`RPC '${e}' ${a} timed out`),u(new J(z.DEADLINE_EXCEEDED,"Request time out"));break;case ml.HTTP_ERROR:const p=d.getStatus();if(ee(Dt,`RPC '${e}' ${a} failed with status:`,p,"response text:",d.getResponseText()),p>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const C=w==null?void 0:w.error;if(C&&C.status&&C.message){const R=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(v)>=0?v:z.UNKNOWN}(C.status);u(new J(R,C.message))}else u(new J(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new J(z.UNAVAILABLE,"Connection failed."));break;default:ae(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ee(Dt,`RPC '${e}' ${a} completed.`)}});const m=JSON.stringify(s);ee(Dt,`RPC '${e}' ${a} sending request:`,s),d.send(n,"POST",m,r,15)})}T_(e,n,r){const s=fh(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=hv(),c=dv(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const m=o.join("");ee(Dt,`Creating RPC '${e}' stream ${s}: ${m}`,u);const f=a.createWebChannel(m,u);this.I_(f);let p=!1,w=!1;const C=new kI({Yo:D=>{w?ee(Dt,`Not sending because RPC '${e}' stream ${s} is closed:`,D):(p||(ee(Dt,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),ee(Dt,`RPC '${e}' stream ${s} sending:`,D),f.send(D))},Zo:()=>f.close()}),R=(D,x,v)=>{D.listen(x,I=>{try{v(I)}catch(L){setTimeout(()=>{throw L},0)}})};return R(f,hi.EventType.OPEN,()=>{w||(ee(Dt,`RPC '${e}' stream ${s} transport opened.`),C.o_())}),R(f,hi.EventType.CLOSE,()=>{w||(w=!0,ee(Dt,`RPC '${e}' stream ${s} transport closed`),C.a_(),this.E_(f))}),R(f,hi.EventType.ERROR,D=>{w||(w=!0,vo(Dt,`RPC '${e}' stream ${s} transport errored. Name:`,D.name,"Message:",D.message),C.a_(new J(z.UNAVAILABLE,"The operation could not be completed")))}),R(f,hi.EventType.MESSAGE,D=>{var x;if(!w){const v=D.data[0];Ae(!!v,16349);const I=v,L=(I==null?void 0:I.error)||((x=I[0])==null?void 0:x.error);if(L){ee(Dt,`RPC '${e}' stream ${s} received error:`,L);const B=L.status;let M=function(y){const j=ot[y];if(j!==void 0)return Qv(j)}(B),S=L.message;M===void 0&&(M=z.INTERNAL,S="Unknown error status: "+B+" with message "+L.message),w=!0,C.a_(new J(M,S)),f.close()}else ee(Dt,`RPC '${e}' stream ${s} received:`,v),C.u_(v)}}),R(c,uv.STAT_EVENT,D=>{D.stat===th.PROXY?ee(Dt,`RPC '${e}' stream ${s} detected buffering proxy`):D.stat===th.NOPROXY&&ee(Dt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function qu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t){return new MN(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,n,r=1e3,s=1.5,o=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nx="PersistentStream";class cw{constructor(e,n,r,s,o,a,c,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ff(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(tr(n.toString()),tr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new J(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(nx,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(nx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OI extends cw{constructor(e,n,r,s,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=o}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=$N(this.serializer,e),r=function(o){if(!("targetChange"in o))return ce.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?ce.min():a.readTime?on(a.readTime):ce.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=dh(this.serializer),n.addTarget=function(o,a){let c;const u=a.target;if(c=ih(u)?{documents:GN(o,u)}:{query:qN(o,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Yv(o,a.resumeToken);const d=ch(o,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(ce.min())>0){c.readTime=oc(o,a.snapshotVersion.toTimestamp());const d=ch(o,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=HN(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=dh(this.serializer),n.removeTarget=e,this.q_(n)}}class LI extends cw{constructor(e,n,r,s,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Ae(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ae(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ae(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=zN(e.writeResults,e.commitTime),r=on(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=dh(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>tw(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{}class MI extends VI{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new J(z.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,uh(n,r),s,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new J(z.UNKNOWN,o.toString())})}Ho(e,n,r,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,uh(n,r),s,a,c,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new J(z.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class FI{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(tr(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is="RemoteStore";class BI{constructor(e,n,r,s,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{r.enqueueAndForget(async()=>{Rs(this)&&(ee(Is,"Restarting streams for network reachability change."),await async function(u){const d=ue(u);d.Ea.add(4),await pa(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Uc(d)}(this))})}),this.Ra=new FI(r,s)}}async function Uc(t){if(Rs(t))for(const e of t.da)await e(!0)}async function pa(t){for(const e of t.da)await e(!1)}function uw(t,e){const n=ue(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),zf(n)?$f(n):ko(n).O_()&&Uf(n,e))}function Bf(t,e){const n=ue(t),r=ko(n);n.Ia.delete(e),r.O_()&&dw(n,e),n.Ia.size===0&&(r.O_()?r.L_():Rs(n)&&n.Ra.set("Unknown"))}function Uf(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ce.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ko(t).Y_(e)}function dw(t,e){t.Va.Ue(e),ko(t).Z_(e)}function $f(t){t.Va=new PN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ko(t).start(),t.Ra.ua()}function zf(t){return Rs(t)&&!ko(t).x_()&&t.Ia.size>0}function Rs(t){return ue(t).Ea.size===0}function hw(t){t.Va=void 0}async function UI(t){t.Ra.set("Online")}async function $I(t){t.Ia.forEach((e,n)=>{Uf(t,e)})}async function zI(t,e){hw(t),zf(t)?(t.Ra.ha(e),$f(t)):t.Ra.set("Unknown")}async function GI(t,e,n){if(t.Ra.set("Online"),e instanceof Xv&&e.state===2&&e.cause)try{await async function(s,o){const a=o.cause;for(const c of o.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))}(t,e)}catch(r){ee(Is,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await lc(t,r)}else if(e instanceof yl?t.Va.Ze(e):e instanceof Kv?t.Va.st(e):t.Va.tt(e),!n.isEqual(ce.min()))try{const r=await lw(t.localStore);n.compareTo(r)>=0&&await function(o,a){const c=o.Va.Tt(a);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const m=o.Ia.get(d);m&&o.Ia.set(d,m.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,d)=>{const m=o.Ia.get(u);if(!m)return;o.Ia.set(u,m.withResumeToken(jt.EMPTY_BYTE_STRING,m.snapshotVersion)),dw(o,u);const f=new Sr(m.target,u,d,m.sequenceNumber);Uf(o,f)}),o.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){ee(Is,"Failed to raise snapshot:",r),await lc(t,r)}}async function lc(t,e,n){if(!Do(e))throw e;t.Ea.add(1),await pa(t),t.Ra.set("Offline"),n||(n=()=>lw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(Is,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Uc(t)})}function fw(t,e){return e().catch(n=>lc(t,n,e))}async function $c(t){const e=ue(t),n=Wr(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Nf;for(;qI(e);)try{const s=await II(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,WI(e,s)}catch(s){await lc(e,s)}mw(e)&&pw(e)}function qI(t){return Rs(t)&&t.Ta.length<10}function WI(t,e){t.Ta.push(e);const n=Wr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function mw(t){return Rs(t)&&!Wr(t).x_()&&t.Ta.length>0}function pw(t){Wr(t).start()}async function HI(t){Wr(t).ra()}async function QI(t){const e=Wr(t);for(const n of t.Ta)e.ea(n.mutations)}async function KI(t,e,n){const r=t.Ta.shift(),s=Df.from(r,e,n);await fw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await $c(t)}async function XI(t,e){e&&Wr(t).X_&&await async function(r,s){if(function(a){return Hv(a)&&a!==z.ABORTED}(s.code)){const o=r.Ta.shift();Wr(r).B_(),await fw(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),await $c(r)}}(t,e),mw(t)&&pw(t)}async function rx(t,e){const n=ue(t);n.asyncQueue.verifyOperationInProgress(),ee(Is,"RemoteStore received new credentials");const r=Rs(n);n.Ea.add(3),await pa(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Uc(n)}async function YI(t,e){const n=ue(t);e?(n.Ea.delete(2),await Uc(n)):e||(n.Ea.add(2),await pa(n),n.Ra.set("Unknown"))}function ko(t){return t.ma||(t.ma=function(n,r,s){const o=ue(n);return o.sa(),new OI(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(t.datastore,t.asyncQueue,{Xo:UI.bind(null,t),t_:$I.bind(null,t),r_:zI.bind(null,t),H_:GI.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),zf(t)?$f(t):t.Ra.set("Unknown")):(await t.ma.stop(),hw(t))})),t.ma}function Wr(t){return t.fa||(t.fa=function(n,r,s){const o=ue(n);return o.sa(),new LI(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:HI.bind(null,t),r_:XI.bind(null,t),ta:QI.bind(null,t),na:KI.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await $c(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(Is,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(e,n,r,s,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new Kn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,o){const a=Date.now()+r,c=new Gf(e,n,a,s,o);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new J(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qf(t,e){if(tr("AsyncQueue",`${e}: ${t}`),Do(t))return new J(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{static emptySet(e){return new lo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ie.comparator(n.key,r.key):(n,r)=>ie.comparator(n.key,r.key),this.keyedMap=fi(),this.sortedSet=new qe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof lo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=r.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new lo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(){this.ga=new qe(ie.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ae(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class So{constructor(e,n,r,s,o,a,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,o){const a=[];return n.forEach(c=>{a.push({type:0,doc:c})}),new So(e,n,lo.emptySet(n),a,r,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class ZI{constructor(){this.queries=ox(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ue(n),o=s.queries;s.queries=ox(),o.forEach((a,c)=>{for(const u of c.Sa)u.onError(r)})})(this,new J(z.ABORTED,"Firestore shutting down"))}}function ox(){return new bs(t=>Pv(t),Pc)}async function gw(t,e){const n=ue(t);let r=3;const s=e.query;let o=n.queries.get(s);o?!o.ba()&&e.Da()&&(r=2):(o=new JI,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await n.onListen(s,!0);break;case 1:o.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const c=qf(a,`Initialization of query '${Fs(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,o),o.Sa.push(e),e.va(n.onlineState),o.wa&&e.Fa(o.wa)&&Wf(n)}async function xw(t,e){const n=ue(t),r=e.query;let s=3;const o=n.queries.get(r);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?s=e.Da()?0:1:!o.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function eT(t,e){const n=ue(t);let r=!1;for(const s of e){const o=s.query,a=n.queries.get(o);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&Wf(n)}function tT(t,e,n){const r=ue(t),s=r.queries.get(e);if(s)for(const o of s.Sa)o.onError(n);r.queries.delete(e)}function Wf(t){t.Ca.forEach(e=>{e.next()})}var mh,ix;(ix=mh||(mh={})).Ma="default",ix.Cache="cache";class yw{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new So(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=So.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==mh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e){this.key=e}}class ww{constructor(e){this.key=e}}class nT{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ye(),this.mutatedKeys=ye(),this.eu=Ov(e),this.tu=new lo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new sx,s=n?n.tu:this.tu;let o=n?n.mutatedKeys:this.mutatedKeys,a=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((m,f)=>{const p=s.get(m),w=Oc(this.query,f)?f:null,C=!!p&&this.mutatedKeys.has(p.key),R=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let D=!1;p&&w?p.data.isEqual(w.data)?C!==R&&(r.track({type:3,doc:w}),D=!0):this.su(p,w)||(r.track({type:2,doc:w}),D=!0,(u&&this.eu(w,u)>0||d&&this.eu(w,d)<0)&&(c=!0)):!p&&w?(r.track({type:0,doc:w}),D=!0):p&&!w&&(r.track({type:1,doc:p}),D=!0,(u||d)&&(c=!0)),D&&(w?(a=a.add(w),o=R?o.add(m):o.delete(m)):(a=a.delete(m),o=o.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),o=o.delete(m.key),r.track({type:1,doc:m})}return{tu:a,iu:r,Cs:c,mutatedKeys:o}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((m,f)=>function(w,C){const R=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae(20277,{Rt:D})}};return R(w)-R(C)}(m.type,f.type)||this.eu(m.doc,f.doc)),this.ou(r),s=s??!1;const c=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,a.length!==0||d?{snapshot:new So(this.query,e.tu,o,a,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new sx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ye(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new ww(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new vw(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ye();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return So.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Hf="SyncEngine";class rT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class sT{constructor(e){this.key=e,this.hu=!1}}class oT{constructor(e,n,r,s,o,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new bs(c=>Pv(c),Pc),this.Iu=new Map,this.Eu=new Set,this.du=new qe(ie.comparator),this.Au=new Map,this.Ru=new Of,this.Vu={},this.mu=new Map,this.fu=Ao.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function iT(t,e,n=!0){const r=Iw(t);let s;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await _w(r,e,n,!0),s}async function aT(t,e){const n=Iw(t);await _w(n,e,!0,!1)}async function _w(t,e,n,r){const s=await TI(t.localStore,Fn(e)),o=s.targetId,a=t.sharedClientState.addLocalQueryTarget(o,n);let c;return r&&(c=await lT(t,e,o,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&uw(t.remoteStore,s),c}async function lT(t,e,n,r,s){t.pu=(f,p,w)=>async function(R,D,x,v){let I=D.view.ru(x);I.Cs&&(I=await Jg(R.localStore,D.query,!1).then(({documents:S})=>D.view.ru(S,I)));const L=v&&v.targetChanges.get(D.targetId),B=v&&v.targetMismatches.get(D.targetId)!=null,M=D.view.applyChanges(I,R.isPrimaryClient,L,B);return lx(R,D.targetId,M.au),M.snapshot}(t,f,p,w);const o=await Jg(t.localStore,e,!0),a=new nT(e,o.Qs),c=a.ru(o.documents),u=ma.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=a.applyChanges(c,t.isPrimaryClient,u);lx(t,n,d.au);const m=new rT(e,n,a);return t.Tu.set(e,m),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function cT(t,e,n){const r=ue(t),s=r.Tu.get(e),o=r.Iu.get(s.targetId);if(o.length>1)return r.Iu.set(s.targetId,o.filter(a=>!Pc(a,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await hh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Bf(r.remoteStore,s.targetId),ph(r,s.targetId)}).catch(Ro)):(ph(r,s.targetId),await hh(r.localStore,s.targetId,!0))}async function uT(t,e){const n=ue(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Bf(n.remoteStore,r.targetId))}async function dT(t,e,n){const r=yT(t);try{const s=await function(a,c){const u=ue(a),d=Oe.now(),m=c.reduce((w,C)=>w.add(C.key),ye());let f,p;return u.persistence.runTransaction("Locally write mutations","readwrite",w=>{let C=nr(),R=ye();return u.Ns.getEntries(w,m).next(D=>{C=D,C.forEach((x,v)=>{v.isValidDocument()||(R=R.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(w,C)).next(D=>{f=D;const x=[];for(const v of c){const I=jN(v,f.get(v.key).overlayedDocument);I!=null&&x.push(new Zr(v.key,I,Iv(I.value.mapValue),ft.exists(!0)))}return u.mutationQueue.addMutationBatch(w,d,x,c)}).next(D=>{p=D;const x=D.applyToLocalDocumentSet(f,R);return u.documentOverlayCache.saveOverlays(w,D.batchId,x)})}).then(()=>({batchId:p.batchId,changes:Vv(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,c,u){let d=a.Vu[a.currentUser.toKey()];d||(d=new qe(xe)),d=d.insert(c,u),a.Vu[a.currentUser.toKey()]=d}(r,s.batchId,n),await ga(r,s.changes),await $c(r.remoteStore)}catch(s){const o=qf(s,"Failed to persist write");n.reject(o)}}async function Ew(t,e){const n=ue(t);try{const r=await SI(n.localStore,e);e.targetChanges.forEach((s,o)=>{const a=n.Au.get(o);a&&(Ae(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?Ae(a.hu,14607):s.removedDocuments.size>0&&(Ae(a.hu,42227),a.hu=!1))}),await ga(n,r,e)}catch(r){await Ro(r)}}function ax(t,e,n){const r=ue(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((o,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(a,c){const u=ue(a);u.onlineState=c;let d=!1;u.queries.forEach((m,f)=>{for(const p of f.Sa)p.va(c)&&(d=!0)}),d&&Wf(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function hT(t,e,n){const r=ue(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),o=s&&s.key;if(o){let a=new qe(ie.comparator);a=a.insert(o,wt.newNoDocument(o,ce.min()));const c=ye().add(o),u=new Fc(ce.min(),new Map,new qe(xe),a,c);await Ew(r,u),r.du=r.du.remove(o),r.Au.delete(e),Qf(r)}else await hh(r.localStore,e,!1).then(()=>ph(r,e,n)).catch(Ro)}async function fT(t,e){const n=ue(t),r=e.batch.batchId;try{const s=await AI(n.localStore,e);Sw(n,r,null),Aw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ga(n,s)}catch(s){await Ro(s)}}async function mT(t,e,n){const r=ue(t);try{const s=await function(a,c){const u=ue(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return u.mutationQueue.lookupMutationBatch(d,c).next(f=>(Ae(f!==null,37113),m=f.keys(),u.mutationQueue.removeMutationBatch(d,f))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,m,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>u.localDocuments.getDocuments(d,m))})}(r.localStore,e);Sw(r,e,n),Aw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ga(r,s)}catch(s){await Ro(s)}}function Aw(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Sw(t,e,n){const r=ue(t);let s=r.Vu[r.currentUser.toKey()];if(s){const o=s.get(e);o&&(n?o.reject(n):o.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function ph(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||Nw(t,r)})}function Nw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Bf(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Qf(t))}function lx(t,e,n){for(const r of n)r instanceof vw?(t.Ru.addReference(r.key,e),pT(t,r)):r instanceof ww?(ee(Hf,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||Nw(t,r.key)):ae(19791,{wu:r})}function pT(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(Hf,"New document in limbo: "+n),t.Eu.add(r),Qf(t))}function Qf(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ie(Te.fromString(e)),r=t.fu.next();t.Au.set(r,new sT(n)),t.du=t.du.insert(n,r),uw(t.remoteStore,new Sr(Fn(bf(n.path)),r,"TargetPurposeLimboResolution",Dc.ce))}}async function ga(t,e,n){const r=ue(t),s=[],o=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((c,u)=>{a.push(r.pu(u,e,n).then(d=>{var m;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(m=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:m.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(d){s.push(d);const f=Vf.As(u.targetId,d);o.push(f)}}))}),await Promise.all(a),r.Pu.H_(s),await async function(u,d){const m=ue(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>q.forEach(d,p=>q.forEach(p.Es,w=>m.persistence.referenceDelegate.addReference(f,p.targetId,w)).next(()=>q.forEach(p.ds,w=>m.persistence.referenceDelegate.removeReference(f,p.targetId,w)))))}catch(f){if(!Do(f))throw f;ee(Mf,"Failed to update sequence numbers: "+f)}for(const f of d){const p=f.targetId;if(!f.fromCache){const w=m.Ms.get(p),C=w.snapshotVersion,R=w.withLastLimboFreeSnapshotVersion(C);m.Ms=m.Ms.insert(p,R)}}}(r.localStore,o))}async function gT(t,e){const n=ue(t);if(!n.currentUser.isEqual(e)){ee(Hf,"User change. New user:",e.toKey());const r=await aw(n.localStore,e);n.currentUser=e,function(o,a){o.mu.forEach(c=>{c.forEach(u=>{u.reject(new J(z.CANCELLED,a))})}),o.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ga(n,r.Ls)}}function xT(t,e){const n=ue(t),r=n.Au.get(e);if(r&&r.hu)return ye().add(r.key);{let s=ye();const o=n.Iu.get(e);if(!o)return s;for(const a of o){const c=n.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function Iw(t){const e=ue(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ew.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hT.bind(null,e),e.Pu.H_=eT.bind(null,e.eventManager),e.Pu.yu=tT.bind(null,e.eventManager),e}function yT(t){const e=ue(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mT.bind(null,e),e}class cc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return EI(this.persistence,new vI,e.initialUser,this.serializer)}Cu(e){return new iw(Lf.mi,this.serializer)}Du(e){return new CI}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cc.provider={build:()=>new cc};class vT extends cc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Ae(this.persistence.referenceDelegate instanceof ac,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new sI(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?qt.withCacheSize(this.cacheSizeBytes):qt.DEFAULT;return new iw(r=>ac.mi(r,n),this.serializer)}}class gh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ax(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=gT.bind(null,this.syncEngine),await YI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ZI}()}createDatastore(e){const n=Bc(e.databaseInfo.databaseId),r=function(o){return new PI(o)}(e.databaseInfo);return function(o,a,c,u){return new MI(o,a,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,o,a,c){return new BI(r,s,o,a,c)}(this.localStore,this.datastore,e.asyncQueue,n=>ax(this.syncEngine,n,0),function(){return tx.v()?new tx:new bI}())}createSyncEngine(e,n){return function(s,o,a,c,u,d,m){const f=new oT(s,o,a,c,u,d);return m&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const o=ue(s);ee(Is,"RemoteStore shutting down."),o.Ea.add(5),await pa(o),o.Aa.shutdown(),o.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}gh.provider={build:()=>new gh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):tr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new J(z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,o){const a=ue(s),c={documents:o.map(f=>ic(a.serializer,f))},u=await a.Ho("BatchGetDocuments",a.serializer.databaseId,Te.emptyPath(),c,o.length),d=new Map;u.forEach(f=>{const p=UN(a.serializer,f);d.set(p.key.toString(),p)});const m=[];return o.forEach(f=>{const p=d.get(f.toString());Ae(!!p,55234,{key:f}),m.push(p)}),m}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Mc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=ie.fromPath(r);this.mutations.push(new Wv(s,this.precondition(s)))}),await async function(r,s){const o=ue(r),a={writes:s.map(c=>tw(o.serializer,c))};await o.Go("Commit",o.serializer.databaseId,Te.emptyPath(),a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw ae(50498,{Gu:e.constructor.name});n=ce.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new J(z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ce.min())?ft.exists(!1):ft.updateTime(n):ft.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ce.min()))throw new J(z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ft.updateTime(n)}return ft.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(e,n,r,s,o){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=o,this.zu=r.maxAttempts,this.M_=new Ff(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new wT(this.datastore),n=this.Hu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Yu(s)}))}).catch(r=>{this.Yu(r)})})}Hu(e){try{const n=this.updateFunction(e);return!da(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!Hv(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr="FirestoreClient";class ET{constructor(e,n,r,s,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ot.UNAUTHENTICATED,this.clientId=Sf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async a=>{ee(Hr,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(ee(Hr,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Kn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=qf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Wu(t,e){t.asyncQueue.verifyOperationInProgress(),ee(Hr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await aw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function cx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await AT(t);ee(Hr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>rx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>rx(e.remoteStore,s)),t._onlineComponents=e}async function AT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(Hr,"Using user provided OfflineComponentProvider");try{await Wu(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;vo("Error using user provided cache. Falling back to memory cache: "+n),await Wu(t,new cc)}}else ee(Hr,"Using default OfflineComponentProvider"),await Wu(t,new vT(void 0));return t._offlineComponents}async function Kf(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(Hr,"Using user provided OnlineComponentProvider"),await cx(t,t._uninitializedComponentsProvider._online)):(ee(Hr,"Using default OnlineComponentProvider"),await cx(t,new gh))),t._onlineComponents}function ST(t){return Kf(t).then(e=>e.syncEngine)}function NT(t){return Kf(t).then(e=>e.datastore)}async function xh(t){const e=await Kf(t),n=e.eventManager;return n.onListen=iT.bind(null,e.syncEngine),n.onUnlisten=cT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=aT.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=uT.bind(null,e.syncEngine),n}function IT(t,e,n={}){const r=new Kn;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,u,d){const m=new Tw({next:p=>{m.Nu(),a.enqueueAndForget(()=>xw(o,f)),p.fromCache&&u.source==="server"?d.reject(new J(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),f=new yw(c,m,{includeMetadataChanges:!0,qa:!0});return gw(o,f)}(await xh(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw="firestore.googleapis.com",dx=!0;class hx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new J(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Cw,this.ssl=dx}else this.host=e.host,this.ssl=e.ssl??dx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=ow;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<nI)throw new J(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$S("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jw(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new J(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new J(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new J(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class zc{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new J(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new J(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new DS;switch(r.type){case"firstParty":return new LS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new J(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=ux.get(n);r&&(ee("ComponentProvider","Removing Datastore"),ux.delete(n),r.terminate())}(this),Promise.resolve()}}function TT(t,e,n,r={}){var d;t=sn(t,zc);const s=_f(e),o=t._getSettings(),a={...o,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;s&&(oA(`https://${c}`),cA("Firestore",!0)),o.host!==Cw&&o.host!==c&&vo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...o,host:c,ssl:s,emulatorOptions:r};if(!Kl(u,a)&&(t._setSettings(u),r.mockUserToken)){let m,f;if(typeof r.mockUserToken=="string")m=r.mockUserToken,f=Ot.MOCK_USER;else{m=iA(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new J(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ot(p)}t._authCredentials=new kS(new mv(m,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ds(this.firestore,e,this._query)}}class Xe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xe(this.firestore,e,this._key)}toJSON(){return{type:Xe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(ua(n,Xe._jsonSchema))return new Xe(e,r||null,new ie(Te.fromString(n.referencePath)))}}Xe._jsonSchemaVersion="firestore/documentReference/1.0",Xe._jsonSchema={type:lt("string",Xe._jsonSchemaVersion),referencePath:lt("string")};class Mr extends Ds{constructor(e,n,r){super(e,n,bf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xe(this.firestore,null,new ie(e))}withConverter(e){return new Mr(this.firestore,e,this._path)}}function Ye(t,e,...n){if(t=ln(t),pv("collection","path",e),t instanceof zc){const r=Te.fromString(e,...n);return Ng(r),new Mr(t,null,r)}{if(!(t instanceof Xe||t instanceof Mr))throw new J(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Te.fromString(e,...n));return Ng(r),new Mr(t.firestore,null,r)}}function Pt(t,e,...n){if(t=ln(t),arguments.length===1&&(e=Sf.newId()),pv("doc","path",e),t instanceof zc){const r=Te.fromString(e,...n);return Sg(r),new Xe(t,null,new ie(r))}{if(!(t instanceof Xe||t instanceof Mr))throw new J(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Te.fromString(e,...n));return Sg(r),new Xe(t.firestore,t instanceof Mr?t.converter:null,new ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx="AsyncQueue";class mx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ff(this,"async_queue_retry"),this._c=()=>{const r=qu();r&&ee(fx,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=qu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=qu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Kn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Do(e))throw e;ee(fx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,tr("INTERNAL UNHANDLED ERROR: ",px(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Gf.createAndSchedule(this,e,n,r,o=>this.hc(o));return this.tc.push(s),s}uc(){this.nc&&ae(47125,{Pc:px(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function px(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const o of r)if(o in s&&typeof s[o]=="function")return!0;return!1}(t,["next","error","complete"])}class rr extends zc{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new mx,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mx(e),this._firestoreClient=void 0,await e}}}function jT(t,e){const n=typeof t=="object"?t:vS(),r=typeof t=="string"?t:Zl,s=mS(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const o=rA("firestore");o&&TT(s,...o)}return s}function xa(t){if(t._terminated)throw new J(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||CT(t),t._firestoreClient}function CT(t){var r,s,o;const e=t._freezeSettings(),n=function(c,u,d,m){return new ZS(c,u,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,jw(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new ET(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this._byteString=e}static fromBase64String(e){try{return new en(jt.fromBase64String(e))}catch(n){throw new J(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new en(jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:en._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ua(e,en._jsonSchema))return en.fromBase64String(e.bytes)}}en._jsonSchemaVersion="firestore/bytes/1.0",en._jsonSchema={type:lt("string",en._jsonSchemaVersion),bytes:lt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new J(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new J(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new J(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bn._jsonSchemaVersion}}static fromJSON(e){if(ua(e,Bn._jsonSchema))return new Bn(e.latitude,e.longitude)}}Bn._jsonSchemaVersion="firestore/geoPoint/1.0",Bn._jsonSchema={type:lt("string",Bn._jsonSchemaVersion),latitude:lt("number"),longitude:lt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==s[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Un._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ua(e,Un._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Un(e.vectorValues);throw new J(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Un._jsonSchemaVersion="firestore/vectorValue/1.0",Un._jsonSchema={type:lt("string",Un._jsonSchemaVersion),vectorValues:lt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT=/^__.*__$/;class RT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Zr(e,this.data,this.fieldMask,n,this.fieldTransforms):new fa(e,this.data,n,this.fieldTransforms)}}class bw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Zr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Rw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae(40011,{Ac:t})}}class Yf{constructor(e,n,r,s,o,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Yf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return uc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Rw(this.Ac)&&bT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class DT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Bc(e)}Cc(e,n,r,s=!1){return new Yf({Ac:e,methodName:n,Dc:r,path:Nt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Oo(t){const e=t._freezeSettings(),n=Bc(t._databaseId);return new DT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Gc(t,e,n,r,s,o={}){const a=t.Cc(o.merge||o.mergeFields?2:0,e,n,s);em("Data must be an object, but it was:",a,r);const c=Dw(r,a);let u,d;if(o.merge)u=new nn(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){const m=[];for(const f of o.mergeFields){const p=yh(e,f,n);if(!a.contains(p))throw new J(z.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);Pw(m,p)||m.push(p)}u=new nn(m),d=a.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,d=a.fieldTransforms;return new RT(new Ut(c),u,d)}class qc extends Xf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qc}}function Jf(t,e,n,r){const s=t.Cc(1,e,n);em("Data must be an object, but it was:",s,r);const o=[],a=Ut.empty();Jr(r,(u,d)=>{const m=tm(e,u,n);d=ln(d);const f=s.yc(m);if(d instanceof qc)o.push(m);else{const p=ya(d,f);p!=null&&(o.push(m),a.set(m,p))}});const c=new nn(o);return new bw(a,c,s.fieldTransforms)}function Zf(t,e,n,r,s,o){const a=t.Cc(1,e,n),c=[yh(e,r,n)],u=[s];if(o.length%2!=0)throw new J(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<o.length;p+=2)c.push(yh(e,o[p])),u.push(o[p+1]);const d=[],m=Ut.empty();for(let p=c.length-1;p>=0;--p)if(!Pw(d,c[p])){const w=c[p];let C=u[p];C=ln(C);const R=a.yc(w);if(C instanceof qc)d.push(w);else{const D=ya(C,R);D!=null&&(d.push(w),m.set(w,D))}}const f=new nn(d);return new bw(m,f,a.fieldTransforms)}function kT(t,e,n,r=!1){return ya(n,t.Cc(r?4:3,e))}function ya(t,e){if(kw(t=ln(t)))return em("Unsupported field value:",e,t),Dw(t,e);if(t instanceof Xf)return function(r,s){if(!Rw(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const o=[];let a=0;for(const c of r){let u=ya(c,s.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),a++}return{arrayValue:{values:o}}}(t,e)}return function(r,s){if((r=ln(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return EN(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=Oe.fromDate(r);return{timestampValue:oc(s.serializer,o)}}if(r instanceof Oe){const o=new Oe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:oc(s.serializer,o)}}if(r instanceof Bn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof en)return{bytesValue:Yv(s.serializer,r._byteString)};if(r instanceof Xe){const o=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Pf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Un)return function(a,c){return{mapValue:{fields:{[Sv]:{stringValue:Nv},[ec]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Rf(c.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Rc(r)}`)}(t,e)}function Dw(t,e){const n={};return yv(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jr(t,(r,s)=>{const o=ya(s,e.mc(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function kw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Oe||t instanceof Bn||t instanceof en||t instanceof Xe||t instanceof Xf||t instanceof Un)}function em(t,e,n){if(!kw(n)||!gv(n)){const r=Rc(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function yh(t,e,n){if((e=ln(e))instanceof Po)return e._internalPath;if(typeof e=="string")return tm(t,e);throw uc("Field path arguments must be of type string or ",t,!1,void 0,n)}const PT=new RegExp("[~\\*/\\[\\]]");function tm(t,e,n){if(e.search(PT)>=0)throw uc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Po(...e.split("."))._internalPath}catch{throw uc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function uc(t,e,n,r,s){const o=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(o||a)&&(u+=" (found",o&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new J(z.INVALID_ARGUMENT,c+t+u)}function Pw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,n,r,s,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new OT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(nm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class OT extends dc{data(){return super.data()}}function nm(t,e){return typeof e=="string"?tm(t,e):e instanceof Po?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ow(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new J(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rm{}class LT extends rm{}function vl(t,e,...n){let r=[];e instanceof rm&&r.push(e),r=r.concat(n),function(o){const a=o.filter(u=>u instanceof sm).length,c=o.filter(u=>u instanceof Wc).length;if(a>1||a>0&&c>0)throw new J(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Wc extends LT{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Wc(e,n,r)}_apply(e){const n=this._parse(e);return Lw(e._query,n),new Ds(e.firestore,e.converter,ah(e._query,n))}_parse(e){const n=Oo(e.firestore);return function(o,a,c,u,d,m,f){let p;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new J(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){yx(f,m);const C=[];for(const R of f)C.push(xx(u,o,R));p={arrayValue:{values:C}}}else p=xx(u,o,f)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||yx(f,m),p=kT(c,a,f,m==="in"||m==="not-in");return at.create(d,m,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function wl(t,e,n){const r=e,s=nm("where",t);return Wc._create(s,r,n)}class sm extends rm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new sm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Tn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,o){let a=s;const c=o.getFlattenedFilters();for(const u of c)Lw(a,u),a=ah(a,u)}(e._query,n),new Ds(e.firestore,e.converter,ah(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function xx(t,e,n){if(typeof(n=ln(n))=="string"){if(n==="")throw new J(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kv(e)&&n.indexOf("/")!==-1)throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Te.fromString(n));if(!ie.isDocumentKey(r))throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return kg(t,new ie(r))}if(n instanceof Xe)return kg(t,n._key);throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rc(n)}.`)}function yx(t,e){if(!Array.isArray(t)||t.length===0)throw new J(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Lw(t,e){const n=function(s,o){for(const a of s)for(const c of a.getFlattenedFilters())if(o.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new J(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new J(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Vw{convertValue(e,n="none"){switch(qr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Gr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Jr(e,(s,o)=>{r[s]=this.convertValue(o,n)}),r}convertVectorValue(e){var r,s,o;const n=(o=(s=(r=e.fields)==null?void 0:r[ec].arrayValue)==null?void 0:s.values)==null?void 0:o.map(a=>Je(a.doubleValue));return new Un(n)}convertGeoPoint(e){return new Bn(Je(e.latitude),Je(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=kc(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ea(e));default:return null}}convertTimestamp(e){const n=zr(e);return new Oe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Te.fromString(e);Ae(sw(r),9688,{name:e});const s=new ta(r.get(1),r.get(3)),o=new ie(r.popFirst(5));return s.isEqual(n)||tr(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class VT extends Vw{constructor(e){super(),this.firestore=e}convertBytes(e){return new en(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xe(this.firestore,null,n)}}class eo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fr extends dc{constructor(e,n,r,s,o,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new _l(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(nm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new J(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Fr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Fr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Fr._jsonSchema={type:lt("string",Fr._jsonSchemaVersion),bundleSource:lt("string","DocumentSnapshot"),bundleName:lt("string"),bundle:lt("string")};class _l extends Fr{data(e={}){return super.data(e)}}class ys{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new eo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new _l(this._firestore,this._userDataWriter,r.key,r,new eo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new J(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(c=>{const u=new _l(s._firestore,s._userDataWriter,c.doc.key,c.doc,new eo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{const u=new _l(s._firestore,s._userDataWriter,c.doc.key,c.doc,new eo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,m=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),m=a.indexOf(c.doc.key)),{type:MT(c.type),doc:u,oldIndex:d,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new J(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ys._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(o=>{o._document!==null&&(n.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function MT(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae(61501,{type:t})}}ys._jsonSchemaVersion="firestore/querySnapshot/1.0",ys._jsonSchema={type:lt("string",ys._jsonSchemaVersion),bundleSource:lt("string","QuerySnapshot"),bundleName:lt("string"),bundle:lt("string")};class Qc extends Vw{constructor(e){super(),this.firestore=e}convertBytes(e){return new en(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xe(this.firestore,null,n)}}function vh(t){t=sn(t,Ds);const e=sn(t.firestore,rr),n=xa(e),r=new Qc(e);return Ow(t._query),IT(n,t._query).then(s=>new ys(e,r,t,s))}function FT(t,e,n){t=sn(t,Xe);const r=sn(t.firestore,rr),s=Hc(t.converter,e,n);return Kc(r,[Gc(Oo(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,ft.none())])}function wn(t,e,n,...r){t=sn(t,Xe);const s=sn(t.firestore,rr),o=Oo(s);let a;return a=typeof(e=ln(e))=="string"||e instanceof Po?Zf(o,"updateDoc",t._key,e,n,r):Jf(o,"updateDoc",t._key,e),Kc(s,[a.toMutation(t._key,ft.exists(!0))])}function Ft(t,e){const n=sn(t.firestore,rr),r=Pt(t),s=Hc(t.converter,e);return Kc(n,[Gc(Oo(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,ft.exists(!1))]).then(()=>r)}function BT(t,...e){var u,d,m;t=ln(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||gx(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(gx(e[r])){const f=e[r];e[r]=(u=f.next)==null?void 0:u.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(m=f.complete)==null?void 0:m.bind(f)}let o,a,c;if(t instanceof Xe)a=sn(t.firestore,rr),c=bf(t._key.path),o={next:f=>{e[r]&&e[r](UT(a,t,f))},error:e[r+1],complete:e[r+2]};else{const f=sn(t,Ds);a=sn(f.firestore,rr),c=f._query;const p=new Qc(a);o={next:w=>{e[r]&&e[r](new ys(a,p,f,w))},error:e[r+1],complete:e[r+2]},Ow(t._query)}return function(p,w,C,R){const D=new Tw(R),x=new yw(w,D,C);return p.asyncQueue.enqueueAndForget(async()=>gw(await xh(p),x)),()=>{D.Nu(),p.asyncQueue.enqueueAndForget(async()=>xw(await xh(p),x))}}(xa(a),c,s,o)}function Kc(t,e){return function(r,s){const o=new Kn;return r.asyncQueue.enqueueAndForget(async()=>dT(await ST(r),s,o)),o.promise}(xa(t),e)}function UT(t,e,n){const r=n.docs.get(e._key),s=new Qc(t);return new Fr(t,s,e._key,r,new eo(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $T={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Oo(e)}set(e,n,r){this._verifyNotCommitted();const s=Nr(e,this._firestore),o=Hc(s.converter,n,r),a=Gc(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,r);return this._mutations.push(a.toMutation(s._key,ft.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const o=Nr(e,this._firestore);let a;return a=typeof(n=ln(n))=="string"||n instanceof Po?Zf(this._dataReader,"WriteBatch.update",o._key,n,r,s):Jf(this._dataReader,"WriteBatch.update",o._key,n),this._mutations.push(a.toMutation(o._key,ft.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Nr(e,this._firestore);return this._mutations=this._mutations.concat(new Mc(n._key,ft.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new J(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Nr(t,e){if((t=ln(t)).firestore!==e)throw new J(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Oo(e)}get(e){const n=Nr(e,this._firestore),r=new VT(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return ae(24041);const o=s[0];if(o.isFoundDocument())return new dc(this._firestore,r,o.key,o,n.converter);if(o.isNoDocument())return new dc(this._firestore,r,n._key,null,n.converter);throw ae(18433,{doc:o})})}set(e,n,r){const s=Nr(e,this._firestore),o=Hc(s.converter,n,r),a=Gc(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,r);return this._transaction.set(s._key,a),this}update(e,n,r,...s){const o=Nr(e,this._firestore);let a;return a=typeof(n=ln(n))=="string"||n instanceof Po?Zf(this._dataReader,"Transaction.update",o._key,n,r,s):Jf(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,a),this}delete(e){const n=Nr(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT extends GT{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Nr(e,this._firestore),r=new Qc(this._firestore);return super.get(e).then(s=>new Fr(this._firestore,r,n._key,s._document,new eo(!1,!1),n.converter))}}function WT(t,e,n){t=sn(t,rr);const r={...$T,...n};return function(o){if(o.maxAttempts<1)throw new J(z.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,a,c){const u=new Kn;return o.asyncQueue.enqueueAndForget(async()=>{const d=await NT(o);new _T(o.asyncQueue,d,c,a,u).ju()}),u.promise}(xa(t),s=>e(new qT(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t){return xa(t=sn(t,rr)),new zT(t,e=>Kc(t,e))}(function(e,n=!0){(function(s){bo=s})(yS),Yl(new Yi("firestore",(r,{instanceIdentifier:s,options:o})=>{const a=r.getProvider("app").getImmediate(),c=new rr(new PS(r.getProvider("auth-internal")),new VS(a,r.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new J(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ta(d.options.projectId,m)}(a,s),a);return o={useFetchStreams:n,...o},c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),ao(wg,_g,e),ao(wg,_g,"esm2020")})();const HT={apiKey:"YOUR_API_KEY",authDomain:"YOUR_AUTH_DOMAIN",projectId:"YOUR_PROJECT_ID",storageBucket:"YOUR_STORAGE_BUCKET",messagingSenderId:"YOUR_MESSAGING_SENDER_ID",appId:"YOUR_APP_ID"},QT=sv(HT),me=jT(QT),Mw=N.createContext({}),be=()=>N.useContext(Mw),KT=({children:t})=>{const[e,n]=N.useState(()=>{try{const f=window.localStorage.getItem("currentUser");return f?JSON.parse(f):null}catch(f){return console.error("Falha ao carregar usuário do localStorage",f),null}});N.useEffect(()=>{e?window.localStorage.setItem("currentUser",JSON.stringify(e)):window.localStorage.removeItem("currentUser")},[e]);const r=(e==null?void 0:e.role)??null,s=!!e,o=N.useCallback(async(f,p)=>{const w=(f||"").replace(/\D/g,"");if(w.length<3)return{ok:!1,error:"RE inválido"};if(!p||p.trim().length<3)return{ok:!1,error:"Senha inválida"};try{const C=Ye(me,"users"),R=vl(C,wl("reLogin","==",w)),D=await vh(R);if(D.empty)return{ok:!1,error:"Usuário não encontrado."};const x=D.docs[0],v={id:x.id,...x.data()};return v.senha!==p?{ok:!1,error:"Senha incorreta."}:v.acessoLiberado?(n(v),{ok:!0}):{ok:!1,error:"Acesso não liberado pelo administrador."}}catch(C){return console.error("Erro no login:",C),{ok:!1,error:"Ocorreu um erro ao tentar fazer login."}}},[]),a=N.useCallback(()=>{n(null)},[]),c=N.useCallback(async(f,p,w="SUBORDINADO",C)=>{if(!e||e.role!=="ADMIN")return{ok:!1,error:"Apenas ADMIN pode conceder acesso"};if(w==="ADMIN"&&C!==e.senha)return{ok:!1,error:"Senha de administrador incorreta para confirmar a operação."};try{const R=(f.re||"").split("-")[0].replace(/\D/g,""),D=Pt(me,"users",f.id),x={policialId:f.id,nome:f.nome,reLogin:R,role:w,acessoLiberado:!0,senha:p,ativo:!0,atualizadoEm:new Date().toISOString(),pelotao:f.pelotao,postoGrad:f.postoGrad};return await FT(D,x,{merge:!0}),{ok:!0}}catch(R){return console.error("Erro ao conceder acesso:",R),{ok:!1,error:"Falha ao salvar dados no Firestore."}}},[e]),u=N.useCallback(async(f,p)=>{if(!e||e.role!=="ADMIN")return{ok:!1,error:"Apenas ADMIN pode resetar senha"};try{const w=Pt(me,"users",f);return await wn(w,{senha:p,acessoLiberado:!0,atualizadoEm:new Date().toISOString()}),{ok:!0}}catch(w){return console.error("Erro ao resetar senha:",w),{ok:!1,error:"Falha ao atualizar senha no Firestore."}}},[e]),d=N.useCallback(async f=>{if(!e||e.role!=="ADMIN")return{ok:!1,error:"Apenas ADMIN pode revogar acesso"};try{const p=Pt(me,"users",f);return await wn(p,{acessoLiberado:!1,atualizadoEm:new Date().toISOString()}),{ok:!0}}catch(p){return console.error("Erro ao revogar acesso:",p),{ok:!1,error:"Falha ao revogar acesso no Firestore."}}},[e]),m=N.useMemo(()=>({isAuthenticated:s,currentUser:e,role:r,loginByRE:o,logout:a,grantAccess:c,resetPassword:u,revokeAccess:d}),[s,e,r,o,a,c,u,d]);return i.jsx(Mw.Provider,{value:m,children:t})};var le=(t=>(t.RASCUNHO="RASCUNHO",t.ENVIADA_SARGENTO="ENVIADA_SARGENTO",t.APROVADA_SARGENTO="APROVADA_SARGENTO",t.NEGADA_SARGENTO="NEGADA_SARGENTO",t.VALIDADA_ADMIN="VALIDADA_ADMIN",t.REPROVADA_ADMIN="REPROVADA_ADMIN",t))(le||{}),we=(t=>(t.ATIVA="ATIVA",t.TROCADA="TROCADA",t.EXCLUIDA="EXCLUIDA",t.CANCELADA="CANCELADA",t))(we||{}),Ve=(t=>(t.CREATE_FOLGA="CREATE_FOLGA",t.ACIONAR_FOLGA="ACIONAR_FOLGA",t.ENVIAR_SARGENTO="ENVIAR_SARGENTO",t.APROVAR_SARGENTO="APROVAR_SARGENTO",t.NEGAR_SARGENTO="NEGAR_Sargento",t.VALIDAR_ADMIN="VALIDAR_ADMIN",t.REPROVAR_ADMIN="REPROVAR_ADMIN",t.TROCA_FOLGA="TROCA_FOLGA",t.EXCLUIR_FOLGA="EXCLUIR_FOLGA",t.RESTAURAR_FOLGA="RESTAURAR_FOLGA",t.CREATE_POLICIAL="CREATE_POLICIAL",t.UPDATE_POLICIAL="UPDATE_POLICIAL",t.DELETE_POLICIAL="DELETE_POLICIAL",t.CREATE_USER="CREATE_USER",t.UPDATE_USER="UPDATE_USER",t.BULK_UPSERT_POLICIAIS="BULK_UPSERT_POLICIAIS",t.CREATE_FERIAS="CREATE_FERIAS",t.UPDATE_FERIAS="UPDATE_FERIAS",t.CREATE_AGENDA_EVENTO="CREATE_AGENDA_EVENTO",t.UPDATE_AGENDA_EVENTO="UPDATE_AGENDA_EVENTO",t.DELETE_AGENDA_EVENTO="DELETE_AGENDA_EVENTO",t.CREATE_GRUPO="CREATE_GRUPO",t.UPDATE_GRUPO="UPDATE_GRUPO",t.DELETE_GRUPO="DELETE_GRUPO",t.CREATE_PROTOCOLO="CREATE_PROTOCOLO",t.RESET_PROTOCOLO_COUNTER="RESET_PROTOCOLO_COUNTER",t))(Ve||{}),Ze=(t=>(t.AGENDADA="AGENDADA",t.CONCLUIDA="CONCLUIDA",t.CANCELADA="CANCELADA",t.SOLICITANDO_ALTERACAO="SOLICITANDO_ALTERACAO",t))(Ze||{}),ve=(t=>(t.CURSO="CURSO",t.EAP="EAP",t.OPERACAO="OPERACAO",t.LICENCA_PREMIO="LICENCA_PREMIO",t.OUTRO="OUTRO",t))(ve||{}),st=(t=>(t.OFICIO="OFÍCIO",t.PARTE="PARTE",t.MEMORANDO="MEMORANDO",t.AESTORIGEM="AESTORIGEM",t.ATESTADO="ATESTADO",t.CERTIDAO="CERTIDÃO",t.DECLARACAO="DECLARAÇÃO",t.DESPACHO="DESPACHO",t.INFORMACAO="INFORMAÇÃO",t.ORDEM_SERVICO="ORDEM SERVIÇO",t.RELATORIO="RELATÓRIO",t.PTAC="PTAC",t.GUIA="GUIA",t.NOTA_SERVICO="NOTA SERVIÇO",t.EMAIL="E-MAIL",t.RAIA="RAIA",t.FMM="FMM",t.INVPRELIMINAR="INVPRELIMINAR",t))(st||{});const Fw=["Sd 2ª Cl","Sd 1ª Cl","Cb","3º Sgt","2º Sgt","1º Sgt","Subten","2º Ten","1º Ten","Cap","Maj"];we.ATIVA+"",we.TROCADA+"",we.EXCLUIDA+"",we.CANCELADA+"";const vx={[le.RASCUNHO]:"bg-gray-200 text-gray-800",[le.ENVIADA_SARGENTO]:"bg-blue-100 text-blue-800",[le.APROVADA_SARGENTO]:"bg-cyan-100 text-cyan-800",[le.NEGADA_SARGENTO]:"bg-orange-100 text-orange-800",[le.VALIDADA_ADMIN]:"bg-green-100 text-green-800",[le.REPROVADA_ADMIN]:"bg-red-100 text-red-800"},Qu={[le.RASCUNHO]:"Rascunho",[le.ENVIADA_SARGENTO]:"Pendente Sgt.",[le.APROVADA_SARGENTO]:"Aprovada Sgt.",[le.NEGADA_SARGENTO]:"Negada Sgt.",[le.VALIDADA_ADMIN]:"Validada Adm.",[le.REPROVADA_ADMIN]:"Reprovada Adm."},XT=[{value:we.ATIVA,label:"Ativa"},{value:we.TROCADA,label:"Trocada"},{value:we.EXCLUIDA,label:"Excluída"}],YT={[Ze.AGENDADA]:"bg-green-100 text-green-800",[Ze.CONCLUIDA]:"bg-blue-100 text-blue-800",[Ze.CANCELADA]:"bg-red-100 text-red-800",[Ze.SOLICITANDO_ALTERACAO]:"bg-yellow-100 text-yellow-800"},Ku={[Ze.AGENDADA]:"Agendada",[Ze.CONCLUIDA]:"Concluída",[Ze.CANCELADA]:"Cancelada",[Ze.SOLICITANDO_ALTERACAO]:"Solicitando Alteração"},vs={[ve.CURSO]:"Curso",[ve.EAP]:"EAP",[ve.OPERACAO]:"Operação",[ve.LICENCA_PREMIO]:"Licença Prêmio",[ve.OUTRO]:"Outro"},bi={[ve.CURSO]:"bg-indigo-100 text-indigo-800",[ve.EAP]:"bg-purple-100 text-purple-800",[ve.OPERACAO]:"bg-red-100 text-red-800",[ve.LICENCA_PREMIO]:"bg-teal-100 text-teal-800",[ve.OUTRO]:"bg-gray-200 text-gray-800"},Bw="200",wx=[st.OFICIO,st.PARTE,st.MEMORANDO,st.AESTORIGEM,st.ATESTADO,st.CERTIDAO,st.DECLARACAO,st.DESPACHO,st.INFORMACAO,st.ORDEM_SERVICO,st.RELATORIO,st.PTAC,st.GUIA,st.NOTA_SERVICO,st.EMAIL,st.RAIA,st.FMM,st.INVPRELIMINAR],Uw=N.createContext(void 0),Fe=()=>{const t=N.useContext(Uw);if(t===void 0)throw new Error("useData must be used within a DataProvider");return t},ls=(t,e,n)=>({evento:t,actorId:e.id,actorNome:e.nome,timestamp:new Date().toISOString(),pelotao:e.pelotao||"N/A",dataOriginal:null,dataNova:null,motivo:null,antesDepois:null,...n}),JT=({children:t})=>{const[e,n]=N.useState(!0),[r,s]=N.useState({policiais:[],folgas:[],historico:[],users:[],leaveLedger:[],ferias:[],agendaEventos:[],notificacoes:[],comentarios:[],grupos:[],protocoloDocs:[]});N.useEffect(()=>{const O=["policiais","folgas","historico","users","leaveLedger","ferias","agendaEventos","notificacoes","comentarios","grupos","protocoloDocs"].map(k=>{const G=vl(Ye(me,k));return BT(G,W=>{const Z=W.docs.map(ne=>{const oe=ne.data();return Object.keys(oe).forEach(re=>{var Re;(Re=oe[re])!=null&&Re.toDate&&(oe[re]=oe[re].toDate().toISOString())}),k==="folgas"?{...oe,folgald:ne.id}:{...oe,id:ne.id}});s(ne=>({...ne,[k]:Z})),n(!1)},W=>{console.error(`Error fetching ${k}:`,W),n(!1)})});return()=>O.forEach(k=>k())},[]);const o=N.useCallback(async F=>{if(!F||F.length===0)return;const O=Hu(me);if(F.forEach(W=>{const Z=Pt(Ye(me,"notificacoes"));O.set(Z,W)}),await O.commit(),!("Notification"in window)||!("serviceWorker"in navigator)||await Notification.requestPermission()!=="granted")return;const G=await navigator.serviceWorker.getRegistration();G&&F.forEach((W,Z)=>{G.showNotification("Atualização SIGMA-E",{body:W.mensagem,icon:"/vite.svg",data:{url:W.link||"/dashboard"},tag:`sigma-notif-${Date.now()+Z}`})})},[]),a=F=>Number(F.slice(0,4)),c=F=>F.aprovacao===le.VALIDADA_ADMIN&&F.status===we.ATIVA?F.motivo==="Folga Cmt Geral":!1,u=N.useCallback((F,O)=>r.leaveLedger.filter(k=>k.policialId===F&&k.year===O).reduce((k,G)=>k+G.delta,0),[r.leaveLedger]),d=N.useCallback((F,O)=>r.folgas.filter(k=>k.policialld===F&&a(k.data)===O&&c(k)).length,[r.folgas]),m=N.useCallback((F,O)=>u(F,O)-d(F,O),[u,d]),f=N.useCallback(F=>{const O=a(F.dateISO),k=m(F.policialId,O);return k>0?{ok:!0,balance:k}:F.allowOverride?{ok:!0,balance:k,warn:"Sem saldo, mas a criação foi permitida pelo perfil do usuário."}:{ok:!1,error:`Sem saldo de folgas para o ano de ${O}.`,balance:k}},[m]),p=N.useCallback(async(F,O)=>{var Re;const k=r.policiais.find(pe=>pe.id===F.policialld);if(!k)throw new Error("Policial não encontrado.");const{role:G}=O;let W,Z;G==="SUBORDINADO"?(W=le.ENVIADA_SARGENTO,Z=(Re=r.users.find(pe=>pe.role==="SARGENTO"&&pe.pelotao===k.pelotao&&pe.ativo))==null?void 0:Re.id):G==="SARGENTO"?W=le.APROVADA_SARGENTO:W=le.VALIDADA_ADMIN;const ne={policialld:k.id,nome:k.nome,re:k.re,pelotao:k.pelotao,data:F.data,motivo:F.motivo,status:we.ATIVA,aprovacao:W,criadaPorld:O.id,atualizadoEm:new Date().toISOString(),trocadaPara:null,sargentoResponsavelld:Z,criadoEm:new Date().toISOString()},oe=await Ft(Ye(me,"folgas"),ne);await Ft(Ye(me,"historico"),ls(Ve.ACIONAR_FOLGA,O,{folgald:oe.id,policialld:k.id,nome:k.nome,re:k.re,motivo:`Acionada: ${F.motivo}`,antesDepois:{depois:ne}}));const re=r.users.find(pe=>pe.id===Z);re&&await o([{policialId:re.id,mensagem:`${k.postoGrad} ${k.nome} solicitou uma folga.`,lida:!1,link:`/folgas?aprovacao=${le.ENVIADA_SARGENTO}`,criadoEm:new Date().toISOString()}])},[r.policiais,r.users,o]),w=N.useCallback(async(F,O,k)=>{const G=Pt(me,"folgas",F);await wn(G,{...O,atualizadoEm:new Date().toISOString(),atualizadoPorld:k.id});const W={...r.folgas.find(re=>re.folgald===F),...O},Z=[],ne=r.users.find(re=>re.policialId===W.policialld),oe=r.users.find(re=>re.role==="SARGENTO"&&re.pelotao===W.pelotao&&re.ativo);O.aprovacao&&ne&&Z.push({policialId:ne.id,mensagem:`Sua folga teve o status alterado para ${W.aprovacao}`,lida:!1,link:"/folgas",criadoEm:new Date().toISOString()}),O.aprovacao===le.APROVADA_SARGENTO&&r.users.filter(re=>re.role==="ADMIN").forEach(re=>Z.push({policialId:re.id,mensagem:`Folga de ${W.nome} aguardando sua validação.`,lida:!1,link:`/folgas?aprovacao=${le.APROVADA_SARGENTO}`,criadoEm:new Date().toISOString()})),O.aprovacao===le.VALIDADA_ADMIN&&oe&&Z.push({policialId:oe.id,mensagem:`Folga de ${W.nome} foi validada.`,lida:!1,link:"/folgas",criadoEm:new Date().toISOString()}),Z.length>0&&await o(Z)},[r.folgas,r.users,o]),C=N.useCallback(async(F,O)=>{const k=await Ft(Ye(me,"policiais"),F);await Ft(Ye(me,"historico"),ls(Ve.CREATE_POLICIAL,O,{policialld:k.id,antesDepois:{depois:F}}))},[]),R=N.useCallback(async(F,O)=>{const{id:k,...G}=F;await wn(Pt(me,"policiais",k),G),await Ft(Ye(me,"historico"),ls(Ve.UPDATE_POLICIAL,O,{policialld:k}))},[]),D=N.useCallback(async(F,O)=>{await wn(Pt(me,"policiais",F),{ativo:!1}),await Ft(Ye(me,"historico"),ls(Ve.DELETE_POLICIAL,O,{policialld:F}))},[]),x=N.useCallback(async(F,O)=>{const k=Hu(me);for(const G of F){const W=vl(Ye(me,"policiais"),wl("re","==",G.re)),Z=await vh(W);if(Z.empty){const ne=Pt(Ye(me,"policiais"));k.set(ne,G)}else k.update(Z.docs[0].ref,G)}await k.commit(),await Ft(Ye(me,"historico"),ls(Ve.BULK_UPSERT_POLICIAIS,O,{motivo:`Importados/Atualizados: ${F.length}`}))},[]),v=N.useCallback(async(F,O)=>{const k={...F,createdAt:new Date().toISOString(),createdById:O.id,createdByNome:O.nome};await Ft(Ye(me,"leaveLedger"),k)},[]),I=N.useCallback(async(F,O)=>{const k={...F,criadoPorId:O.id,criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString()};await Ft(Ye(me,"ferias"),k),await Ft(Ye(me,"historico"),ls(Ve.CREATE_FERIAS,O,{policialld:k.policialId,antesDepois:{depois:k}}))},[]),L=N.useCallback(async(F,O,k)=>{await wn(Pt(me,"ferias",F),{...O,atualizadoPorId:k.id,atualizadoEm:new Date().toISOString()})},[]),B=N.useCallback(async(F,O)=>{const k={...F,criadoPorId:O.id,criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString()},G=await Ft(Ye(me,"agendaEventos"),k),W={...k,id:G.id},Z=new Map(r.users.map(oe=>[oe.policialId,oe])),ne=W.policiaisIds.map(oe=>{const re=Z.get(oe);return re?{policialId:re.id,mensagem:`Você foi escalado para: "${W.titulo}" em ${new Date(W.data+"T12:00:00").toLocaleDateString()}.`,lida:!1,link:"/calendario",criadoEm:new Date().toISOString()}:null}).filter(oe=>oe!==null);return await o(ne),W},[o,r.users]),M=N.useCallback(async(F,O,k)=>{const G=r.agendaEventos.find(re=>re.id===F),W={...O,atualizadoPorId:k.id,atualizadoEm:new Date().toISOString()};await wn(Pt(me,"agendaEventos",F),W);const Z={...G,...W},ne=new Set(G.policiaisIds),oe=(Z.policiaisIds||[]).filter(re=>!ne.has(re));if(oe.length>0){const re=new Map(r.users.map(pe=>[pe.policialId,pe])),Re=oe.map(pe=>{const tt=re.get(pe);return tt?{policialId:tt.id,mensagem:`Você foi escalado para: "${Z.titulo}" em ${new Date(Z.data+"T12:00:00").toLocaleDateString()}.`,lida:!1,link:"/calendario",criadoEm:new Date().toISOString()}:null}).filter(pe=>pe!==null);await o(Re)}return Z},[o,r.agendaEventos,r.users]),S=N.useCallback(async(F,O)=>{await wn(Pt(me,"agendaEventos",F),{policiaisIds:[]})},[]),_=N.useCallback(async F=>{const O=vl(Ye(me,"notificacoes"),wl("policialId","==",F),wl("lida","==",!1)),k=await vh(O),G=Hu(me);k.docs.forEach(W=>G.update(W.ref,{lida:!0})),await G.commit()},[]),y=N.useCallback(async(F,O,k)=>{if(!O.trim())return;const G=r.folgas.find(re=>re.folgald===F);if(!G)return;await Ft(Ye(me,"comentarios"),{folgald:F,mensagem:O,actorId:k.id,actorNome:k.nome,actorPostoGrad:k.postoGrad,timestamp:new Date().toISOString()});const W=r.users.find(re=>re.role==="SARGENTO"&&re.pelotao===G.pelotao&&re.ativo),Z=r.users.find(re=>re.policialId===G.policialld);let ne,oe="";k.role==="SUBORDINADO"&&W?(ne=W,oe=`${k.nome} comentou na folga de ${G.nome}.`):k.role==="SARGENTO"&&Z&&(ne=Z,oe="Seu sargento comentou em sua folga."),ne&&await o([{policialId:ne.id,mensagem:oe,lida:!1,link:"/folgas",criadoEm:new Date().toISOString()}])},[r.folgas,r.users,o]),j=N.useCallback(async(F,O)=>{await Ft(Ye(me,"grupos"),{nome:F})},[]),b=N.useCallback(async(F,O)=>{const{id:k,...G}=F;await wn(Pt(me,"grupos",k),G)},[]),T=N.useCallback(async(F,O)=>{if(r.policiais.some(G=>{var W;return G.pelotao===((W=r.grupos.find(Z=>Z.id===F))==null?void 0:W.nome)}))throw new Error("Não é possível excluir um grupo que está em uso por policiais.");await wn(Pt(me,"grupos",F),{nome:`_DELETADO_${Date.now()}`})},[r.policiais,r.grupos]),E=N.useCallback(async(F,O)=>{const k=new Date(F.dataEmissao+"T12:00:00").getFullYear(),G=String(k).slice(-2),W=Pt(me,"metadata",`protocolo_${k}`);let Z=1;await WT(me,async Re=>{const pe=await Re.get(W);pe.exists()&&(Z=pe.data().valor+1),Re.set(W,{valor:Z},{merge:!0})});const ne=`${String(Z).padStart(3,"0")}/${Bw}/${G}`,oe={...F,numero:ne,ano:k,sequencial:Z,criadoEm:new Date().toISOString()},re=await Ft(Ye(me,"protocoloDocs"),oe);return await Ft(Ye(me,"historico"),ls(Ve.CREATE_PROTOCOLO,O,{motivo:`Protocolado doc nº ${ne}`,antesDepois:{depois:oe}})),{...oe,id:re.id}},[]),Q=N.useCallback(async F=>{const O=new Date().getFullYear(),k=Pt(me,"metadata",`protocolo_${O}`);await wn(k,{valor:0})},[]),P={...r,loading:e,addFolga:p,updateFolga:w,addPolicial:C,updatePolicial:R,deletePolicial:D,bulkUpsertPoliciais:x,adminAddLeaveCredits:v,getBalanceFor:m,getCreditsFor:u,countUsedFolgasFor:d,canRequestFolga:f,addFerias:I,updateFerias:L,addAgendaEvento:B,updateAgendaEvento:M,deleteAgendaEvento:S,markNotificacoesAsRead:_,addComentario:y,addGrupo:j,updateGrupo:b,deleteGrupo:T,addProtocoloDoc:E,adminResetProtocoloCounter:Q};return i.jsx(Uw.Provider,{value:P,children:t})};function _x(t){return(t||"").replace(/\D/g,"")}const ZT=({className:t})=>i.jsx("div",{className:`flex items-center justify-center ${t}`,children:i.jsx("svg",{viewBox:"0 0 80 88",className:"h-20 w-auto",children:i.jsxs("g",{children:[i.jsx("path",{d:"M40 0 L80 16 V56 C80 78 40 88 40 88 C40 88 0 78 0 56 V16 Z",fill:"#19398A"}),i.jsx("path",{d:"M40 4 L76 18.4 V54.8 C76 74.8 40 84 40 84 C40 84 4 74.8 4 54.8 V18.4 Z",strokeWidth:"3",stroke:"white",fill:"none"}),i.jsx("text",{x:"32",y:"62",fontFamily:"Verdana, sans-serif",fontSize:"42",fontWeight:"bold",fill:"white",textAnchor:"middle",children:"Σ"}),i.jsx("text",{x:"55",y:"48",fontFamily:"Verdana, sans-serif",fontSize:"22",fontWeight:"bold",fill:"white",children:"E"})]})})}),ej=()=>{const t=Yr(),{loginByRE:e}=be(),[n,r]=N.useState(""),[s,o]=N.useState(""),[a,c]=N.useState(null),[u,d]=N.useState(null),[m,f]=N.useState(!1),p=C=>{const R=C.target.value;/\D/.test(R)?d("O RE deve conter apenas números."):d(null),r(_x(R))},w=async C=>{if(C.preventDefault(),c(null),u)return;const R=_x(n);if(R.length<3){c("Informe seu RE sem o dígito");return}if(!s||s.trim().length<3){c("Informe uma senha válida");return}f(!0);const{ok:D,error:x}=await e(R,s);if(f(!1),!D){c(x||"Falha no login");return}t("/dashboard")};return i.jsx("div",{className:"min-h-screen bg-pm-gray-50 flex items-center justify-center p-6",children:i.jsxs("div",{className:"w-full max-w-md bg-white shadow rounded-xl p-6",children:[i.jsxs("div",{className:"flex flex-col items-center mb-6",children:[i.jsx(ZT,{}),i.jsx("h1",{className:"text-3xl font-bold text-pm-blue mt-4",children:"SIGMA-E"}),i.jsx("p",{className:"text-pm-gray-600 text-center text-base -mt-1",children:"Sistema Integrado de Gestão, Monitoramento e Administração do Efetivo"})]}),i.jsx("p",{className:"text-pm-gray-500 mb-6 text-center",children:"Acesse com seu RE (sem dígito) e senha."}),a&&i.jsx("div",{className:"mb-4 text-sm text-red-700 bg-red-50 border border-red-200 rounded p-2 text-center",children:a}),i.jsxs("form",{onSubmit:w,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-pm-gray-700 mb-1 text-left",children:"RE (sem dígito)"}),i.jsx("input",{inputMode:"numeric",pattern:"[0-9]*",autoComplete:"username",className:`w-full border ${u?"border-red-500 focus:ring-red-500":"border-pm-gray-300 focus:ring-pm-blue"} rounded-lg px-3 py-2 focus:outline-none focus:ring-2`,placeholder:"Ex.: 123456",value:n,onChange:p,"aria-invalid":!!u,"aria-describedby":"re-error-message"}),u?i.jsx("p",{id:"re-error-message",className:"text-xs text-red-600 mt-1 text-left",children:u}):i.jsx("p",{className:"text-xs text-pm-gray-500 mt-1 text-left",children:"Digite apenas os números antes do traço. Ex.: se seu RE é 123456-7, digite 123456."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-pm-gray-700 mb-1 text-left",children:"Senha"}),i.jsx("input",{type:"password",autoComplete:"current-password",className:"w-full border border-pm-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pm-blue",placeholder:"Sua senha",value:s,onChange:C=>o(C.target.value)})]}),i.jsx("button",{type:"submit",disabled:m,className:"w-full bg-pm-blue hover:bg-pm-blue-dark text-white rounded-lg py-2 font-semibold transition disabled:opacity-50",children:m?"Entrando...":"Entrar"})]}),i.jsx("div",{className:"mt-6 text-xs text-center text-pm-gray-500",children:"Acesso ao sistema é concedido pelo Administrador na área interna (Gerenciar Policiais)."}),i.jsx("div",{className:"mt-8 border-t pt-4 text-center text-xs text-pm-gray-400",children:"Desenvolvido por Cb PM 143468-3 Samuel Henrique Alves"})]})})},kn=({title:t,value:e,icon:n,color:r,onClick:s})=>{const o=i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`p-4 rounded-full ${r} mr-4`,children:n}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-pm-gray-500 font-medium",children:t}),i.jsx("p",{className:"text-3xl font-bold text-pm-gray-800",children:e})]})]});return s?i.jsx("button",{onClick:s,className:"bg-white p-6 rounded-lg shadow-md flex items-center w-full text-left transition-transform transform hover:scale-105 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-pm-blue focus:ring-offset-2","aria-label":`${t}: ${e}`,children:o}):i.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md flex items-center",children:o})},tj=t=>{const{folgas:e}=Fe(),{currentUser:n,role:r}=be();return N.useMemo(()=>e.filter(s=>r==="SUBORDINADO"?s.policialld===(n==null?void 0:n.policialId):r==="SARGENTO"?(n==null?void 0:n.pelotao)==="TODOS"?!0:s.pelotao===(n==null?void 0:n.pelotao)||s.sargentoResponsavelld===(n==null?void 0:n.id):!0).filter(s=>{const o=t.nomeRe.toLowerCase(),a=!t.nomeRe||s.nome.toLowerCase().includes(o)||s.re.toLowerCase().includes(o),c=!t.pelotao||s.pelotao===t.pelotao,u=!t.aprovacao||s.aprovacao===t.aprovacao,d=!t.status||s.status===t.status;return a&&c&&u&&d}).sort((s,o)=>new Date(o.criadoEm).getTime()-new Date(s.criadoEm).getTime()),[e,t,r,n])},nj=t=>{const{folgas:e,policiais:n}=Fe(),{currentUser:r,role:s}=be(),o=N.useMemo(()=>e.filter(d=>s==="SUBORDINADO"?d.policialld===(r==null?void 0:r.policialId):s==="SARGENTO"&&(r==null?void 0:r.pelotao)!=="TODOS"?d.pelotao===(r==null?void 0:r.pelotao):!0).filter(d=>{const m=n.find(R=>R.id===d.policialld),f=d.data.substring(0,7),p=!t.mes||f===t.mes,w=!t.pelotao||d.pelotao===t.pelotao,C=!t.postoGrad||m&&m.postoGrad===t.postoGrad;return p&&w&&C}),[e,n,t,s,r]),a=N.useMemo(()=>{const d=o.filter(R=>R.aprovacao===le.VALIDADA_ADMIN),m=d.filter(R=>R.status===we.ATIVA).length,f=d.filter(R=>R.status===we.TROCADA).length,p=d.filter(R=>R.status===we.EXCLUIDA).length,w=o.filter(R=>R.aprovacao===le.ENVIADA_SARGENTO).length,C=o.filter(R=>R.aprovacao===le.APROVADA_SARGENTO).length;return{ativas:m,trocadas:f,excluidas:p,total:m+f+p,pendenteSgt:w,pendenteAdmin:C}},[o]),c=N.useMemo(()=>{const d=o.map(f=>f.motivo).filter(f=>!!f&&f.trim()!=="");if(d.length===0)return[];const m={"Folga Cmt Geral":0,"Folga Cmt Cia":0,"Folga Compensação":0,"Folga Outros":0,"Motivos Antigos/Outros":0};return d.forEach(f=>{f.startsWith("Folga Cmt Geral")?m["Folga Cmt Geral"]++:f.startsWith("Folga Cmt Cia")?m["Folga Cmt Cia"]++:f.startsWith("Folga Compensação")?m["Folga Compensação"]++:f.startsWith("Folga Outros")?m["Folga Outros"]++:m["Motivos Antigos/Outros"]++}),Object.entries(m).map(([f,p])=>({category:f,count:p})).filter(f=>f.count>0).sort((f,p)=>p.count-f.count)},[o]),u=N.useMemo(()=>{const d=new Set(e.map(m=>m.data.substring(0,7)));return Array.from(d).sort().reverse()},[e]);return{stats:a,reasonChartData:c,mesesDisponiveis:u}},rj=()=>{const{folgas:t,ferias:e,agendaEventos:n,policiais:r}=Fe(),{currentUser:s,role:o}=be(),a=N.useMemo(()=>new Map(r.map(f=>[f.id,f])),[r]),c=f=>f.toISOString().split("T")[0],u=N.useMemo(()=>{const f=new Map;return t.filter(p=>p.status===we.ATIVA&&p.aprovacao===le.VALIDADA_ADMIN).filter(p=>o==="SUBORDINADO"?p.policialld===(s==null?void 0:s.policialId):o==="SARGENTO"&&(s==null?void 0:s.pelotao)!=="TODOS"?p.pelotao===(s==null?void 0:s.pelotao):!0).forEach(p=>{const w=p.data;f.has(w)||f.set(w,[]),f.get(w).push(p)}),f},[t,o,s]),d=N.useMemo(()=>{const f=new Map;return e.filter(p=>p.status===Ze.AGENDADA).filter(p=>{const w=a.get(p.policialId);return o==="SUBORDINADO"?p.policialId===(s==null?void 0:s.policialId):o==="SARGENTO"&&(s==null?void 0:s.pelotao)!=="TODOS"?(w==null?void 0:w.pelotao)===(s==null?void 0:s.pelotao):!0}).forEach(p=>{const w=a.get(p.policialId),C={...p};w&&(C.nome=w.nome,C.re=w.re,C.pelotao=w.pelotao);let R=new Date(p.dataInicio+"T12:00:00");const D=new Date(p.dataFim+"T12:00:00");for(;R<=D;){const x=c(R);f.has(x)||f.set(x,[]),f.get(x).push(C),R.setDate(R.getDate()+1)}}),f},[e,o,s,a]),m=N.useMemo(()=>{const f=new Map;return n.filter(w=>o==="ADMIN"||o==="SARGENTO"&&(s==null?void 0:s.pelotao)==="TODOS"?!0:o==="SARGENTO"?w.policiaisIds.some(C=>{var R;return((R=a.get(C))==null?void 0:R.pelotao)===(s==null?void 0:s.pelotao)}):o==="SUBORDINADO"?w.policiaisIds.includes((s==null?void 0:s.policialId)??"-1"):!1).forEach(w=>{const C=w.data;f.has(C)||f.set(C,[]),f.get(C).push(w)}),f},[n,o,s,a]);return{folgasAtivasPorDia:u,feriasPorDia:d,eventosAgendaPorDia:m}},sj=t=>{const{historico:e}=Fe();return N.useMemo(()=>e.filter(n=>{const r=new Date(n.timestamp).getTime(),s=!t.userId||n.actorId===t.userId,o=!t.dataInicio||r>=new Date(t.dataInicio).getTime(),a=!t.dataFim||r<=new Date(t.dataFim+"T23:59:59").getTime();return s&&o&&a}),[e,t])},oj=t=>{const{policiais:e,getCreditsFor:n,countUsedFolgasFor:r}=Fe(),{yearFilter:s,pelotaoFilter:o,searchFilter:a}=t;return N.useMemo(()=>{const c=a.toLowerCase();return e.filter(u=>u.ativo).map(u=>{const d=n(u.id,s),m=r(u.id,s),f=d-m;return{...u,creditos:d,usadas:m,saldo:f}}).filter(u=>{const d=!a||u.nome.toLowerCase().includes(c)||u.re.includes(c),m=!o||u.pelotao===o;return d&&m}).sort((u,d)=>u.nome.localeCompare(d.nome))},[e,s,o,a,n,r])},ij=t=>{const{ferias:e,policiais:n}=Fe(),{currentUser:r,role:s}=be(),o=N.useMemo(()=>new Map(n.map(a=>[a.id,a])),[n]);return N.useMemo(()=>e.map(a=>{const c=o.get(a.policialId);if(c){const{id:u,...d}=c;return{...a,...d}}return a}).filter(a=>{const c=s==="ADMIN"||s==="SARGENTO"&&((r==null?void 0:r.pelotao)==="TODOS"||a.pelotao===(r==null?void 0:r.pelotao))||a.policialId===(r==null?void 0:r.policialId),u=!t.ano||a.anoReferencia.toString()===t.ano,d=!t.pelotao||a.pelotao===t.pelotao,m=!t.status||a.status===t.status;return c&&u&&d&&m}).sort((a,c)=>new Date(c.criadoEm).getTime()-new Date(a.criadoEm).getTime()),[e,t,s,r,o])},aj=()=>{const{agendaEventos:t}=Fe();return N.useMemo(()=>[...t].sort((e,n)=>new Date(n.data).getTime()-new Date(e.data).getTime()),[t])},lj=t=>{const{policiais:e,agendaEventos:n}=Fe(),{tipoFiltro:r,pelotaoFiltro:s}=t,{role:o,currentUser:a}=be(),c=N.useMemo(()=>o==="SARGENTO"&&(a==null?void 0:a.pelotao)!=="TODOS"?e.filter(u=>u.pelotao===(a==null?void 0:a.pelotao)):e,[e,o,a]);return N.useMemo(()=>{const u=n.filter(w=>w.tipo===r),d=new Map;u.forEach(w=>{w.policiaisIds.forEach(C=>{const R=c.find(D=>D.id===C);if(R){const D=d.get(C);(!D||new Date(w.data)>new Date(D.evento.data))&&d.set(C,{policial:R,evento:w})}})});const m=c.filter(w=>w.ativo);let f=m.filter(w=>!d.has(w.id)),p=Array.from(d.values()).sort((w,C)=>w.policial.nome.localeCompare(C.policial.nome));return s&&(p=p.filter(w=>w.policial.pelotao===s),f=m.filter(w=>w.pelotao===s&&!d.has(w.id))),{participantes:p,pendentes:f.sort((w,C)=>w.nome.localeCompare(C.nome))}},[r,s,n,c])},cj=t=>i.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),i.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),uj=t=>i.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),i.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),i.jsx("path",{d:"m9 14 2 2 4-4"})]}),dj=t=>i.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),i.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),i.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),i.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"}),i.jsx("path",{d:"m9 16 2 2 4-4"})]}),hj=t=>i.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z"})}),Ex=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("polyline",{points:"12 6 12 12 16 14"})]}),fj=({className:t})=>i.jsx("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("polyline",{points:"20 6 9 17 4 12"})}),mj=({className:t="h-5 w-5"})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("circle",{cx:"12",cy:"12",r:"6"}),i.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),pj=({icon:t,title:e,date:n,details:r,link:s,colorClass:o})=>{const a=i.jsxs("div",{className:"flex items-start space-x-4 p-3 hover:bg-pm-gray-50 rounded-lg transition-colors duration-150",children:[i.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${o}`,children:t}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-pm-gray-800",children:e}),i.jsx("p",{className:"text-sm text-pm-gray-600",children:n}),r&&i.jsx("p",{className:"text-xs text-pm-gray-500 mt-1",children:r})]})]});return s?i.jsx(Xi,{to:s,children:a}):i.jsx("div",{children:a})},gj=()=>{const{currentUser:t}=be(),{agendaEventos:e,folgas:n,ferias:r}=Fe(),s=N.useMemo(()=>{if(!(t!=null&&t.policialId))return[];const a=new Date;a.setHours(0,0,0,0);const c=new Date(a);c.setDate(a.getDate()+7);const u=[];return e.forEach(d=>{const m=new Date(d.data+"T12:00:00");d.policiaisIds.includes(t.policialId)&&m>=a&&m<=c&&u.push({icon:d.tipo==="OPERACAO"?i.jsx(cj,{className:"h-5 w-5 text-white"}):i.jsx(uj,{className:"h-5 w-5 text-white"}),title:d.titulo,date:`${m.toLocaleDateString("pt-BR")} das ${d.horaInicio} às ${d.horaFim}`,details:`Tipo: ${vs[d.tipo]}`,link:"/calendario",colorClass:"bg-pm-blue"})}),n.forEach(d=>{const m=new Date(d.data+"T12:00:00");d.policialld===t.policialId&&d.status===we.ATIVA&&d.aprovacao===le.VALIDADA_ADMIN&&m>=a&&m<=c&&u.push({icon:i.jsx(dj,{className:"h-5 w-5 text-white"}),title:"Folga Programada",date:m.toLocaleDateString("pt-BR"),link:"/folgas",colorClass:"bg-green-500"})}),r.forEach(d=>{const m=new Date(d.dataInicio+"T12:00:00"),f=new Date(d.dataFim+"T12:00:00");d.policialId===t.policialId&&m<=c&&f>=a&&u.push({icon:i.jsx(hj,{className:"h-5 w-5 text-white"}),title:"Férias",date:`${m.toLocaleDateString("pt-BR")} a ${f.toLocaleDateString("pt-BR")}`,link:"/ferias",colorClass:"bg-teal-500"})}),n.forEach(d=>{d.policialld===t.policialId&&d.aprovacao===le.ENVIADA_SARGENTO&&u.push({icon:i.jsx(Ex,{className:"h-5 w-5 text-white"}),title:"Folga Aguardando Aprovação",date:`Solicitada para ${new Date(d.data+"T12:00:00").toLocaleDateString("pt-BR")}`,link:`/folgas?aprovacao=${le.ENVIADA_SARGENTO}`,colorClass:"bg-yellow-500"})}),u.sort((d,m)=>new Date(d.date.split(" ")[0].split("/").reverse().join("-")).getTime()-new Date(m.date.split(" ")[0].split("/").reverse().join("-")).getTime())},[t,e,n,r]),o=N.useMemo(()=>{if(!(t!=null&&t.policialId))return null;const a=e.filter(c=>c.tipo===ve.EAP&&c.policiaisIds.includes(t.policialId)).sort((c,u)=>new Date(u.data).getTime()-new Date(c.data).getTime());if(a.length>0){const c=a[0];return{status:"Concluído",date:new Date(c.data+"T12:00:00").toLocaleDateString("pt-BR"),details:c.titulo}}else return{status:"Pendente",date:null,details:"Aguardando escalonamento para o próximo EAP."}},[t,e]);return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:[i.jsx("h2",{className:"text-xl font-bold text-pm-gray-800 mb-4",children:"Próximos 7 Dias: Suas Atividades e Ausências"}),s.length>0?i.jsx("div",{className:"space-y-2",children:s.map((a,c)=>i.jsx(pj,{...a},c))}):i.jsx("p",{className:"text-pm-gray-600",children:"Nenhuma atividade agendada para os próximos 7 dias."})]}),o&&i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:[i.jsxs("h2",{className:"text-xl font-bold text-pm-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(mj,{className:"h-6 w-6 text-purple-600"}),"Status do seu EAP (Estágio de Aperfeiçoamento Profissional)"]}),i.jsxs("div",{className:`flex items-center p-4 rounded-lg ${o.status==="Concluído"?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"} border`,children:[i.jsx("div",{className:`flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center ${o.status==="Concluído"?"bg-green-100":"bg-yellow-100"}`,children:o.status==="Concluído"?i.jsx(fj,{className:"h-6 w-6 text-green-600"}):i.jsx(Ex,{className:"h-6 w-6 text-yellow-600"})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:`font-bold text-lg ${o.status==="Concluído"?"text-green-800":"text-yellow-800"}`,children:o.status}),i.jsx("p",{className:"text-sm text-pm-gray-600",children:o.status==="Concluído"?`Última participação em ${o.date} (${o.details})`:o.details})]})]})]})]})},xj=t=>i.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),i.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),yj=t=>i.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),i.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),i.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),i.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"}),i.jsx("path",{d:"m9 16 2 2 4-4"})]}),vj=t=>i.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12"}),i.jsx("path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"})]}),wj=()=>{const{currentUser:t}=be(),{folgas:e,ferias:n,agendaEventos:r,policiais:s}=Fe();Yr();const o=N.useMemo(()=>{if(!(t!=null&&t.pelotao))return{pendentes:[],proximosEventos:[],proximasAusencias:[]};const a=new Date;a.setHours(0,0,0,0);const c=new Date(a);c.setDate(a.getDate()+7);const u=new Set(s.filter(p=>p.pelotao===t.pelotao).map(p=>p.id)),d=e.filter(p=>p.aprovacao===le.ENVIADA_SARGENTO&&p.pelotao===t.pelotao),m=r.filter(p=>{const w=new Date(p.data+"T12:00:00");return w>=a&&w<=c&&p.policiaisIds.some(C=>u.has(C))}).flatMap(p=>p.policiaisIds.filter(w=>u.has(w)).map(w=>({policial:s.find(C=>C.id===w),evento:p}))).filter(p=>p.policial),f=[];return e.forEach(p=>{const w=new Date(p.data+"T12:00:00");p.status===we.ATIVA&&p.aprovacao===le.VALIDADA_ADMIN&&u.has(p.policialld)&&w>=a&&w<=c&&f.push({policial:s.find(C=>C.id===p.policialld),tipo:"Folga",data:w.toLocaleDateString("pt-BR")})}),n.forEach(p=>{const w=new Date(p.dataInicio+"T12:00:00"),C=new Date(p.dataFim+"T12:00:00");u.has(p.policialId)&&w<=c&&C>=a&&f.push({policial:s.find(R=>R.id===p.policialId),tipo:"Férias",data:`${w.toLocaleDateString("pt-BR")} a ${C.toLocaleDateString("pt-BR")}`})}),{pendentes:d,proximosEventos:m,proximasAusencias:f.sort((p,w)=>new Date(p.data.split(" ")[0].split("/").reverse().join("-")).getTime()-new Date(w.data.split(" ")[0].split("/").reverse().join("-")).getTime())}},[t,e,n,r,s]);return i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:[i.jsxs("h2",{className:"text-xl font-bold text-pm-gray-800 mb-4",children:["Painel do Sargento (",t==null?void 0:t.pelotao,")"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"font-semibold text-pm-gray-700 border-b pb-2 mb-3 flex items-center",children:[i.jsx(vj,{className:"h-5 w-5 mr-2 text-pm-red-dark"})," Aprovações Pendentes (",o.pendentes.length,")"]}),i.jsx("div",{className:"space-y-3",children:o.pendentes.length>0?o.pendentes.map(a=>i.jsxs(Xi,{to:`/folgas?aprovacao=${le.ENVIADA_SARGENTO}`,className:"block p-2 bg-pm-red-100/50 hover:bg-pm-red-100 rounded-lg border border-pm-red-200",children:[i.jsx("p",{className:"font-semibold text-sm text-pm-red-800",children:a.nome}),i.jsxs("p",{className:"text-xs text-pm-gray-600",children:["Para ",new Date(a.data+"T12:00:00").toLocaleDateString("pt-BR")]})]},a.folgald)):i.jsx("p",{className:"text-sm text-pm-gray-500",children:"Nenhuma pendência."})})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"font-semibold text-pm-gray-700 border-b pb-2 mb-3 flex items-center",children:[i.jsx(xj,{className:"h-5 w-5 mr-2 text-pm-blue"})," Efetivo em Eventos (Próx. 7 dias)"]}),i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:o.proximosEventos.length>0?o.proximosEventos.map((a,c)=>i.jsxs("div",{className:"p-2 border-b",children:[i.jsx("p",{className:"font-semibold text-sm",children:a.policial.nome}),i.jsxs("p",{className:"text-xs text-pm-gray-600",children:[a.evento.titulo," em ",new Date(a.evento.data+"T12:00:00").toLocaleDateString("pt-BR")]})]},c)):i.jsx("p",{className:"text-sm text-pm-gray-500",children:"Nenhum policial em eventos."})})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"font-semibold text-pm-gray-700 border-b pb-2 mb-3 flex items-center",children:[i.jsx(yj,{className:"h-5 w-5 mr-2 text-green-600"})," Próximas Folgas e Férias"]}),i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:o.proximasAusencias.length>0?o.proximasAusencias.map((a,c)=>i.jsxs("div",{className:"p-2 border-b",children:[i.jsx("p",{className:"font-semibold text-sm",children:a.policial.nome}),i.jsxs("p",{className:"text-xs text-pm-gray-600",children:[a.tipo," em ",a.data]})]},c)):i.jsx("p",{className:"text-sm text-pm-gray-500",children:"Nenhuma ausência programada."})})]})]})]})},_j=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),i.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),i.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),i.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),Ej=({className:t})=>i.jsx("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("polyline",{points:"20 6 9 17 4 12"})}),Aj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("polyline",{points:"16 3 21 3 21 8"}),i.jsx("line",{x1:"4",y1:"20",x2:"21",y2:"3"}),i.jsx("polyline",{points:"8 21 3 21 3 16"}),i.jsx("line",{x1:"20",y1:"4",x2:"3",y2:"21"})]}),Sj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),i.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),Ax=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("polyline",{points:"12 6 12 12 16 14"})]}),Nj=t=>i.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z"})}),Ij=({className:t="h-5 w-5"})=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:i.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20v2H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v15H6.5A2.5 2.5 0 0 1 4 4.5z"})}),Tj=({className:t="h-5 w-5"})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("circle",{cx:"12",cy:"12",r:"6"}),i.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),jj=t=>i.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"12",cy:"8",r:"7"}),i.jsx("polyline",{points:"8.21 13.89 7 23 12 17 17 23 15.79 13.88"})]}),Cj=()=>{const{role:t,currentUser:e}=be(),{ferias:n,agendaEventos:r,getBalanceFor:s,grupos:o}=Fe(),[a,c]=X0(),u=Yr(),[d,m]=N.useState({mes:a.get("mes")||"",pelotao:a.get("pelotao")||"",postoGrad:a.get("postoGrad")||""}),{stats:f,reasonChartData:p,mesesDisponiveis:w}=nj(d);N.useEffect(()=>{const B=new URLSearchParams;d.mes&&B.set("mes",d.mes),d.pelotao&&B.set("pelotao",d.pelotao),d.postoGrad&&B.set("postoGrad",d.postoGrad),c(B)},[d,c]);const C=N.useMemo(()=>[...o].sort((B,M)=>B.nome.localeCompare(M.nome)),[o]),R=new Date().getFullYear(),D=e!=null&&e.policialId?s(e.policialId,R):null,x=N.useMemo(()=>{const B=new Date,M=B.getFullYear(),S=B.getMonth(),_=new Date(M,S,1),y=new Date(M,S+1,0),j=new Set;n.forEach(E=>{if(E.status===Ze.AGENDADA){const Q=new Date(E.dataInicio+"T12:00:00"),P=new Date(E.dataFim+"T12:00:00");Q<=y&&P>=_&&j.add(E.policialId)}});const b=new Set,T=new Set;return r.forEach(E=>{const Q=new Date(E.data+"T12:00:00");Q.getFullYear()===M&&Q.getMonth()===S&&(E.tipo===ve.EAP?E.policiaisIds.forEach(P=>b.add(P)):E.tipo===ve.CURSO&&E.policiaisIds.forEach(P=>T.add(P)))}),{feriasMesCorrente:j.size,eapMesCorrente:b.size,cursoMesCorrente:T.size}},[n,r]),v=B=>{const{name:M,value:S}=B.target;m(_=>({..._,[M]:S}))},L={ADMIN:{color:"bg-pm-blue-light bg-opacity-20",icon:"text-pm-blue"},SARGENTO:{color:"bg-red-100",icon:"text-pm-red-dark"},SUBORDINADO:{color:"bg-pm-gray-200",icon:"text-pm-gray-800"}}[t||"SUBORDINADO"];return i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Página Inicial"}),i.jsxs("p",{className:"text-lg text-pm-gray-600 mb-6",children:["Bem-vindo, ",e==null?void 0:e.nome,"!"]}),(e==null?void 0:e.policialId)&&D!==null&&i.jsx("div",{className:"mb-8 max-w-sm",children:i.jsx(kn,{title:`MEU SALDO DE FOLGAS (${R})`,value:D,icon:i.jsx(jj,{className:D>0?"text-green-600":"text-red-600"}),color:D>0?"bg-green-100":"bg-red-100",onClick:()=>u("/folgas")})}),t==="SUBORDINADO"&&i.jsx(gj,{}),t==="SARGENTO"&&i.jsx(wj,{}),i.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mes",className:"block text-sm font-medium text-pm-gray-700",children:"Mês"}),i.jsxs("select",{id:"mes",name:"mes",value:d.mes,onChange:v,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-pm-gray-300 focus:outline-none focus:ring-pm-blue focus:border-pm-blue sm:text-sm rounded-md",children:[i.jsx("option",{value:"",children:"Todos os Meses"}),w.map(B=>i.jsx("option",{value:B,children:new Date(B+"-02").toLocaleString("pt-BR",{month:"long",year:"numeric"})},B))]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"pelotao",className:"block text-sm font-medium text-pm-gray-700",children:"Grupo/Pelotão"}),i.jsxs("select",{id:"pelotao",name:"pelotao",value:d.pelotao,onChange:v,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-pm-gray-300 focus:outline-none focus:ring-pm-blue focus:border-pm-blue sm:text-sm rounded-md",children:[i.jsx("option",{value:"",children:"Todos os Grupos"}),C.map(B=>i.jsx("option",{value:B.nome,children:B.nome},B.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"postoGrad",className:"block text-sm font-medium text-pm-gray-700",children:"Posto/Grad."}),i.jsxs("select",{id:"postoGrad",name:"postoGrad",value:d.postoGrad,onChange:v,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-pm-gray-300 focus:outline-none focus:ring-pm-blue focus:border-pm-blue sm:text-sm rounded-md",children:[i.jsx("option",{value:"",children:"Todos os Postos/Grads"}),Fw.map(B=>i.jsx("option",{value:B,children:B},B))]})]})]})}),t==="ADMIN"&&i.jsxs(i.Fragment,{children:[i.jsx("h2",{className:"text-xl font-semibold text-pm-gray-700 mb-4",children:"Resumo do Mês Corrente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[i.jsx(kn,{title:"POLICIAIS DE FÉRIAS",value:x.feriasMesCorrente,icon:i.jsx(Nj,{className:"text-teal-600"}),color:"bg-teal-100",onClick:()=>u("/ferias")}),i.jsx(kn,{title:"EM EAP",value:x.eapMesCorrente,icon:i.jsx(Tj,{className:"text-purple-600"}),color:"bg-purple-100",onClick:()=>u("/agenda")}),i.jsx(kn,{title:"EM CURSO",value:x.cursoMesCorrente,icon:i.jsx(Ij,{className:"text-indigo-600"}),color:"bg-indigo-100",onClick:()=>u("/agenda")})]})]}),i.jsx("h2",{className:"text-xl font-semibold text-pm-gray-700 mb-4",children:"Resumo Oficial (Folgas Validadas)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[i.jsx(kn,{title:"TOTAL DE FOLGAS",value:f.total,icon:i.jsx(_j,{className:L.icon}),color:L.color,onClick:()=>u(`/folgas?aprovacao=${le.VALIDADA_ADMIN}`)}),i.jsx(kn,{title:"ATIVAS",value:f.ativas,icon:i.jsx(Ej,{className:"text-green-600"}),color:"bg-green-100",onClick:()=>u(`/folgas?aprovacao=${le.VALIDADA_ADMIN}&status=${we.ATIVA}`)}),i.jsx(kn,{title:"TROCADAS",value:f.trocadas,icon:i.jsx(Aj,{className:"text-yellow-600"}),color:"bg-yellow-100",onClick:()=>u(`/folgas?aprovacao=${le.VALIDADA_ADMIN}&status=${we.TROCADA}`)}),i.jsx(kn,{title:"EXCLUÍDAS",value:f.excluidas,icon:i.jsx(Sj,{className:"text-red-600"}),color:"bg-red-100",onClick:()=>u(`/folgas?aprovacao=${le.VALIDADA_ADMIN}&status=${we.EXCLUIDA}`)})]}),i.jsx("h2",{className:"text-xl font-semibold text-pm-gray-700 mb-4",children:"Pendências"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(kn,{title:"PENDENTES SARGENTO",value:f.pendenteSgt,icon:i.jsx(Ax,{className:"text-orange-600"}),color:"bg-orange-100",onClick:()=>u(`/folgas?aprovacao=${le.ENVIADA_SARGENTO}`)}),i.jsx(kn,{title:"PENDENTES ADMIN",value:f.pendenteAdmin,icon:i.jsx(Ax,{className:"text-cyan-600"}),color:"bg-cyan-100",onClick:()=>u(`/folgas?aprovacao=${le.APROVADA_SARGENTO}`)})]}),i.jsxs("div",{className:"mt-8",children:[i.jsx("h2",{className:"text-xl font-semibold text-pm-gray-700 mb-4",children:"Análise de Motivos de Folga"}),i.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:p.length>0?i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-pm-gray-800 mb-4",children:"Principais Motivos de Folga"}),i.jsx("div",{className:"space-y-3",children:p.map(({category:B,count:M},S)=>{const _=p[0].count,y=_>0?M/_*100:0;return i.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center text-sm",children:[i.jsx("div",{className:"col-span-3 text-pm-gray-600 font-medium truncate",children:B}),i.jsx("div",{className:"col-span-9",children:i.jsx("div",{className:"w-full bg-pm-gray-200 rounded-full h-6 relative",children:i.jsx("div",{className:"bg-pm-blue h-6 rounded-full flex items-center",style:{width:`${y}%`,minWidth:"35px"},role:"progressbar","aria-valuenow":M,"aria-valuemin":0,"aria-valuemax":_,"aria-label":`${B}: ${M}`,children:i.jsx("span",{className:"font-bold text-white pl-2",children:M})})})})]},S)})})]}):i.jsx("div",{className:"text-center py-8 border-2 border-dashed border-pm-gray-200 rounded-lg",children:i.jsx("p",{className:"text-pm-gray-600",children:"Não há motivos de folga para exibir no período selecionado."})})})]})]})},cn=({isOpen:t,onClose:e,title:n,children:r})=>t?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:e,children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md flex flex-col max-h-full",onClick:s=>s.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex-shrink-0 flex justify-between items-center",children:[i.jsx("h2",{className:"text-xl font-semibold text-pm-gray-800",children:n}),i.jsx("button",{onClick:e,className:"text-pm-gray-400 hover:text-pm-gray-600",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),i.jsx("div",{className:"p-6 overflow-y-auto",children:r})]})}):null,bj=({message:t,type:e="success"})=>{const n={success:"bg-green-600",error:"bg-red-600",warning:"bg-yellow-500"}[e];return i.jsxs("div",{className:`fixed top-20 right-8 text-white py-3 px-5 rounded-lg shadow-xl z-50 flex items-center ${n}`,role:"alert","aria-live":"assertive",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M12 16v-4"}),i.jsx("path",{d:"M12 8h.01"})]}),i.jsx("span",{children:t})]})},Rj=()=>{const{policiais:t,users:e,addFolga:n,updateFolga:r,getBalanceFor:s,canRequestFolga:o,comentarios:a,addComentario:c,grupos:u}=Fe(),{currentUser:d,role:m}=be(),[f]=X0(),[p,w]=N.useState(!1),[C,R]=N.useState(null),[D,x]=N.useState("add"),[v,I]=N.useState(""),[L,B]=N.useState(),[M,S]=N.useState(null),[_,y]=N.useState(""),[j,b]=N.useState(new Set),[T,E]=N.useState(new Set),[Q,P]=N.useState(!1),[F,O]=N.useState("");N.useRef(null);const[k,G]=N.useState(""),[W,Z]=N.useState(""),[ne,oe]=N.useState(""),[re,Re]=N.useState(""),[pe,tt]=N.useState(""),[Yt,jn]=N.useState(""),[$,se]=N.useState("integral"),[Ne,nt]=N.useState("08-13"),[Ct,We]=N.useState({nomeRe:"",pelotao:"",aprovacao:f.get("aprovacao")||"",status:f.get("status")||""}),[Cn,Et]=N.useState(!1),[de,He]=N.useState(null),[ct,ar]=N.useState(""),va=new Date().getFullYear(),Lo=d!=null&&d.policialId?s(d.policialId,va):null,wa=tj(Ct),es=N.useMemo(()=>[...u].sort((H,fe)=>H.nome.localeCompare(fe.nome)),[u]);N.useEffect(()=>{if(M){const H=setTimeout(()=>S(null),4e3);return()=>clearTimeout(H)}},[M]);const ts=H=>{const{name:fe,value:gt}=H.target;We(rs=>({...rs,[fe]:gt})),E(new Set)};N.useMemo(()=>e.filter(H=>H.role==="SARGENTO"&&H.ativo),[e]);const Vo=N.useMemo(()=>{if(!_.trim())return t.filter(fe=>fe.ativo).sort((fe,gt)=>fe.nome.localeCompare(gt.nome));const H=_.toLowerCase();return t.filter(fe=>fe.ativo&&(fe.re.toLowerCase().includes(H)||fe.nome.toLowerCase().includes(H)||fe.pelotao.toLowerCase().includes(H)))},[t,_]),yn=(H,fe=null)=>{x(H),H==="add"?(R({policialld:m==="SUBORDINADO"?(d==null?void 0:d.policialId)??void 0:void 0,data:"",motivo:""}),G(""),Z(""),oe(""),Re(""),tt(""),jn(""),se("integral"),nt("08-13"),y("")):R(fe),I(""),B(void 0),w(!0)},Xc=H=>{He(H),ar(""),Et(!0)},Yc=async()=>{if(!(!C||!d))try{if(D==="add"){const H=new Date;H.setHours(0,0,0,0);const fe=C.data?new Date(C.data+"T00:00:00"):null;if(!C.policialld)throw new Error("Policial é obrigatório.");if(!C.data||!fe||fe<H)throw new Error("Data inválida. Selecione uma data de hoje ou futura.");if(k==="Folga Cmt Geral"){const{ok:rs,error:ks,warn:Fo}=o({policialId:C.policialld,dateISO:C.data,allowOverride:m==="ADMIN"||m==="SARGENTO"});if(!rs)throw new Error(ks||"Falha ao verificar saldo.");Fo&&S({message:Fo,type:"warning"})}let gt="";switch(k){case"Folga Cmt Geral":gt="Folga Cmt Geral";break;case"Folga Cmt Cia":if(W.trim().length<5)throw new Error("O motivo para a Folga Cmt Cia é obrigatório (mín. 5 caracteres).");gt=`Folga Cmt Cia: ${W.trim()}`;break;case"Folga Compensação":if(!ne||!re||!pe)throw new Error("Para Folga Compensação, a data, início e fim do serviço extra são obrigatórios.");gt=`Folga Compensação - Dia: ${new Date(ne+"T00:00:00").toLocaleDateString("pt-BR")} | Início: ${re} | Fim: ${pe}${Yt?` | BOPM: ${Yt}`:""}`;break;case"Folga Semanal":gt=$==="integral"?"Folga Semanal (Integral)":`Folga Semanal (Meio Expediente - ${Ne==="08-13"?"08h00 às 13h00":"13h00 às 18h00"})`;break;case"Folga Outros":if(W.trim().length<10)throw new Error("O motivo para 'Outros' é obrigatório (mín. 10 caracteres).");gt=`Folga Outros: ${W.trim()}`;break;default:throw new Error("Selecione um tipo de motivo para a folga.")}await n({policialld:C.policialld,data:C.data,motivo:gt},d),S(m==="SUBORDINADO"?{message:"Folga enviada para aprovação do sargento.",type:"success"}:m==="SARGENTO"?{message:"Folga aprovada e enviada para validação do admin.",type:"success"}:{message:"Folga validada com sucesso.",type:"success"})}else{let H={};if(D==="trocar"){if(!C.trocadaPara)throw new Error("A nova data é obrigatória.");H={status:we.TROCADA,trocadaPara:C.trocadaPara,motivo:v}}else if(D==="excluir"){if(!v.trim())throw new Error("O motivo da exclusão é obrigatório.");H={status:we.EXCLUIDA,motivo:v}}else if(D==="sargento"){if(!v.trim())throw new Error("O parecer é obrigatório.");const fe=C.actionType;fe==="aprovar"?H={aprovacao:le.APROVADA_SARGENTO,sargentoParecer:v,sargentold:d.id}:fe==="negar"&&(H={aprovacao:le.NEGADA_SARGENTO,sargentoParecer:v,sargentold:d.id})}else if(D==="parecer"){if(!v.trim())throw new Error("O parecer é obrigatório.");const fe=C.actionType;fe==="aprovar"?H={aprovacao:le.VALIDADA_ADMIN,adminParecer:v,adminld:d.id}:fe==="negar"&&(H={aprovacao:le.REPROVADA_ADMIN,adminParecer:v,adminld:d.id})}Object.keys(H).length>0&&(await r(C.folgald,H,d),S({message:"Operação realizada com sucesso!",type:"success"}))}w(!1)}catch(H){S({message:H.message,type:"error"})}},Mo=N.useMemo(()=>de?a.filter(H=>H.folgald===de.folgald).sort((H,fe)=>new Date(H.timestamp).getTime()-new Date(fe.timestamp).getTime()):[],[a,de]),_a=async()=>{if(!(!de||!ct.trim()||!d))try{await c(de.folgald,ct,d),ar(""),S({message:"Comentário adicionado!",type:"success"})}catch(H){S({message:H.message,type:"error"})}},ns=async H=>{if(!(!d||!window.confirm("Restaurar esta folga para ATIVA?")))try{await r(H.folgald,{status:we.ATIVA,trocadaPara:null},d),S({message:"Folga restaurada!",type:"success"}),Et(!1)}catch(fe){S({message:fe.message,type:"error"})}};return i.jsxs("div",{className:"container mx-auto",children:[M&&i.jsx(bj,{message:M.message,type:M.type}),i.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Gerenciar Folgas"}),i.jsxs("div",{className:"flex items-center gap-2",children:[Lo!==null&&i.jsxs("span",{className:"text-sm font-semibold bg-white px-3 py-2 rounded-lg shadow-sm",children:["Meu Saldo ",va,": ",Lo]}),i.jsx("button",{onClick:()=>yn("add"),className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:"Acionar Folga"})]})]}),i.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("input",{type:"text",name:"nomeRe",placeholder:"Buscar por Nome ou RE...",value:Ct.nomeRe,onChange:ts,className:"w-full px-3 py-2 border rounded-md"}),i.jsxs("select",{name:"pelotao",value:Ct.pelotao,onChange:ts,className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Todos os Grupos"}),es.map(H=>i.jsx("option",{value:H.nome,children:H.nome},H.id))]}),i.jsxs("select",{name:"aprovacao",value:Ct.aprovacao,onChange:ts,className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Toda Aprovação"}),Object.entries(Qu).map(([H,fe])=>i.jsx("option",{value:H,children:fe},H))]}),i.jsxs("select",{name:"status",value:Ct.status,onChange:ts,className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Todo Status"}),XT.map(H=>i.jsx("option",{value:H.value,children:H.label},H.value))]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:[i.jsxs("table",{className:"w-full text-sm text-left text-pm-gray-600",children:[i.jsx("thead",{className:"text-xs uppercase bg-pm-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3",children:"Policial"}),i.jsx("th",{className:"px-6 py-3",children:"Data"}),i.jsx("th",{className:"px-6 py-3",children:"Status Aprovação"}),i.jsx("th",{className:"px-6 py-3",children:"Status Folga"}),i.jsx("th",{className:"px-6 py-3 text-right",children:"Ações"})]})}),i.jsx("tbody",{children:wa.map(H=>i.jsxs("tr",{className:"bg-white border-b hover:bg-pm-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 font-medium",children:[H.nome,i.jsx("br",{}),i.jsxs("span",{className:"text-xs text-pm-gray-500",children:[H.re," - ",H.pelotao]})]}),i.jsx("td",{className:"px-6 py-4",children:new Date(H.data+"T00:00:00").toLocaleDateString("pt-BR")}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${vx[H.aprovacao]}`,children:Qu[H.aprovacao]})}),i.jsx("td",{className:"px-6 py-4",children:H.status}),i.jsx("td",{className:"px-6 py-4 text-right space-x-2 whitespace-nowrap",children:i.jsx("button",{onClick:()=>Xc(H),className:"font-medium text-pm-blue hover:underline",children:"Detalhes"})})]},H.folgald))})]}),wa.length===0&&i.jsx("p",{className:"text-center p-4 text-pm-gray-500",children:"Nenhuma folga encontrada."})]}),i.jsx(cn,{isOpen:p,onClose:()=>w(!1),title:D==="add"?"Acionar Nova Folga":D==="trocar"?"Trocar Folga":D==="excluir"?"Excluir Folga":"Dar Parecer sobre Folga",children:C&&i.jsxs("form",{onSubmit:H=>{H.preventDefault(),Yc()},className:"space-y-4",children:[D==="add"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-pm-gray-700",children:"Policial"}),m==="SUBORDINADO"?i.jsx("input",{type:"text",value:(d==null?void 0:d.nome)||"",disabled:!0,className:"mt-1 w-full border border-gray-300 rounded-md p-2 bg-pm-gray-100"}):i.jsxs("div",{children:[i.jsx("input",{type:"text",placeholder:"Buscar por nome, RE ou pelotão...",value:_,onChange:H=>y(H.target.value),className:"mt-1 w-full border border-gray-300 rounded-md p-2 mb-1"}),i.jsxs("select",{value:C.policialld||"",onChange:H=>R(fe=>({...fe,policialld:Number(H.target.value)})),className:"w-full border border-gray-300 rounded-md p-2",required:!0,size:Math.min(5,Vo.length+1),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecione um policial"}),Vo.map(H=>i.jsxs("option",{value:H.id,children:[H.postoGrad," ",H.nome," (",H.re,") - ",H.pelotao]},H.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-pm-gray-700",children:"Data da Folga"}),i.jsx("input",{type:"date",value:C.data||"",onChange:H=>R(fe=>({...fe,data:H.target.value})),className:"mt-1 w-full border border-gray-300 rounded-md p-2",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-pm-gray-700",children:"Tipo do Motivo"}),i.jsxs("select",{value:k,onChange:H=>G(H.target.value),className:"mt-1 w-full border border-gray-300 rounded-md p-2",required:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Selecione um tipo..."}),i.jsx("option",{value:"Folga Cmt Geral",children:"Folga Cmt Geral"}),i.jsx("option",{value:"Folga Cmt Cia",children:"Folga Cmt Cia"}),i.jsx("option",{value:"Folga Compensação",children:"Folga Compensação"}),i.jsx("option",{value:"Folga Semanal",children:"Folga Semanal"}),i.jsx("option",{value:"Folga Outros",children:"Folga Outros"})]})]}),k==="Folga Cmt Cia"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-pm-gray-700",children:"Justificativa (Cmt Cia)"}),i.jsx("textarea",{value:W,onChange:H=>Z(H.target.value),className:"mt-1 w-full border border-gray-300 rounded-md p-2",rows:3,required:!0})]}),k==="Folga Compensação"&&i.jsxs("div",{className:"p-3 border rounded-md bg-pm-gray-50 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-sm",children:"Detalhes do Serviço Compensado"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs",children:"Data"}),i.jsx("input",{type:"date",value:ne,onChange:H=>oe(H.target.value),className:"mt-1 w-full border-gray-300 rounded-md p-2 text-sm",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs",children:"Início"}),i.jsx("input",{type:"time",value:re,onChange:H=>Re(H.target.value),className:"mt-1 w-full border-gray-300 rounded-md p-2 text-sm",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs",children:"Fim"}),i.jsx("input",{type:"time",value:pe,onChange:H=>tt(H.target.value),className:"mt-1 w-full border-gray-300 rounded-md p-2 text-sm",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs",children:"Nº BOPM (Opcional)"}),i.jsx("input",{type:"text",value:Yt,onChange:H=>jn(H.target.value),className:"mt-1 w-full border-gray-300 rounded-md p-2 text-sm"})]})]}),k==="Folga Semanal"&&i.jsxs("div",{className:"p-3 border rounded-md bg-pm-gray-50 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-sm",children:"Tipo de Folga Semanal"}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"folgaSemanalTipo",value:"integral",checked:$==="integral",onChange:()=>se("integral"),className:"mr-2"})," Integral"]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"folgaSemanalTipo",value:"meio",checked:$==="meio",onChange:()=>se("meio"),className:"mr-2"})," Meio Expediente"]})]}),$==="meio"&&i.jsxs("div",{className:"pl-6 border-l-2",children:[i.jsx("h5",{className:"text-xs font-semibold",children:"Horário"}),i.jsxs("div",{className:"flex gap-4 mt-1",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"meioExpedienteHorario",value:"08-13",checked:Ne==="08-13",onChange:()=>nt("08-13"),className:"mr-2"})," 08:00 às 13:00"]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"meioExpedienteHorario",value:"13-18",checked:Ne==="13-18",onChange:()=>nt("13-18"),className:"mr-2"})," 13:00 às 18:00"]})]})]})]}),k==="Folga Outros"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-pm-gray-700",children:"Justificativa (Outros)"}),i.jsx("textarea",{value:W,onChange:H=>Z(H.target.value),className:"mt-1 w-full border border-gray-300 rounded-md p-2",rows:3,required:!0})]})]}),D==="trocar"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-pm-gray-700",children:"Nova Data da Folga"}),i.jsx("input",{type:"date",value:C.trocadaPara||"",onChange:H=>R(fe=>({...fe,trocadaPara:H.target.value})),className:"mt-1 w-full border-gray-300 rounded-md p-2",required:!0})]}),(D==="trocar"||D==="excluir"||D==="parecer"||D==="sargento")&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-pm-gray-700",children:D==="trocar"?"Motivo da Troca":D==="excluir"?"Motivo da Exclusão":"Parecer"}),i.jsx("textarea",{value:v,onChange:H=>I(H.target.value),className:"mt-1 w-full border-gray-300 rounded-md p-2",rows:4,required:!0})]}),i.jsxs("div",{className:"flex justify-end pt-4 space-x-2",children:[i.jsx("button",{type:"button",onClick:()=>w(!1),className:"bg-pm-gray-200 hover:bg-pm-gray-300 text-pm-gray-800 font-bold py-2 px-4 rounded-md",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:D==="add"?"Acionar Folga":"Salvar"})]})]})}),i.jsx(cn,{isOpen:Cn,onClose:()=>Et(!1),title:"Detalhes da Folga",children:de&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-bold text-lg",children:de.nome}),i.jsxs("p",{className:"text-sm text-pm-gray-500",children:["RE: ",de.re," - ",de.pelotao]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-3 bg-pm-gray-50 rounded-lg border",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-semibold",children:"DATA DA FOLGA"}),i.jsx("p",{children:new Date(de.data+"T00:00:00").toLocaleDateString("pt-BR")})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-semibold",children:"STATUS APROVAÇÃO"}),i.jsx("p",{children:i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${vx[de.aprovacao]}`,children:Qu[de.aprovacao]})})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-semibold",children:"STATUS FOLGA"}),i.jsx("p",{children:de.status})]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:"Motivo:"}),i.jsx("p",{className:"p-2 bg-pm-gray-50 rounded mt-1 whitespace-pre-wrap",children:de.motivo||"Não especificado"})]}),de.sargentoParecer&&i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:"Parecer Sargento:"}),i.jsx("p",{className:"p-2 bg-pm-gray-50 rounded mt-1",children:de.sargentoParecer})]}),de.adminParecer&&i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:"Parecer Admin:"}),i.jsx("p",{className:"p-2 bg-pm-gray-50 rounded mt-1",children:de.adminParecer})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[m==="SARGENTO"&&de.aprovacao===le.ENVIADA_SARGENTO&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{Et(!1),yn("sargento",{...de,actionType:"aprovar"})},className:"bg-green-500 text-white px-3 py-1 rounded text-sm",children:"Aprovar"}),i.jsx("button",{onClick:()=>{Et(!1),yn("sargento",{...de,actionType:"negar"})},className:"bg-red-500 text-white px-3 py-1 rounded text-sm",children:"Negar"})]}),m==="ADMIN"&&de.aprovacao===le.APROVADA_SARGENTO&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{Et(!1),yn("parecer",{...de,actionType:"aprovar"})},className:"bg-green-500 text-white px-3 py-1 rounded text-sm",children:"Validar"}),i.jsx("button",{onClick:()=>{Et(!1),yn("parecer",{...de,actionType:"negar"})},className:"bg-red-500 text-white px-3 py-1 rounded text-sm",children:"Reprovar"})]}),(m==="ADMIN"||m==="SARGENTO")&&de.status===we.ATIVA&&de.aprovacao===le.VALIDADA_ADMIN&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{Et(!1),yn("trocar",de)},className:"bg-yellow-500 text-white px-3 py-1 rounded text-sm",children:"Trocar"}),i.jsx("button",{onClick:()=>{Et(!1),yn("excluir",de)},className:"bg-gray-500 text-white px-3 py-1 rounded text-sm",children:"Excluir"})]}),m==="ADMIN"&&(de.status===we.TROCADA||de.status===we.EXCLUIDA)&&i.jsx("button",{onClick:()=>ns(de),className:"bg-blue-500 text-white px-3 py-1 rounded text-sm",children:"Restaurar Folga"})]}),i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Comentários"}),i.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto pr-2 mb-2",children:Mo.length>0?Mo.map(H=>i.jsxs("div",{className:"bg-pm-gray-100 p-2 rounded-md text-sm",children:[i.jsxs("p",{className:"font-semibold",children:[H.actorPostoGrad," ",H.actorNome," ",i.jsxs("span",{className:"text-xs text-pm-gray-500 font-normal",children:["- ",new Date(H.timestamp).toLocaleString("pt-BR")]})]}),i.jsx("p",{children:H.mensagem})]},H.id)):i.jsx("p",{className:"text-sm text-pm-gray-500 italic",children:"Nenhum comentário."})}),i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx("textarea",{value:ct,onChange:H=>ar(H.target.value),rows:2,className:"w-full border rounded-md p-2",placeholder:"Adicionar comentário..."}),i.jsx("button",{onClick:_a,className:"bg-pm-blue text-white px-4 py-2 rounded-md text-sm",children:"Enviar"})]})]})]})})]})},Dj=({message:t,type:e="success"})=>{const n=e==="success"?"bg-green-600":"bg-red-600",[r,s]=N.useState(!1);return N.useEffect(()=>{s(!0);const o=setTimeout(()=>s(!1),3e3);return()=>clearTimeout(o)},[t]),i.jsxs("div",{className:`fixed top-20 right-8 text-white py-3 px-5 rounded-lg shadow-xl z-50 flex items-center transition-opacity duration-300 ${n} ${r?"opacity-100":"opacity-0"}`,role:"alert","aria-live":"assertive",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M12 16v-4"}),i.jsx("path",{d:"M12 8h.01"})]}),i.jsx("span",{children:t})]})},kj=({isOpen:t,onClose:e,policial:n,mode:r})=>{const{grantAccess:s,resetPassword:o}=be(),[a,c]=N.useState(""),[u,d]=N.useState(""),[m,f]=N.useState("SUBORDINADO"),[p,w]=N.useState(""),[C,R]=N.useState("");N.useEffect(()=>{t||(c(""),d(""),f("SUBORDINADO"),w(""),R(""))},[t]);const D=async()=>{if(R(""),a.length<3){R("A senha deve ter pelo menos 3 caracteres.");return}if(a!==u){R("As senhas não coincidem.");return}if(!n)return;const x=r==="grant"?await s(n,a,m,p):await o(n.id,a);x.ok?e():R(x.error||"Ocorreu um erro.")};return n?i.jsx(cn,{isOpen:t,onClose:e,title:r==="grant"?"Conceder Acesso":"Resetar Senha",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{className:"text-sm",children:["Policial: ",i.jsx("strong",{children:n.nome})]}),C&&i.jsx("p",{className:"text-red-500 text-sm bg-red-50 p-2 rounded-md",children:C}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nova Senha"}),i.jsx("input",{type:"password",value:a,onChange:x=>c(x.target.value),className:"mt-1 w-full border border-gray-300 rounded-md p-2"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Confirmar Senha"}),i.jsx("input",{type:"password",value:u,onChange:x=>d(x.target.value),className:"mt-1 w-full border border-gray-300 rounded-md p-2"})]}),r==="grant"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Perfil de Acesso"}),i.jsxs("select",{value:m,onChange:x=>f(x.target.value),className:"mt-1 w-full border border-gray-300 rounded-md p-2",children:[i.jsx("option",{value:"SUBORDINADO",children:"Subordinado"}),i.jsx("option",{value:"SARGENTO",children:"Sargento"}),i.jsx("option",{value:"ADMIN",children:"Administrador"})]})]}),m==="ADMIN"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-red-700",children:"Sua Senha de Admin (Confirmação)"}),i.jsx("input",{type:"password",value:p,onChange:x=>w(x.target.value),className:"mt-1 w-full border border-red-300 rounded-md p-2",required:!0}),i.jsx("p",{className:"text-xs text-pm-gray-500 mt-1",children:"Para conceder privilégios de administrador, confirme com sua própria senha."})]})]}),i.jsxs("div",{className:"flex justify-end pt-4 space-x-2",children:[i.jsx("button",{type:"button",onClick:e,className:"bg-pm-gray-200 hover:bg-pm-gray-300 text-pm-gray-800 font-bold py-2 px-4 rounded-md",children:"Cancelar"}),i.jsx("button",{onClick:D,className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:r==="grant"?"Conceder Acesso":"Salvar Nova Senha"})]})]})}):null},Pj=()=>{const{policiais:t,users:e,addPolicial:n,updatePolicial:r,bulkUpsertPoliciais:s,grupos:o}=Fe(),{currentUser:a,revokeAccess:c}=be(),[u,d]=N.useState(!1),[m,f]=N.useState(null),[p,w]=N.useState(!1),[C,R]=N.useState("grant"),[D,x]=N.useState(null),[v,I]=N.useState(null),[L,B]=N.useState({termo:"",pelotao:"",ativo:"true"}),M=N.useRef(null),S=N.useMemo(()=>new Map(e.filter(O=>O.policialId!==null).map(O=>[O.policialId,O])),[e]),_=N.useMemo(()=>[...o].sort((O,k)=>O.nome.localeCompare(k.nome)),[o]),y=N.useMemo(()=>{const O=L.termo.toLowerCase();return t.filter(k=>{const G=!L.termo||k.nome.toLowerCase().includes(O)||k.re.toLowerCase().includes(O),W=!L.pelotao||k.pelotao===L.pelotao,Z=L.ativo===""||k.ativo===(L.ativo==="true");return G&&W&&Z}).sort((k,G)=>k.nome.localeCompare(G.nome))},[t,L]),j=O=>{B(k=>({...k,[O.target.name]:O.target.value}))},b=(O=null)=>{f(O?{...O}:{nome:"",re:"",postoGrad:"Sd 2ª Cl",pelotao:"",ativo:!0}),d(!0)},T=async()=>{if(!(!m||!a))try{if(!m.nome||!m.re||!m.postoGrad||!m.pelotao)throw new Error("Todos os campos são obrigatórios.");m.id?(await r(m,a),I({message:"Policial atualizado com sucesso!",type:"success"})):(await n(m,a),I({message:"Policial adicionado com sucesso!",type:"success"})),d(!1)}catch(O){I({message:O.message,type:"error"})}},E=(O,k)=>{x(O),R(k),w(!0)},Q=async O=>{if(window.confirm(`Tem certeza que deseja REVOGAR o acesso de ${O.nome}? O policial não poderá mais logar no sistema.`)){const{ok:k,error:G}=await c(O.id);I(k?{message:"Acesso revogado com sucesso.",type:"success"}:{message:G||"Falha ao revogar acesso.",type:"error"})}},P=O=>{var W;const k=(W=O.target.files)==null?void 0:W[0];if(!k||!a)return;const G=new FileReader;G.onload=async Z=>{var ne;try{const oe=new Uint8Array((ne=Z.target)==null?void 0:ne.result),re=XLSX.read(oe,{type:"array"}),Re=re.SheetNames[0],pe=re.Sheets[Re],tt=XLSX.utils.sheet_to_json(pe,{header:1});if(tt.length<2)throw new Error("A planilha está vazia ou em formato incorreto.");const Yt=tt[0].map(se=>se.toString().trim().toUpperCase()),jn=["NOME","RE","POSTO_GRAD","PELOTAO"];if(!jn.every(se=>Yt.includes(se)))throw new Error(`A planilha deve conter as colunas: ${jn.join(", ")}`);const $=tt.slice(1).map(se=>{var nt,Ct,We,Cn;const Ne={};return Yt.forEach((Et,de)=>{const He=Et.toLowerCase();Ne[He]=se[de]}),{nome:(nt=Ne.nome)==null?void 0:nt.toString().trim(),re:(Ct=Ne.re)==null?void 0:Ct.toString().trim(),postoGrad:(We=Ne.posto_grad)==null?void 0:We.toString().trim(),pelotao:(Cn=Ne.pelotao)==null?void 0:Cn.toString().trim(),ativo:!0}}).filter(se=>se.nome&&se.re&&se.postoGrad&&se.pelotao);if($.length===0)throw new Error("Nenhum registro válido encontrado na planilha.");await s($,a),I({message:`${$.length} policiais importados/atualizados!`,type:"success"})}catch(oe){I({message:oe.message||"Erro ao processar a planilha.",type:"error"})}finally{M.current&&(M.current.value="")}},G.readAsArrayBuffer(k)},F=()=>{var O;return(O=M.current)==null?void 0:O.click()};return i.jsxs("div",{className:"container mx-auto",children:[v&&i.jsx(Dj,{message:v.message,type:v.type}),i.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Gerenciar Policiais"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"file",ref:M,onChange:P,className:"hidden",accept:".xlsx, .xls"}),i.jsx("button",{onClick:F,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md",children:"Importar via Excel"}),i.jsx("button",{onClick:()=>b(),className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:"Adicionar Policial"})]})]}),i.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("input",{type:"text",name:"termo",placeholder:"Buscar por Nome ou RE...",value:L.termo,onChange:j,className:"w-full px-3 py-2 border rounded-md"}),i.jsxs("select",{name:"pelotao",value:L.pelotao,onChange:j,className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Todos os Grupos"}),_.map(O=>i.jsx("option",{value:O.nome,children:O.nome},O.id))]}),i.jsxs("select",{name:"ativo",value:L.ativo,onChange:j,className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Todos (Ativos e Inativos)"}),i.jsx("option",{value:"true",children:"Apenas Ativos"}),i.jsx("option",{value:"false",children:"Apenas Inativos"})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:i.jsxs("table",{className:"w-full text-sm text-left text-pm-gray-600",children:[i.jsx("thead",{className:"text-xs uppercase bg-pm-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3",children:"Nome / RE"}),i.jsx("th",{className:"px-6 py-3",children:"Posto/Grad"}),i.jsx("th",{className:"px-6 py-3",children:"Grupo"}),i.jsx("th",{className:"px-6 py-3",children:"Status"}),i.jsx("th",{className:"px-6 py-3",children:"Acesso ao Sistema"}),i.jsx("th",{className:"px-6 py-3 text-right",children:"Ações"})]})}),i.jsx("tbody",{children:y.map(O=>{const k=S.get(O.id);return i.jsxs("tr",{className:"bg-white border-b hover:bg-pm-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 font-medium",children:[O.nome,i.jsx("br",{}),i.jsx("span",{className:"text-xs text-pm-gray-500",children:O.re})]}),i.jsx("td",{className:"px-6 py-4",children:O.postoGrad}),i.jsx("td",{className:"px-6 py-4",children:O.pelotao}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${O.ativo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:O.ativo?"Ativo":"Inativo"})}),i.jsx("td",{className:"px-6 py-4",children:k&&k.acessoLiberado?i.jsx("span",{className:"text-green-700 font-semibold",children:k.role}):i.jsx("span",{className:"text-red-700",children:"Não"})}),i.jsxs("td",{className:"px-6 py-4 text-right space-x-2 whitespace-nowrap",children:[i.jsx("button",{onClick:()=>b(O),className:"font-medium text-pm-blue hover:underline",children:"Editar"}),k&&k.acessoLiberado?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>E(O,"reset"),className:"font-medium text-yellow-600 hover:underline",children:"Resetar Senha"}),i.jsx("button",{onClick:()=>Q(O),className:"font-medium text-red-600 hover:underline",children:"Revogar Acesso"})]}):i.jsx("button",{onClick:()=>E(O,"grant"),className:"font-medium text-green-600 hover:underline",children:"Conceder Acesso"})]})]},O.id)})})]})}),i.jsx(cn,{isOpen:u,onClose:()=>d(!1),title:m!=null&&m.id?"Editar Policial":"Adicionar Policial",children:m&&i.jsxs("form",{onSubmit:O=>{O.preventDefault(),T()},className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Nome Completo"}),i.jsx("input",{type:"text",value:m.nome||"",onChange:O=>f(k=>({...k,nome:O.target.value.toUpperCase()})),className:"mt-1 w-full border rounded-md p-2",required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"RE"}),i.jsx("input",{type:"text",value:m.re||"",onChange:O=>f(k=>({...k,re:O.target.value})),className:"mt-1 w-full border rounded-md p-2",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Posto/Grad"}),i.jsx("select",{value:m.postoGrad||"",onChange:O=>f(k=>({...k,postoGrad:O.target.value})),className:"mt-1 w-full border rounded-md p-2",required:!0,children:Fw.map(O=>i.jsx("option",{value:O,children:O},O))})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Grupo/Pelotão"}),i.jsxs("select",{value:m.pelotao||"",onChange:O=>f(k=>({...k,pelotao:O.target.value})),className:"mt-1 w-full border rounded-md p-2",required:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Selecione..."}),_.map(O=>i.jsx("option",{value:O.nome,children:O.nome},O.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Status"}),i.jsxs("select",{value:m.ativo?"true":"false",onChange:O=>f(k=>({...k,ativo:O.target.value==="true"})),className:"mt-1 w-full border rounded-md p-2",required:!0,children:[i.jsx("option",{value:"true",children:"Ativo"}),i.jsx("option",{value:"false",children:"Inativo"})]})]})]}),i.jsx("div",{className:"flex justify-end pt-4",children:i.jsx("button",{type:"submit",className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:"Salvar"})})]})}),i.jsx(kj,{isOpen:p,onClose:()=>w(!1),policial:D,mode:C})]})},Oj=({className:t})=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,width:"16",height:"16",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("polyline",{points:"6 9 12 15 18 9"})}),Sx=t=>{if(typeof t=="boolean")return t?"Sim":"Não";if(t==null)return"N/A";if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}/.test(t)){const e=new Date(t+"T00:00:00");if(!isNaN(e.getTime()))return e.toLocaleDateString("pt-BR")}return String(t)},Lj=t=>t.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()),Vj=({antesDepois:t})=>{if(!t||typeof t.antes!="object"||typeof t.depois!="object")return t&&(t.depois||t.antes)?i.jsxs("div",{className:"pt-2",children:[i.jsx("p",{className:"font-semibold mb-1 text-pm-gray-800",children:"Dados do Registro:"}),i.jsx("pre",{className:"p-2 bg-white rounded-md overflow-x-auto text-xs border border-pm-gray-200",children:JSON.stringify(t.depois||t.antes,null,2)})]}):null;const{antes:e,depois:n}=t,s=Array.from(new Set([...Object.keys(e||{}),...Object.keys(n||{})])).map(o=>({key:o,antes:e?e[o]:void 0,depois:n?n[o]:void 0})).filter(o=>JSON.stringify(o.antes)!==JSON.stringify(o.depois));return s.length===0?null:i.jsxs("div",{className:"pt-2",children:[i.jsx("p",{className:"font-semibold mb-2 text-pm-gray-800",children:"Dados da Alteração:"}),i.jsx("div",{className:"overflow-x-auto border border-pm-gray-200 rounded-md",children:i.jsxs("table",{className:"min-w-full bg-white text-sm",children:[i.jsx("thead",{className:"bg-pm-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-pm-gray-600 uppercase tracking-wider",children:"Campo Alterado"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-pm-gray-600 uppercase tracking-wider",children:"Valor Anterior"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-pm-gray-600 uppercase tracking-wider",children:"Novo Valor"})]})}),i.jsx("tbody",{className:"divide-y divide-pm-gray-200",children:s.map(({key:o,antes:a,depois:c})=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-medium text-pm-gray-800",children:Lj(o)}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:i.jsx("span",{className:"bg-red-100 text-red-800 p-1 rounded text-xs font-mono",children:Sx(a)})}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:i.jsx("span",{className:"bg-green-100 text-green-800 p-1 rounded text-xs font-mono",children:Sx(c)})})]},o))})]})})]})},Mj=()=>{const{users:t}=Fe(),[e,n]=N.useState({userId:"",dataInicio:"",dataFim:""}),[r,s]=N.useState(new Set),o=sj(e),[a,c]=N.useState(1),u=15;N.useEffect(()=>{c(1)},[e]);const d=Math.ceil(o.length/u),m=(a-1)*u,f=m+u,p=o.slice(m,f),w=x=>{n({...e,[x.target.name]:x.target.value})},C=x=>{s(v=>{const I=new Set(v);return I.has(x)?I.delete(x):I.add(x),I})},R=x=>{x>=1&&x<=d&&(c(x),s(new Set))},D=()=>i.jsxs("div",{className:"flex justify-center items-center space-x-4 p-4 border-t",children:[i.jsx("button",{onClick:()=>R(a-1),disabled:a===1,className:"px-4 py-2 text-sm font-medium text-pm-gray-700 bg-white border border-pm-gray-300 rounded-md hover:bg-pm-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),i.jsxs("span",{className:"text-sm text-pm-gray-700",children:["Página ",a," de ",d||1]}),i.jsx("button",{onClick:()=>R(a+1),disabled:a===d||d===0,className:"px-4 py-2 text-sm font-medium text-pm-gray-700 bg-white border border-pm-gray-300 rounded-md hover:bg-pm-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Próxima"})]});return i.jsxs("div",{className:"container mx-auto",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800 mb-6",children:"Histórico de Alterações"}),i.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("select",{name:"userId",value:e.userId,onChange:w,className:"w-full px-3 py-2 border border-pm-gray-300 rounded-md",children:[i.jsx("option",{value:"",children:"Todos os Usuários"}),t.map(x=>i.jsx("option",{value:x.id,children:x.nome},x.id))]}),i.jsx("input",{type:"date",name:"dataInicio",value:e.dataInicio,onChange:w,className:"w-full px-3 py-2 border border-pm-gray-300 rounded-md"}),i.jsx("input",{type:"date",name:"dataFim",value:e.dataFim,onChange:w,className:"w-full px-3 py-2 border border-pm-gray-300 rounded-md"})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[i.jsx("ul",{role:"list",className:"divide-y divide-gray-200",children:p.map(x=>{const v=r.has(x.id);return i.jsxs("li",{className:"p-4 sm:p-6",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-medium text-pm-blue truncate capitalize",children:x.evento.replace(/_/g," ").toLowerCase()}),i.jsx("p",{className:"hidden sm:block text-xs text-pm-gray-500",children:new Date(x.timestamp).toLocaleString("pt-BR")})]}),i.jsxs("div",{className:"mt-2 sm:flex sm:items-center",children:[i.jsxs("p",{className:"flex items-center text-sm text-pm-gray-500",children:[i.jsx("strong",{children:"Executor: "}),i.jsx("span",{className:"ml-1",children:x.actorNome})]}),x.nome&&i.jsxs("p",{className:"mt-1 flex items-center text-sm text-pm-gray-500 sm:mt-0 sm:ml-4",children:[i.jsx("strong",{children:"Policial: "}),i.jsxs("span",{className:"ml-1",children:[x.nome," (RE: ",x.re,")"]})]})]})]}),i.jsx("div",{className:"ml-4 flex-shrink-0",children:i.jsxs("button",{onClick:()=>C(x.id),className:"flex items-center text-sm font-medium text-pm-blue hover:text-pm-blue-dark",children:[i.jsxs("span",{children:[v?"Ocultar":"Ver"," Detalhes"]}),i.jsx(Oj,{className:`ml-1 transform transition-transform duration-200 ${v?"rotate-180":""}`})]})})]}),v&&i.jsx("div",{className:"mt-4 p-4 bg-pm-gray-50 rounded-md border border-pm-gray-200",children:i.jsxs("div",{className:"text-sm text-pm-gray-800 space-y-2",children:[x.dataOriginal&&i.jsxs("p",{children:[i.jsx("strong",{children:"Data Original:"})," ",new Date(x.dataOriginal+"T00:00:00").toLocaleDateString("pt-BR")]}),x.dataNova&&i.jsxs("p",{children:[i.jsx("strong",{children:"Data Nova:"})," ",new Date(x.dataNova+"T00:00:00").toLocaleDateString("pt-BR")]}),x.motivo&&i.jsxs("p",{children:[i.jsx("strong",{children:"Motivo/Parecer:"})," ",x.motivo]}),i.jsx(Vj,{antesDepois:x.antesDepois})]})})]},x.id)})}),o.length===0&&i.jsx("p",{className:"text-center p-4 text-pm-gray-500",children:"Nenhum registro de histórico encontrado."}),d>1&&i.jsx(D,{})]})]})},pr=({title:t,children:e,defaultOpen:n=!1})=>{const[r,s]=Nh.useState(n);return i.jsxs("div",{className:"mb-4 border-b border-pm-gray-200 last:border-b-0",children:[i.jsxs("button",{className:"w-full text-left py-4 flex justify-between items-center",onClick:()=>s(!r),"aria-expanded":r,children:[i.jsx("h2",{className:"text-xl font-semibold text-pm-gray-800",children:t}),i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transform transition-transform duration-300 ${r?"rotate-180":""}`,children:i.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),r&&i.jsx("div",{className:"pb-4 text-pm-gray-600 space-y-3",children:e})]})},Fj=()=>i.jsxs("div",{className:"container mx-auto",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800 mb-6",children:"SIGMA-E - Manual do Sistema"}),i.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md",children:[i.jsx(pr,{title:"Visão Geral",defaultOpen:!0,children:i.jsx("p",{children:"Bem-vindo ao SIGMA-E, o Sistema Integrado de Gestão, Monitoramento e Administração do Efetivo. Este manual foi criado para guiar você por todas as funcionalidades do sistema, garantindo que todos possam utilizá-lo de forma eficiente e correta."})}),i.jsxs(pr,{title:"Perfis de Acesso",children:[i.jsx("p",{children:"O sistema possui três níveis de acesso com diferentes permissões:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"ADMIN (Administrador):"})," Possui acesso total. Pode gerenciar policiais, usuários, créditos de folga, validar/reprovar todas as solicitações, agendar férias, criar eventos na agenda e gerar relatórios completos."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"SARGENTO (Sargento de Pelotão):"})," Gerencia as folgas do seu pelotão. Pode aprovar ou negar solicitações dos seus subordinados, que são então encaminhadas para o Admin. Também pode gerar relatórios do seu pelotão."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"SUBORDINADO (Policial):"})," Acesso focado em suas próprias informações. Pode solicitar (acionar) folgas, visualizar o status de suas solicitações, seu saldo de folgas e o calendário geral."]})]})]}),i.jsxs(pr,{title:"Gerenciamento de Folgas (Passo a Passo)",children:[i.jsx("h3",{className:"text-lg font-semibold text-pm-gray-700 mb-2",children:"1. Como Acionar uma Nova Folga"}),i.jsxs("p",{children:["Na página ",i.jsx("strong",{children:'"Gerenciar Folgas"'}),", clique no botão ",i.jsx("strong",{children:'"Acionar Folga"'}),"."]}),i.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[i.jsx("li",{children:"Se for Admin ou Sargento, selecione o policial para quem a folga será lançada. Se for Subordinado, seu nome já estará selecionado."}),i.jsx("li",{children:"Escolha a data desejada para a folga. O sistema não permite selecionar datas passadas."}),i.jsx("li",{children:"Seu saldo de folgas para o ano corrente é exibido no canto superior direito como referência."})]}),i.jsx("h3",{className:"text-lg font-semibold text-pm-gray-700 mt-4 mb-2",children:"2. Preenchendo o Motivo (Importante!)"}),i.jsx("p",{children:"É obrigatório selecionar um tipo de motivo para a folga. Cada tipo requer informações específicas:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4 mt-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Folga Cmt Geral:"})," Utilizada para folgas concedidas diretamente pelo Comandante Geral. Não requer detalhes adicionais."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Folga Cmt Cia:"})," Para folgas concedidas pelo Comando de Cia. É obrigatório descrever o motivo da concessão no campo de texto que aparecerá."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Folga Compensação:"})," Usada para compensar um serviço extra. Você deve preencher a ",i.jsx("strong",{children:"data"}),", ",i.jsx("strong",{children:"hora de início"})," e ",i.jsx("strong",{children:"hora de fim"})," do serviço que está sendo compensado. O número do BOPM é opcional, mas recomendado."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Folga Outros:"})," Para situações não cobertas pelas opções acima. É obrigatório fornecer uma justificativa detalhada."]})]}),i.jsx("h3",{className:"text-lg font-semibold text-pm-gray-700 mt-4 mb-2",children:"3. O Fluxo de Aprovação"}),i.jsx("p",{children:"Toda folga solicitada passa por um fluxo até ser validada e se tornar ativa:"}),i.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Subordinado solicita:"})," A folga é criada com o status ",i.jsx("strong",{children:'"Pendente Sgt."'})," e uma notificação é enviada ao Sargento do pelotão."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Sargento analisa:"})," O Sargento pode ",i.jsx("strong",{children:"Aprovar"})," ou ",i.jsx("strong",{children:"Negar"})," a solicitação. Se aprovada, o status muda para ",i.jsx("strong",{children:'"Aprovada Sgt."'})," e uma notificação é enviada aos Admins. Se negada, o processo termina."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Admin valida:"})," O Admin analisa a folga aprovada pelo Sargento. Se ele ",i.jsx("strong",{children:"Validar"}),", o status muda para ",i.jsx("strong",{children:'"Validada Adm."'}),", a folga se torna ",i.jsx("strong",{children:"ATIVA"})," e consome 1 crédito do saldo do policial. Se ele ",i.jsx("strong",{children:"Reprovar"}),", o processo termina."]})]}),i.jsx("h3",{className:"text-lg font-semibold text-pm-gray-700 mt-4 mb-2",children:"4. Trocando ou Excluindo uma Folga"}),i.jsxs("p",{children:["Apenas folgas com status ",i.jsx("strong",{children:'"ATIVA"'})," podem ser trocadas ou excluídas."]}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4 mt-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Trocar:"})," Altera a data de uma folga já validada. A data original é liberada."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Excluir:"})," Remove a folga do calendário. É necessário informar um motivo para a exclusão."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Restaurar (Apenas Admin):"})," O Admin tem a permissão de restaurar uma folga que foi trocada ou excluída, tornando-a ativa novamente."]})]})]}),i.jsxs(pr,{title:"Controle de Férias (Admin)",children:[i.jsx("p",{children:"Nesta página, o Administrador pode agendar os períodos de férias para todo o efetivo."}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[i.jsx("li",{children:"O sistema controla automaticamente o saldo de dias (15 ou 30) por ano de referência para cada policial."}),i.jsx("li",{children:"Ao agendar, o sistema verifica se há conflitos com folgas já ativas para o mesmo policial no período solicitado, evitando agendamentos sobrepostos."})]})]}),i.jsxs(pr,{title:"Calendário e Agenda",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Calendário Geral:"})," Oferece uma visão mensal de todos os eventos: folgas ativas, férias agendadas e eventos da agenda (cursos, operações, etc.). É uma ferramenta visual para planejamento e consulta rápida."]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Agenda (Admin):"})," Permite ao Admin criar eventos específicos, como Cursos, EAP, Operações, e escalar o efetivo necessário. Ao escalar um policial para um evento, ele recebe uma notificação. O sistema também impede que um policial seja escalado para um EAP ou Curso que já tenha participado, garantindo o rodízio do efetivo."]})]}),i.jsxs(pr,{title:"Funções de Administrador (Admin)",children:[i.jsx("p",{children:"O perfil de Admin possui acesso a áreas estratégicas do sistema:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Gerenciar Policiais:"})," Permite cadastrar, editar, inativar e excluir policiais do efetivo. Também é aqui que o Admin concede, reseta ou revoga o acesso de um usuário ao sistema. A importação em massa via planilha Excel também é feita nesta tela."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Créditos de Folga:"})," O Admin gerencia o saldo de folgas de todos os policiais, podendo adicionar ou remover créditos com justificativa (ex: concessão anual). A página também mostra um balanço completo do saldo de todo o efetivo."]})]})]}),i.jsxs(pr,{title:"Relatórios (Sargento e Admin)",children:[i.jsx("p",{children:"O sistema oferece ferramentas poderosas para extração de dados:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Relatório de Folgas:"})," Permite gerar uma planilha Excel (.xlsx) com todas as solicitações de folga dentro de um período, com filtros por pelotão. O arquivo inclui detalhes completos, como datas, status e pareceres."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Relatório EAP/Cursos:"})," Uma ferramenta crucial para o planejamento de cursos. Permite filtrar por tipo (EAP ou Curso) e pelotão, e exibe duas listas claras: quem já participou e quem está pendente. Esses dados também podem ser exportados para Excel."]})]})]}),i.jsxs(pr,{title:"Notificações",children:[i.jsx("p",{children:"O ícone de sino no canto superior do menu lateral exibe notificações em tempo real sobre eventos importantes relacionados a você. Por exemplo:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Sargentos"})," são notificados quando um subordinado solicita uma folga."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Admins"})," são notificados quando um sargento aprova uma folga."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Subordinados"})," são notificados sobre mudanças no status de suas folgas (aprovada, negada, etc.)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Qualquer policial"})," é notificado ao ser escalado para um evento na Agenda."]})]})]})]})]}),Bj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),i.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Uj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),i.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),i.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),i.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),$j=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),i.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),i.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),i.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"}),i.jsx("path",{d:"M8 14h.01"}),i.jsx("path",{d:"M12 14h.01"}),i.jsx("path",{d:"M16 14h.01"}),i.jsx("path",{d:"M8 18h.01"}),i.jsx("path",{d:"M12 18h.01"}),i.jsx("path",{d:"M16 18h.01"})]}),zj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"9",cy:"7",r:"4"}),i.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),i.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),Gj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M1 4v6h6"}),i.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),qj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),i.jsx("polyline",{points:"14 2 14 8 20 8"}),i.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),i.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),i.jsx("polyline",{points:"10 9 9 9 8 9"})]}),Wj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),i.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),Hj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),i.jsx("polyline",{points:"16 17 21 12 16 7"}),i.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),Qj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"12",cy:"8",r:"7"}),i.jsx("polyline",{points:"8.21 13.89 7 23 12 17 17 23 15.79 13.88"})]}),Kj=({className:t})=>i.jsx("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z"})}),Xj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),i.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),i.jsx("path",{d:"M12 11h4"}),i.jsx("path",{d:"M12 16h4"}),i.jsx("path",{d:"M8 11h.01"}),i.jsx("path",{d:"M8 16h.01"})]}),Yj=({className:t})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"9",cy:"7",r:"4"}),i.jsx("polyline",{points:"16 11 18 13 22 9"})]}),Jj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),i.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),Zj=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"10"}),i.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"4"}),i.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"16"})]}),Nx=({className:t})=>i.jsx("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("polyline",{points:"6 9 12 15 18 9"})}),eC=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),tC=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),i.jsx("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})]}),nC=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),i.jsx("polyline",{points:"14 2 14 8 20 8"}),i.jsx("path",{d:"M10 18.5v-4.5a1.5 1.5 0 0 1 3 0v4.5"}),i.jsx("path",{d:"M8 16h1.5a1.5 1.5 0 0 1 0 3H8l2 3"})]}),rC=({className:t})=>i.jsx("div",{className:`flex items-center justify-center ${t}`,children:i.jsx("svg",{viewBox:"0 0 80 88",className:"h-8 w-auto",children:i.jsxs("g",{children:[i.jsx("path",{d:"M40 0 L80 16 V56 C80 78 40 88 40 88 C40 88 0 78 0 56 V16 Z",fill:"#19398A"}),i.jsx("path",{d:"M40 4 L76 18.4 V54.8 C76 74.8 40 84 40 84 C40 84 4 74.8 4 54.8 V18.4 Z",strokeWidth:"3",stroke:"white",fill:"none"}),i.jsx("text",{x:"32",y:"62",fontFamily:"Verdana, sans-serif",fontSize:"42",fontWeight:"bold",fill:"white",textAnchor:"middle",children:"Σ"}),i.jsx("text",{x:"55",y:"48",fontFamily:"Verdana, sans-serif",fontSize:"22",fontWeight:"bold",fill:"white",children:"E"})]})})}),sC=({isOpen:t,onClose:e})=>{const{logout:n,role:r,currentUser:s}=be(),o=Yr(),a=ir(),c=()=>{n(),o("/login")},u=[{to:"/dashboard",label:"Página Inicial",icon:Bj,roles:["ADMIN","SARGENTO","SUBORDINADO"]},{to:"/calendario",label:"Calendário Geral",icon:Uj,roles:["ADMIN","SARGENTO","SUBORDINADO"]}],d=[{to:"/folgas",label:"Gerenciar Folgas",icon:$j,roles:["ADMIN","SARGENTO","SUBORDINADO"]},{to:"/ferias",label:"Controle de Férias",icon:Kj,roles:["ADMIN","SARGENTO","SUBORDINADO"]},{to:"/protocolo",label:"Protocolo de Docs",icon:nC,roles:["ADMIN","SARGENTO","SUBORDINADO"]},{to:"/policiais",label:"Gerenciar Policiais",icon:zj,roles:["ADMIN"]},{to:"/grupos",label:"Gerenciar Grupos",icon:tC,roles:["ADMIN"]},{to:"/creditos",label:"Créditos de Folga",icon:Qj,roles:["ADMIN"]},{to:"/historico",label:"Histórico",icon:Gj,roles:["ADMIN","SARGENTO"]},{to:"/relatorio",label:"Relatório de Folgas",icon:qj,roles:["ADMIN","SARGENTO"]}],m=[{to:"/relatorio-eap",label:"Relatório EAP/Cursos",icon:Yj,roles:["ADMIN","SARGENTO"]}],f=[{to:"/agenda",label:"Agenda",icon:Xj,roles:["ADMIN"]},{to:"/ajuda",label:"Ajuda",icon:Wj,roles:["ADMIN","SARGENTO","SUBORDINADO"]}],p=u.filter(y=>r&&y.roles.includes(r)),w=d.filter(y=>r&&y.roles.includes(r)),C=m.filter(y=>r&&y.roles.includes(r)),R=f.filter(y=>r&&y.roles.includes(r)),D=N.useMemo(()=>d.some(y=>a.pathname.startsWith(y.to)),[a.pathname]),[x,v]=N.useState(D),I=N.useMemo(()=>m.some(y=>a.pathname.startsWith(y.to)),[a.pathname]),[L,B]=N.useState(I),M=N.useMemo(()=>{switch(r){case"ADMIN":return{aside:"bg-pm-blue-dark",headerText:"text-white",headerBorder:"border-pm-blue-light",userText:"text-white",pelotaoText:"text-pm-gray-300",navLinkInactive:"text-pm-gray-100 hover:bg-pm-blue hover:text-white",navLinkActive:"bg-white text-pm-blue-dark font-semibold",logoutButton:"text-pm-gray-200 hover:bg-pm-blue hover:text-white"};case"SARGENTO":return{aside:"bg-pm-red-800",headerText:"text-white",headerBorder:"border-pm-red-600",userText:"text-white",pelotaoText:"text-pm-gray-300",navLinkInactive:"text-red-100 hover:bg-pm-red-700 hover:text-white",navLinkActive:"bg-white text-pm-red-800 font-semibold",logoutButton:"text-pm-gray-200 hover:bg-pm-red-700 hover:text-white"};case"SUBORDINADO":default:return{aside:"bg-pm-gray-900",headerText:"text-white",headerBorder:"border-b border-pm-gray-700",userText:"text-white",pelotaoText:"text-pm-gray-400",navLinkInactive:"text-pm-gray-200 hover:bg-pm-gray-700 hover:text-white",navLinkActive:"bg-white text-pm-gray-900 font-semibold",logoutButton:"text-pm-gray-300 hover:bg-pm-gray-700 hover:text-white"}}},[r]),S=({isActive:y})=>`flex items-center px-4 py-3 rounded-lg transition-colors duration-200 ${y?M.navLinkActive:M.navLinkInactive}`,_=({isActive:y})=>`flex items-center px-4 py-2.5 rounded-lg transition-colors duration-200 text-sm ${y?M.navLinkActive:M.navLinkInactive}`;return i.jsxs("aside",{className:`fixed inset-y-0 left-0 z-40 w-64 ${M.aside} shadow-lg flex flex-col transform transition-transform duration-300 ease-in-out md:relative md:translate-x-0 ${t?"translate-x-0":"-translate-x-full"}`,children:[i.jsxs("div",{className:`p-6 border-b ${M.headerBorder} relative`,children:[i.jsx("button",{onClick:e,className:`absolute top-4 right-4 p-1 rounded-full ${M.userText} md:hidden`,"aria-label":"Fechar menu",children:i.jsx(eC,{className:"h-6 w-6"})}),i.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[i.jsx(rC,{}),i.jsx("h1",{className:`text-2xl font-bold ${M.headerText}`,children:"SIGMA-E"})]}),s&&i.jsxs("div",{className:"text-center overflow-hidden",children:[i.jsxs("p",{className:`text-sm font-semibold ${M.userText} truncate`,children:[s.postoGrad&&`${s.postoGrad} `,s.nome]}),s.pelotao&&i.jsx("p",{className:`text-xs ${M.pelotaoText}`,children:s.pelotao})]})]}),i.jsxs("nav",{className:"flex-1 px-4 py-6 space-y-2 overflow-y-auto",children:[p.map(({to:y,label:j,icon:b})=>i.jsxs(Ka,{to:y,className:S,onClick:e,children:[i.jsx(b,{className:"h-6 w-6"}),i.jsx("span",{className:"ml-3",children:j})]},y)),w.length>0&&i.jsxs("div",{children:[i.jsxs("button",{onClick:()=>v(!x),className:`w-full flex items-center justify-between px-4 py-3 rounded-lg transition-colors duration-200 ${D?M.navLinkActive:M.navLinkInactive}`,"aria-expanded":x,children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Jj,{className:"h-6 w-6"}),i.jsx("span",{className:"ml-3 font-medium",children:"P-1"})]}),i.jsx(Nx,{className:`h-5 w-5 transform transition-transform duration-200 ${x?"rotate-180":""}`})]}),x&&i.jsx("div",{className:"pl-4 mt-2 space-y-1",children:w.map(({to:y,label:j,icon:b})=>i.jsxs(Ka,{to:y,className:_,onClick:e,children:[i.jsx(b,{className:"h-5 w-5"}),i.jsx("span",{className:"ml-3",children:j})]},y))})]}),C.length>0&&i.jsxs("div",{children:[i.jsxs("button",{onClick:()=>B(!L),className:`w-full flex items-center justify-between px-4 py-3 rounded-lg transition-colors duration-200 ${I?M.navLinkActive:M.navLinkInactive}`,"aria-expanded":L,children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Zj,{className:"h-6 w-6"}),i.jsx("span",{className:"ml-3 font-medium",children:"P-3"})]}),i.jsx(Nx,{className:`h-5 w-5 transform transition-transform duration-200 ${L?"rotate-180":""}`})]}),L&&i.jsx("div",{className:"pl-4 mt-2 space-y-1",children:C.map(({to:y,label:j,icon:b})=>i.jsxs(Ka,{to:y,className:_,onClick:e,children:[i.jsx(b,{className:"h-5 w-5"}),i.jsx("span",{className:"ml-3",children:j})]},y))})]}),R.map(({to:y,label:j,icon:b})=>i.jsxs(Ka,{to:y,className:S,onClick:e,children:[i.jsx(b,{className:"h-6 w-6"}),i.jsx("span",{className:"ml-3",children:j})]},y))]}),i.jsx("div",{className:`p-4 border-t ${M.headerBorder}`,children:i.jsxs("button",{onClick:c,className:`w-full flex items-center px-4 py-3 rounded-lg ${M.logoutButton} transition-colors duration-200`,children:[i.jsx(Hj,{className:"h-6 w-6"}),i.jsx("span",{className:"ml-3 font-medium",children:"Sair"})]})})]})},oC=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),i.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),iC={"/dashboard":"Página Inicial","/folgas":"Gerenciar Folgas","/ferias":"Controle de Férias","/calendario":"Calendário Geral","/protocolo":"Protocolo de Documentos","/agenda":"Agenda","/policiais":"Gerenciar Policiais","/grupos":"Gerenciar Grupos","/creditos":"Créditos de Folga","/historico":"Histórico","/relatorio":"Relatório de Folgas","/relatorio-eap":"Relatório EAP/Cursos","/ajuda":"Ajuda"},aC=()=>{const t=ir(),e=t.pathname.split("/").filter(n=>n);return t.pathname==="/dashboard"||t.pathname==="/"?null:i.jsx("nav",{"aria-label":"breadcrumb",className:"mb-6",children:i.jsxs("ol",{className:"flex items-center space-x-2 text-sm text-pm-gray-500",children:[i.jsx("li",{children:i.jsxs(Xi,{to:"/dashboard",className:"flex items-center hover:text-pm-blue transition-colors",children:[i.jsx(oC,{className:"h-4 w-4 mr-1.5 flex-shrink-0"}),"Página Inicial"]})}),e.map((n,r)=>{const s=`/${e.slice(0,r+1).join("/")}`,o=iC[s],a=r===e.length-1;return o?i.jsxs("li",{className:"flex items-center",children:[i.jsx("span",{className:"mx-2 text-pm-gray-400",children:"/"}),a?i.jsx("span",{className:"font-semibold text-pm-gray-700",children:o}):i.jsx(Xi,{to:s,className:"hover:text-pm-blue transition-colors",children:o})]},s):null})]})})},Xu=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),i.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),lC=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),i.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),i.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]}),cC=()=>{const{currentUser:t}=be(),{notificacoes:e,markNotificacoesAsRead:n}=Fe(),[r,s]=N.useState(!1),o=N.useRef(null),a=Yr(),c=N.useMemo(()=>t?e.filter(f=>f.policialId===t.id).sort((f,p)=>new Date(p.criadoEm).getTime()-new Date(f.criadoEm).getTime()):[],[e,t]),u=N.useMemo(()=>c.filter(f=>!f.lida).length,[c]),d=()=>{const f=!r;s(f),f&&u>0&&t&&n(t.id)},m=f=>{s(!1),f&&a(f)};return N.useEffect(()=>{function f(p){o.current&&!o.current.contains(p.target)&&s(!1)}return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[o]),i.jsxs("div",{className:"relative",ref:o,children:[i.jsxs("button",{onClick:d,className:"relative p-2 rounded-full text-pm-gray-600 hover:bg-white hover:text-pm-gray-800 transition-colors",children:[i.jsx(Xu,{className:"h-6 w-6"}),u>0&&i.jsx("span",{className:"absolute top-0 right-0 block h-5 w-5 rounded-full bg-pm-red-dark text-white text-xs flex items-center justify-center ring-2 ring-pm-gray-100",children:u>9?"9+":u})]}),r&&i.jsxs("div",{className:"absolute right-0 mt-2 w-[420px] max-w-[90vw] bg-white rounded-xl shadow-xl z-20 border border-pm-gray-200 text-pm-gray-800",children:[i.jsxs("div",{className:"p-4 font-bold text-lg border-b border-pm-gray-200 flex items-center gap-3",children:[i.jsx(Xu,{className:"h-6 w-6 text-pm-gray-500"}),"Notificações"]}),i.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:c.length>0?i.jsx("ul",{className:"divide-y divide-pm-gray-100",children:c.map(f=>i.jsx("li",{children:i.jsx("button",{onClick:()=>m(f.link),className:`w-full text-left p-4 transition-colors duration-150 group ${f.link?"hover:bg-pm-gray-50":"cursor-default"}`,disabled:!f.link,children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"w-3 flex-shrink-0 pt-1.5",children:!f.lida&&i.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-pm-blue ring-4 ring-pm-blue-light/20","aria-label":"Não lida"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-base leading-relaxed text-pm-gray-800 group-hover:text-pm-gray-900",children:f.mensagem}),i.jsx("p",{className:"text-sm text-pm-gray-500 mt-2",children:new Date(f.criadoEm).toLocaleString("pt-BR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})})},f.id))}):i.jsxs("div",{className:"text-center p-12",children:[i.jsx(Xu,{className:"mx-auto h-16 w-16 text-pm-gray-200"}),i.jsx("p",{className:"mt-5 text-lg font-semibold text-pm-gray-700",children:"Tudo em dia!"}),i.jsx("p",{className:"mt-1 text-base text-pm-gray-500",children:"Você não tem novas notificações."})]})})]})]})},uC=()=>{const{currentUser:t}=be(),[e,n]=N.useState(!1);return i.jsxs("div",{className:"flex h-screen bg-pm-gray-100",children:[e&&i.jsx("div",{onClick:()=>n(!1),className:"fixed inset-0 bg-black/50 z-30 md:hidden","aria-hidden":"true"}),i.jsx(sC,{isOpen:e,onClose:()=>n(!1)}),i.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[i.jsxs("header",{className:"flex-shrink-0 w-full flex justify-between md:justify-end items-center py-4 px-4 sm:px-8 z-20",children:[i.jsx("button",{className:"text-pm-gray-600 md:hidden",onClick:()=>n(!0),"aria-label":"Abrir menu",children:i.jsx(lC,{className:"h-6 w-6"})}),t&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-semibold text-pm-gray-700 hidden sm:inline",children:"Notificações"}),i.jsx(cC,{})]})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto px-4 sm:px-8 pb-8",children:[i.jsx(aC,{}),i.jsx(b2,{})]})]})]})},dC=({className:t="h-5 w-5"})=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:i.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20v2H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v15H6.5A2.5 2.5 0 0 1 4 4.5z"})}),hC=({className:t="h-5 w-5"})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("circle",{cx:"12",cy:"12",r:"6"}),i.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),fC=({className:t="h-5 w-5"})=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:i.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),mC=({className:t="h-5 w-5"})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("circle",{cx:"12",cy:"8",r:"7"}),i.jsx("polyline",{points:"8.21 13.89 7 23 12 17 17 23 15.79 13.88"})]}),pC=({className:t="h-5 w-5"})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("circle",{cx:"12",cy:"12",r:"1"}),i.jsx("circle",{cx:"19",cy:"12",r:"1"}),i.jsx("circle",{cx:"5",cy:"12",r:"1"})]}),gC=({className:t})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),i.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),i.jsx("path",{d:"M12 11h4"}),i.jsx("path",{d:"M12 16h4"}),i.jsx("path",{d:"M8 11h.01"}),i.jsx("path",{d:"M8 16h.01"})]}),xC=({className:t})=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:i.jsx("path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z"})}),yC=({className:t})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),i.jsx("polyline",{points:"17 11 19 13 23 9"})]}),Ix={[ve.CURSO]:{icon:dC,style:"bg-indigo-500 text-white"},[ve.EAP]:{icon:hC,style:"bg-purple-500 text-white"},[ve.OPERACAO]:{icon:fC,style:"bg-red-500 text-white"},[ve.LICENCA_PREMIO]:{icon:mC,style:"bg-teal-500 text-white"},[ve.OUTRO]:{icon:pC,style:"bg-gray-500 text-white"}},vC=()=>{const{policiais:t}=Fe(),{folgasAtivasPorDia:e,feriasPorDia:n,eventosAgendaPorDia:r}=rj(),[s,o]=N.useState(new Date),[a,c]=N.useState(null),[u,d]=N.useState(!1),m=N.useMemo(()=>({...vs,FOLGA:"Folgas",FERIAS:"Férias"}),[]),f=N.useMemo(()=>({...bi,FOLGA:"bg-pm-blue text-white",FERIAS:"bg-green-500 text-white"}),[]),[p,w]=N.useState(Object.keys(m).reduce((y,j)=>({...y,[j]:!0}),{})),C=y=>{w(j=>({...j,[y]:!j[y]}))},R=N.useMemo(()=>new Map(t.map(y=>[y.id,y])),[t]),D=y=>y.toISOString().split("T")[0],x=N.useMemo(()=>{const y=s.getFullYear(),j=s.getMonth(),b=new Date(y,j,1),T=new Date(y,j+1,0),E=[],Q=b.getDay();for(let P=0;P<Q;P++)E.push(null);for(let P=1;P<=T.getDate();P++)E.push(new Date(y,j,P));return E},[s]),v=()=>{o(new Date(s.getFullYear(),s.getMonth()-1,1))},I=()=>{o(new Date(s.getFullYear(),s.getMonth()+1,1))},L=y=>{c(y),d(!0)},B=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],M=a&&p.FOLGA?e.get(D(a))||[]:[],S=a&&p.FERIAS?n.get(D(a))||[]:[],_=a?(r.get(D(a))||[]).filter(y=>p[y.tipo]):[];return i.jsxs("div",{className:"container mx-auto",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800 mb-6",children:"Calendário Geral"}),i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:v,className:"p-2 rounded-full hover:bg-pm-gray-100 transition-colors",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("polyline",{points:"15 18 9 12 15 6"})})}),i.jsx("h2",{className:"text-xl font-semibold capitalize text-pm-gray-700 text-center",children:s.toLocaleString("pt-BR",{month:"long",year:"numeric"})}),i.jsx("button",{onClick:I,className:"p-2 rounded-full hover:bg-pm-gray-100 transition-colors",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),i.jsxs("div",{className:"p-4 mb-4 bg-pm-gray-50 rounded-lg border",children:[i.jsx("h3",{className:"text-sm font-semibold text-pm-gray-600 mb-3",children:"Filtros de Exibição:"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(m).map(([y,j])=>{const b=p[y],T=f[y]||"bg-gray-200 text-gray-800";return i.jsxs("button",{onClick:()=>C(y),className:`px-3 py-1.5 text-xs font-semibold rounded-full transition-all duration-200 flex items-center gap-2 ${b?`${T} shadow-sm`:"bg-pm-gray-200 text-pm-gray-600 hover:bg-pm-gray-300"}`,children:[i.jsx("span",{className:`w-2.5 h-2.5 rounded-full border-2 ${b?"bg-white border-white/50":"bg-transparent border-current"}`}),j]},y)})})]}),i.jsx("div",{className:"grid grid-cols-7 gap-2 text-center font-medium text-pm-gray-500 border-b pb-2 mb-2",children:B.map(y=>i.jsx("div",{className:"py-2 text-xs sm:text-base","aria-hidden":"true",children:y},y))}),i.jsx("div",{className:"grid grid-cols-7 gap-1 md:gap-2",children:x.map((y,j)=>{if(!y)return i.jsx("div",{},`empty-${j}`);const b=D(y),T=p.FOLGA?e.get(b)||[]:[],E=p.FERIAS?n.get(b)||[]:[],Q=(r.get(b)||[]).filter(G=>p[G.tipo]),P=Array.from(new Set(Q.map(G=>G.tipo))),F=D(new Date)===b,O=T.length>0||E.length>0||Q.length>0;let k="h-24 w-full text-left p-1 md:p-2 rounded-lg relative transition-colors duration-200 flex flex-col justify-between group";return O?k+=" cursor-pointer":k+=" cursor-default",F?k+=" bg-pm-blue text-white":E.length>0?k+=" bg-green-100 hover:bg-green-200":T.length>0?k+=" bg-pm-gray-50 hover:bg-pm-blue-light hover:text-white":Q.length>0?k+=" bg-pm-gray-50 hover:bg-pm-gray-100":k+=" bg-pm-gray-50 text-pm-gray-400",i.jsxs("button",{onClick:()=>O&&L(y),disabled:!O,className:k,"aria-label":O?`Ver eventos do dia ${y.getDate()}`:`Dia ${y.getDate()}, sem eventos`,children:[i.jsx("span",{className:`font-medium text-sm md:text-base ${F?"":E.length>0?"text-green-900":O?"text-pm-gray-800":""} ${T.length>0?"group-hover:text-white":""}`,children:y.getDate()}),i.jsxs("div",{className:"flex-grow flex items-end justify-end flex-wrap-reverse gap-1",children:[P.map(G=>{const{icon:W,style:Z}=Ix[G],ne=Q.filter(re=>re.tipo===G).length,oe=`${ne} ${vs[G]}${ne>1?"s":""}`;return i.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center font-bold border-2 border-white ${Z}`,title:oe,children:i.jsx(W,{className:"h-4 w-4"})},G)}),E.length>0&&i.jsx("span",{className:"text-xs w-6 h-6 rounded-full flex items-center justify-center font-bold border-2 bg-green-500 text-white border-white",title:`${E.length} policiais de férias`,children:E.length}),T.length>0&&i.jsx("span",{className:`text-xs w-6 h-6 rounded-full flex items-center justify-center font-bold border-2 ${F?"bg-white text-pm-blue border-white":"bg-pm-blue text-white border-white group-hover:border-pm-blue-light"}`,title:`${T.length} policiais de folga`,children:T.length})]})]},b)})})]}),i.jsx(cn,{isOpen:u,onClose:()=>d(!1),title:`Eventos de ${a==null?void 0:a.toLocaleDateString("pt-BR")}`,children:i.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[_.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-pm-gray-800 mb-3 border-b pb-2 flex items-center gap-2",children:[i.jsx(gC,{className:"h-5 w-5 text-pm-gray-500"}),"Eventos Agendados"]}),i.jsx("ul",{className:"space-y-3",children:_.map(y=>{const j=Ix[y.tipo].icon,b=bi[y.tipo].split(" "),T=b.find(Q=>Q.startsWith("bg-"))||"bg-pm-gray-100",E=b.find(Q=>Q.startsWith("text-"))||"text-pm-gray-800";return i.jsxs("li",{className:"p-3 bg-pm-gray-50 rounded-md border border-pm-gray-200",children:[i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${T}`,children:i.jsx("div",{className:E,children:i.jsx(j,{className:"h-5 w-5"})})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("p",{className:"font-semibold text-pm-gray-900",children:y.titulo}),i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${bi[y.tipo]}`,children:vs[y.tipo]})]}),i.jsxs("p",{className:"text-sm text-pm-gray-600",children:[i.jsx("strong",{children:"Horário:"})," ",y.horaInicio," às ",y.horaFim]}),i.jsxs("p",{className:"text-sm text-pm-gray-600",children:[i.jsx("strong",{children:"Local:"})," ",y.local]})]})]}),y.observacoes&&i.jsxs("p",{className:"text-xs mt-2 pt-2 border-t border-pm-gray-200 text-pm-gray-600",children:[i.jsx("strong",{children:"Obs:"})," ",y.observacoes]}),y.policiaisIds.length>0&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-pm-gray-200",children:[i.jsx("h4",{className:"text-sm font-semibold text-pm-gray-800 mb-2",children:"Efetivo Escalado:"}),i.jsx("ul",{className:"space-y-1",children:y.policiaisIds.map(Q=>{const P=R.get(Q);return P?i.jsxs("li",{className:"flex justify-between items-center text-sm text-pm-gray-900 bg-white p-1.5 rounded border",children:[i.jsxs("span",{children:[P.postoGrad," ",P.nome]}),i.jsx("span",{className:"font-mono text-xs bg-pm-gray-200 text-pm-gray-800 px-2 py-0.5 rounded-full",children:P.re})]},Q):null})})]})]},y.id)})})]}),S.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-pm-gray-800 mb-3 border-b pb-2 flex items-center gap-2",children:[i.jsx(xC,{className:"h-5 w-5 text-pm-gray-500"}),"Férias Agendadas"]}),i.jsx("ul",{className:"space-y-2",children:S.map(y=>{const j=R.get(y.policialId);return i.jsxs("li",{className:"p-3 bg-white rounded-md border border-green-200 shadow-sm",children:[i.jsxs("p",{className:"font-semibold text-green-900",children:[j==null?void 0:j.postoGrad," ",y.nome]}),i.jsxs("p",{className:"text-sm text-green-700",children:["RE: ",y.re," - Pelotão: ",y.pelotao]})]},y.id)})})]}),M.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-pm-gray-800 mb-3 border-b pb-2 flex items-center gap-2",children:[i.jsx(yC,{className:"h-5 w-5 text-pm-gray-500"}),"Folgas Ativas"]}),i.jsx("ul",{className:"space-y-2",children:M.map(y=>{const j=R.get(y.policialld);return i.jsxs("li",{className:"p-3 bg-white rounded-md border border-blue-200 shadow-sm",children:[i.jsxs("p",{className:"font-semibold text-pm-gray-800",children:[j==null?void 0:j.postoGrad," ",y.nome]}),i.jsxs("p",{className:"text-sm text-pm-gray-500",children:["RE: ",y.re," - Pelotão: ",y.pelotao]})]},y.folgald)})})]}),S.length===0&&M.length===0&&_.length===0&&i.jsx("p",{className:"text-pm-gray-600 text-center py-4",children:"Nenhum evento para este dia."})]})})]})},wC=({className:t})=>i.jsxs("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),i.jsx("polyline",{points:"14 2 14 8 20 8"}),i.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),i.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),i.jsx("polyline",{points:"10 9 9 9 8 9"})]}),_C=()=>{const{folgas:t,users:e,grupos:n}=Fe(),{currentUser:r,role:s}=be(),o=new Date,a=new Date(o.getFullYear(),o.getMonth(),1).toISOString().split("T")[0],c=new Date(o.getFullYear(),o.getMonth()+1,0).toISOString().split("T")[0],[u,d]=N.useState({dataInicio:a,dataFim:c,pelotao:s==="SARGENTO"&&(r==null?void 0:r.pelotao)||""}),m=x=>{const{name:v,value:I}=x.target;d(L=>({...L,[v]:I}))},f=N.useMemo(()=>[...n].sort((x,v)=>x.nome.localeCompare(v.nome)),[n]),p=N.useMemo(()=>t.filter(x=>{const v=new Date(x.data+"T00:00:00"),I=(!u.dataInicio||v>=new Date(u.dataInicio+"T00:00:00"))&&(!u.dataFim||v<=new Date(u.dataFim+"T00:00:00")),L=!u.pelotao||x.pelotao===u.pelotao,B=s!=="SARGENTO"||x.pelotao===(r==null?void 0:r.pelotao);return I&&L&&B}).sort((x,v)=>new Date(x.data).getTime()-new Date(v.data).getTime()),[t,u,s,r]),w=x=>{switch(x.status){case we.TROCADA:return{text:`Trocada para ${x.trocadaPara?new Date(x.trocadaPara+"T00:00:00").toLocaleDateString("pt-BR"):"N/D"}`,color:"bg-yellow-100 text-yellow-800"};case we.EXCLUIDA:return{text:"Excluída",color:"bg-red-100 text-red-800"};case we.CANCELADA:return{text:"Cancelada/Reprovada",color:"bg-gray-200 text-gray-800"};case we.ATIVA:if(x.aprovacao===le.VALIDADA_ADMIN)return{text:"Usufruída",color:"bg-green-100 text-green-800"};break}switch(x.aprovacao){case le.NEGADA_SARGENTO:return{text:"Negada pelo Sargento",color:"bg-orange-100 text-orange-800"};case le.REPROVADA_ADMIN:return{text:"Reprovada pelo Admin",color:"bg-red-100 text-red-800"};default:return{text:"Pendente",color:"bg-blue-100 text-blue-800"}}},C=x=>{if(!x)return"N/A";const v=e.find(I=>I.id===x);return v?v.nome:"Desconhecido"},R=()=>{if(p.length===0)return;const x=u.dataInicio?new Date(u.dataInicio+"T00:00:00").toLocaleDateString("pt-BR"):"N/A",v=u.dataFim?new Date(u.dataFim+"T00:00:00").toLocaleDateString("pt-BR"):"N/A",I=`Relatório de Folgas - De ${x} a ${v} - Pelotão: ${u.pelotao||"Todos"}`,L=["Policial","RE","Pelotão","Data da Folga","Data da Solicitação","Situação Final","Motivo Solicitação","Parecer Sargento","Parecer Admin"],B=p.map(b=>{const T=w(b);return[b.nome,b.re,b.pelotao,new Date(b.data+"T00:00:00").toLocaleDateString("pt-BR"),new Date(b.criadoEm).toLocaleString("pt-BR"),T.text,b.motivo||"",b.sargentoParecer||"",b.adminParecer||""]}),M=[[I],[],L,...B],S=XLSX.utils.aoa_to_sheet(M),_=L.map((b,T)=>({wch:Math.max(...M.map(E=>E[T]?String(E[T]).length:0))+2}));S["!cols"]=_,S["!merges"]=[{s:{r:0,c:0},e:{r:0,c:L.length-1}}],S.A1&&(S.A1.s={font:{sz:14,bold:!0},alignment:{horizontal:"center"}}),L.forEach((b,T)=>{const E=XLSX.utils.encode_cell({r:2,c:T});S[E]&&(S[E].s={font:{bold:!0}})});const y=XLSX.utils.book_new();XLSX.utils.book_append_sheet(y,S,"Relatório de Folgas");const j=`relatorio_folgas_${u.dataInicio}_a_${u.dataFim}_${u.pelotao||"todos"}.xlsx`;XLSX.writeFile(y,j)},D=N.useMemo(()=>{const x=p.filter(L=>L.status===we.ATIVA&&L.aprovacao===le.VALIDADA_ADMIN).length,v=p.filter(L=>L.status===we.TROCADA).length,I=p.filter(L=>L.status===we.EXCLUIDA).length;return{total:p.length,usufruidas:x,trocadas:v,excluidas:I}},[p]);return i.jsxs("div",{className:"container mx-auto",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-2",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Relatório de Folgas"}),i.jsxs("button",{onClick:R,disabled:p.length===0,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md flex items-center disabled:bg-green-300 disabled:cursor-not-allowed",children:[i.jsx(wC,{className:"mr-2 h-5 w-5"})," Exportar Excel"]})]}),i.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"dataInicio",className:"block text-sm font-medium text-pm-gray-700",children:"De:"}),i.jsx("input",{id:"dataInicio",name:"dataInicio",type:"date",value:u.dataInicio,onChange:m,className:"mt-1 block w-full pl-3 pr-2 py-2 text-base border-pm-gray-300 focus:outline-none focus:ring-pm-blue focus:border-pm-blue sm:text-sm rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"dataFim",className:"block text-sm font-medium text-pm-gray-700",children:"Até:"}),i.jsx("input",{id:"dataFim",name:"dataFim",type:"date",value:u.dataFim,onChange:m,className:"mt-1 block w-full pl-3 pr-2 py-2 text-base border-pm-gray-300 focus:outline-none focus:ring-pm-blue focus:border-pm-blue sm:text-sm rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"pelotao",className:"block text-sm font-medium text-pm-gray-700",children:"Grupo/Pelotão"}),i.jsxs("select",{id:"pelotao",name:"pelotao",value:u.pelotao,onChange:m,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-pm-gray-300 focus:outline-none focus:ring-pm-blue focus:border-pm-blue sm:text-sm rounded-md",disabled:s==="SARGENTO",children:[i.jsx("option",{value:"",children:"Todos os Grupos"}),f.map(x=>i.jsx("option",{value:x.nome,children:x.nome},x.id))]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[i.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[i.jsx("p",{className:"text-sm text-pm-gray-500",children:"Total de Solicitações"}),i.jsx("p",{className:"text-2xl font-bold",children:D.total})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[i.jsx("p",{className:"text-sm text-pm-gray-500",children:"Folgas Usufruídas"}),i.jsx("p",{className:"text-2xl font-bold text-green-600",children:D.usufruidas})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[i.jsx("p",{className:"text-sm text-pm-gray-500",children:"Folgas Trocadas"}),i.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:D.trocadas})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[i.jsx("p",{className:"text-sm text-pm-gray-500",children:"Folgas Excluídas"}),i.jsx("p",{className:"text-2xl font-bold text-red-600",children:D.excluidas})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:[i.jsxs("table",{className:"w-full text-sm text-left text-pm-gray-600",children:[i.jsx("thead",{className:"text-xs text-pm-gray-700 uppercase bg-pm-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Policial"}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Data Folga"}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Data Solicitação"}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Situação Final"}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Detalhes"})]})}),i.jsx("tbody",{children:p.map(x=>{const v=w(x);return i.jsxs("tr",{className:"bg-white border-b hover:bg-pm-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 font-medium text-pm-gray-900",children:[x.nome,i.jsx("br",{}),i.jsxs("span",{className:"text-xs text-pm-gray-500",children:["RE: ",x.re," | ",x.pelotao]})]}),i.jsx("td",{className:"px-6 py-4",children:new Date(x.data+"T00:00:00").toLocaleDateString("pt-BR")}),i.jsx("td",{className:"px-6 py-4",children:new Date(x.criadoEm).toLocaleString("pt-BR")}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${v.color}`,children:v.text})}),i.jsxs("td",{className:"px-6 py-4 text-xs",children:[x.motivo&&i.jsxs("div",{children:[i.jsx("strong",{children:"Motivo:"})," ",x.motivo]}),x.sargentoParecer&&i.jsxs("div",{children:[i.jsxs("strong",{children:["Sgt (",C(x.sargentold),"):"]})," ",x.sargentoParecer]}),x.adminParecer&&i.jsxs("div",{children:[i.jsxs("strong",{children:["Adm (",C(x.adminld),"):"]})," ",x.adminParecer]})]})]},x.folgald)})})]}),p.length===0&&i.jsx("p",{className:"text-center p-4 text-pm-gray-500",children:"Nenhum registro encontrado para os filtros selecionados."})]})]})},EC=({message:t,type:e="success"})=>{const n=e==="success"?"bg-green-600":"bg-red-600";return i.jsxs("div",{className:`fixed top-20 right-8 text-white py-3 px-5 rounded-lg shadow-xl z-50 flex items-center ${n}`,role:"alert","aria-live":"assertive",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M12 16v-4"}),i.jsx("path",{d:"M12 8h.01"})]}),i.jsx("span",{children:t})]})},AC=()=>{const{leaveLedger:t,policiais:e,adminAddLeaveCredits:n,grupos:r}=Fe(),{currentUser:s}=be(),[o,a]=N.useState(!1),[c,u]=N.useState("add"),[d,m]=N.useState({policialId:"",year:new Date().getFullYear(),delta:1,reason:""}),[f,p]=N.useState(null),[w,C]=N.useState(""),R=new Date().getFullYear(),[D,x]=N.useState(R),[v,I]=N.useState(""),[L,B]=N.useState(""),M=oj({yearFilter:D,pelotaoFilter:v,searchFilter:L}),S=N.useMemo(()=>[...r].sort((P,F)=>P.nome.localeCompare(F.nome)),[r]);N.useEffect(()=>{if(f){const P=setTimeout(()=>p(null),3e3);return()=>clearTimeout(P)}},[f]);const _=N.useMemo(()=>new Map(e.map(P=>[P.id,P])),[e]),y=N.useMemo(()=>[...t].sort((P,F)=>new Date(F.createdAt).getTime()-new Date(P.createdAt).getTime()),[t]),j=N.useMemo(()=>Array.from(new Set([...t.map(P=>P.year),R])).sort((P,F)=>F-P),[t,R]),b=N.useMemo(()=>{if(!w.trim())return e.filter(F=>F.ativo).sort((F,O)=>F.nome.localeCompare(O.nome));const P=w.toLowerCase();return e.filter(F=>F.ativo&&(F.re.toLowerCase().includes(P)||F.nome.toLowerCase().includes(P)||F.pelotao.toLowerCase().includes(P)))},[e,w]),T=P=>{u(P),m({policialId:"",year:new Date().getFullYear(),delta:P==="add"?1:-1,reason:""}),C(""),a(!0)},E=async()=>{if(!s)return;const{policialId:P,year:F,delta:O,reason:k}=d;if(!P){p({message:"Selecione um policial.",type:"error"});return}if(!Number.isFinite(O)||O===0){p({message:"Valor inválido.",type:"error"});return}if(c==="add"&&O<1){p({message:"Valor deve ser positivo.",type:"error"});return}if(c==="remove"&&O>-1){p({message:"Valor deve ser negativo.",type:"error"});return}try{await n({policialId:Number(P),year:F,delta:O,reason:k},s),p({message:"Operação realizada com sucesso!",type:"success"}),a(!1)}catch(G){p({message:G.message||"Falha ao realizar a operação.",type:"error"})}},Q=P=>{const{name:F,value:O}=P.target;m(k=>({...k,[F]:F==="year"||F==="delta"?Number(O):O}))};return i.jsxs("div",{className:"container mx-auto",children:[f&&i.jsx(EC,{message:f.message,type:f.type}),i.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-2",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Auditoria de Créditos de Folga"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>T("add"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md flex items-center",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[i.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),i.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Adicionar"]}),i.jsxs("button",{onClick:()=>T("remove"),className:"bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-md flex items-center",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:i.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})}),"Remover"]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:[i.jsxs("table",{className:"w-full text-sm text-left text-pm-gray-600",children:[i.jsx("thead",{className:"text-xs text-pm-gray-700 uppercase bg-pm-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Data"}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Policial"}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Ano Ref."}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Δ"}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Motivo"}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Lançado Por"})]})}),i.jsx("tbody",{children:y.map(P=>{const F=_.get(P.policialId);return i.jsxs("tr",{className:"bg-white border-b hover:bg-pm-gray-50",children:[i.jsx("td",{className:"px-6 py-4",children:new Date(P.createdAt).toLocaleString("pt-BR")}),i.jsxs("td",{className:"px-6 py-4 font-medium",children:[F?`${F.postoGrad} ${F.nome}`:`ID: ${P.policialId}`,i.jsx("br",{}),i.jsxs("span",{className:"text-xs text-pm-gray-500",children:["RE: ",(F==null?void 0:F.re)||"N/A"]})]}),i.jsx("td",{className:"px-6 py-4",children:P.year}),i.jsx("td",{className:`px-6 py-4 font-bold ${P.delta>0?"text-green-600":"text-red-600"}`,children:P.delta>0?`+${P.delta}`:P.delta}),i.jsx("td",{className:"px-6 py-4",children:P.reason||"-"}),i.jsx("td",{className:"px-6 py-4",children:P.createdByNome})]},P.id)})})]}),y.length===0&&i.jsx("p",{className:"text-center p-4 text-pm-gray-500",children:"Nenhum lançamento encontrado."})]}),i.jsxs("div",{className:"mt-10",children:[i.jsx("h2",{className:"text-2xl font-bold text-pm-gray-800 mb-4",children:"Saldo de Folgas do Efetivo"}),i.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("input",{type:"text",placeholder:"Buscar por Nome ou RE...",value:L,onChange:P=>B(P.target.value),className:"w-full px-3 py-2 border rounded-md"}),i.jsxs("select",{value:v,onChange:P=>I(P.target.value),className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Todos os Grupos"}),S.map(P=>i.jsx("option",{value:P.nome,children:P.nome},P.id))]}),i.jsx("select",{value:D,onChange:P=>x(Number(P.target.value)),className:"w-full px-3 py-2 border rounded-md",children:j.map(P=>i.jsxs("option",{value:P,children:["Ano de ",P]},P))})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:[i.jsxs("table",{className:"w-full text-sm text-left text-pm-gray-600",children:[i.jsx("thead",{className:"text-xs uppercase bg-pm-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3",children:"Policial"}),i.jsx("th",{className:"px-6 py-3",children:"Grupo"}),i.jsx("th",{className:"px-6 py-3 text-center",children:"Créditos"}),i.jsx("th",{className:"px-6 py-3 text-center",children:"Usadas"}),i.jsx("th",{className:"px-6 py-3 text-center",children:"Saldo"})]})}),i.jsx("tbody",{children:M.map(P=>i.jsxs("tr",{className:"bg-white border-b hover:bg-pm-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 font-medium",children:[P.postoGrad," ",P.nome,i.jsx("br",{}),i.jsxs("span",{className:"text-xs text-pm-gray-500",children:["RE: ",P.re]})]}),i.jsx("td",{className:"px-6 py-4",children:P.pelotao}),i.jsx("td",{className:"px-6 py-4 text-center font-medium text-blue-600",children:P.creditos}),i.jsx("td",{className:"px-6 py-4 text-center font-medium text-orange-600",children:P.usadas}),i.jsx("td",{className:`px-6 py-4 text-center font-bold text-lg ${P.saldo>0?"text-green-600":"text-red-600"}`,children:P.saldo})]},P.id))})]}),M.length===0&&i.jsx("p",{className:"text-center p-4 text-pm-gray-500",children:"Nenhum policial encontrado."})]})]}),i.jsx(cn,{isOpen:o,onClose:()=>a(!1),title:c==="add"?"Adicionar Créditos":"Remover/Ajustar Créditos",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Policial"}),i.jsx("input",{type:"text",placeholder:"Buscar...",value:w,onChange:P=>C(P.target.value),className:"mb-2 mt-1 w-full border rounded-md p-2"}),i.jsxs("select",{name:"policialId",value:d.policialId,onChange:Q,className:"mt-1 w-full border rounded-md p-2",required:!0,size:b.length>5?5:Math.max(2,b.length+1),children:[i.jsx("option",{value:"",children:"Selecione..."}),b.map(P=>i.jsxs("option",{value:P.id,children:[P.postoGrad," ",P.re," ",P.nome," (",P.pelotao,")"]},P.id))]}),b.length===0&&i.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Nenhum policial encontrado."})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Ano Ref."}),i.jsx("input",{type:"number",name:"year",value:d.year,onChange:Q,className:"mt-1 w-full border rounded-md p-2",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:c==="add"?"Créditos a Adicionar":"Créditos a Remover"}),i.jsx("input",{type:"number",name:"delta",value:d.delta,onChange:Q,className:"mt-1 w-full border rounded-md p-2",required:!0,step:"1",min:c==="add"?1:void 0,max:c==="remove"?-1:void 0}),i.jsx("p",{className:"text-xs text-pm-gray-500 mt-1",children:c==="add"?"Use um nº positivo.":"Use um nº negativo."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Motivo"}),i.jsx("textarea",{name:"reason",value:d.reason,onChange:Q,rows:3,className:"mt-1 w-full border rounded-md p-2",placeholder:"Ex: Concessão anual"})]}),i.jsxs("div",{className:"flex justify-end pt-4 space-x-2",children:[i.jsx("button",{type:"button",onClick:()=>a(!1),className:"bg-pm-gray-200 hover:bg-pm-gray-300 font-bold py-2 px-4 rounded-md",children:"Cancelar"}),i.jsx("button",{type:"button",onClick:E,className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:"Salvar"})]})]})})]})},SC=({message:t,type:e="success"})=>{const n=e==="success"?"bg-green-600":"bg-red-600";return i.jsxs("div",{className:`fixed top-20 right-8 text-white py-3 px-5 rounded-lg shadow-xl z-50 flex items-center ${n}`,role:"alert","aria-live":"assertive",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M12 16v-4"}),i.jsx("path",{d:"M12 8h.01"})]}),i.jsx("span",{children:t})]})},NC=()=>{const{ferias:t,policiais:e,addFerias:n,updateFerias:r,folgas:s,grupos:o}=Fe(),{currentUser:a,role:c}=be(),[u,d]=N.useState({ano:new Date().getFullYear().toString(),pelotao:"",status:""}),[m,f]=N.useState(!1),[p,w]=N.useState({}),[C,R]=N.useState(null),[D,x]=N.useState([]),[v,I]=N.useState(null),[L,B]=N.useState(new Date().toISOString().substring(0,7)),[M,S]=N.useState(""),[_,y]=N.useState(!1),j=N.useRef(null),[b,T]=N.useState(!1),[E,Q]=N.useState(""),[P,F]=N.useState(null),O=N.useMemo(()=>new Map(e.map($=>[$.id,$])),[e]),k=ij(u),G=N.useMemo(()=>[...o].sort(($,se)=>$.nome.localeCompare(se.nome)),[o]);N.useEffect(()=>{if(!m||!p.policialId||!p.anoReferencia||p.id)return;const $=t.filter(Ne=>Ne.policialId===p.policialId&&Ne.anoReferencia===p.anoReferencia&&Ne.status===Ze.AGENDADA).reduce((Ne,nt)=>Ne+(nt.duracaoDias||0),0),se=[];$===0?se.push(15,30):$===15&&se.push(15),x(se),(se.length>0?se[0]:void 0)!==p.duracaoDias&&w(Ne=>({...Ne,duracaoDias:se.length>0?se[0]:void 0}))},[m,p.policialId,p.anoReferencia,t,p.id]),N.useEffect(()=>{if(p!=null&&p.dataInicio&&p.duracaoDias){const $=new Date(p.dataInicio+"T12:00:00"),se=new Date($);se.setDate($.getDate()+p.duracaoDias-1);const Ne=se.toISOString().split("T")[0];Ne!==p.dataFim&&w(nt=>({...nt,dataFim:Ne}))}else p!=null&&p.dataFim&&w($=>({...$,dataFim:""}))},[p==null?void 0:p.dataInicio,p==null?void 0:p.duracaoDias]),N.useEffect(()=>{const $=se=>{j.current&&!j.current.contains(se.target)&&y(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[j]),N.useEffect(()=>{if(v){const $=setTimeout(()=>I(null),4e3);return()=>clearTimeout($)}},[v]);const W=$=>d(se=>({...se,[$.target.name]:$.target.value})),Z=N.useMemo(()=>{if(!M.trim())return e.filter(se=>se.ativo).sort((se,Ne)=>se.nome.localeCompare(Ne.nome));const $=M.toLowerCase();return e.filter(se=>se.ativo&&(se.re.toLowerCase().includes($)||se.nome.toLowerCase().includes($)))},[e,M]),ne=($=null)=>{if($){w({...$}),R({...$});const se=O.get($.policialId||"0");se&&S(`${se.postoGrad} ${se.nome} (${se.re})`)}else w({policialId:void 0,anoReferencia:new Date().getFullYear(),dataInicio:"",dataFim:"",duracaoDias:void 0,status:Ze.AGENDADA,observacao:""}),R(null),x([]),S("");f(!0)},oe=async()=>{if(!(!p||!a))try{if(!p.policialId||!p.dataInicio||!p.dataFim||!p.duracaoDias)throw new Error("Policial, data de início e duração são obrigatórios.");if(new Date(p.dataInicio)>=new Date(p.dataFim))throw new Error("A data de fim deve ser posterior à data de início.");const $=new Date(p.dataInicio+"T12:00:00"),se=new Date(p.dataFim+"T12:00:00"),Ne=s.find(nt=>{if(nt.policialld!==p.policialId||nt.status!==we.ATIVA)return!1;const Ct=new Date(nt.data+"T12:00:00");return Ct>=$&&Ct<=se});if(Ne)throw new Error(`Conflito: O policial já possui uma folga ativa em ${new Date(Ne.data+"T12:00:00").toLocaleDateString("pt-BR")}.`);p.id?(await r(p.id,p,a),I({message:"Férias atualizadas com sucesso!",type:"success"})):(await n(p,a),I({message:"Férias agendadas com sucesso!",type:"success"})),f(!1)}catch($){I({message:$.message,type:"error"})}},re=async $=>{!a||!window.confirm(`Tem certeza que deseja cancelar as férias de ${$.nome}?`)||(await r($.id,{status:Ze.CANCELADA},a),I({message:"Férias canceladas.",type:"success"}))},Re=$=>{F($),Q(""),T(!0)},pe=async()=>{if(!P||!a||!E.trim()){I({message:"O motivo é obrigatório.",type:"error"});return}const $=`[SOLICITAÇÃO - ${new Date().toLocaleString("pt-BR")} por ${a.nome}]: ${E}
---
${P.observacao||""}`;await r(P.id,{status:Ze.SOLICITANDO_ALTERACAO,observacao:$},a),I({message:"Solicitação enviada!",type:"success"}),T(!1)},tt=()=>{C&&(w($=>({...$,dataInicio:C.dataInicio,dataFim:C.dataFim,duracaoDias:C.duracaoDias})),I({message:"Datas restauradas.",type:"success"}))},Yt=()=>{const $=t.map(We=>({...We,...O.get(We.policialId)})).filter(We=>{const Cn=new Date(We.dataInicio+"T12:00:00"),Et=new Date(We.dataFim+"T12:00:00"),de=new Date(L+"-01T12:00:00"),He=new Date(de.getFullYear(),de.getMonth()+1,0,12,0,0);return Cn<=He&&Et>=de&&(!u.pelotao||We.pelotao===u.pelotao)});if($.length===0){I({message:"Nenhum dado para o mês selecionado.",type:"error"});return}const se=`Relatório de Férias - ${new Date(L+"-02").toLocaleString("pt-BR",{month:"long",year:"numeric"})} - Pelotão: ${u.pelotao||"Todos"}`,Ne=["Policial","RE","Pelotão","Posto/Grad","Início","Fim","Duração","Ano Ref."],nt=$.map(We=>[We.nome,We.re,We.pelotao,We.postoGrad,new Date(We.dataInicio+"T12:00").toLocaleDateString("pt-BR"),new Date(We.dataFim+"T12:00").toLocaleDateString("pt-BR"),We.duracaoDias,We.anoReferencia]),Ct=XLSX.utils.aoa_to_sheet([[se],[],Ne,...nt]);Ct["!merges"]=[{s:{r:0,c:0},e:{r:0,c:Ne.length-1}}],XLSX.writeFile(XLSX.utils.book_new(),"relatorio_ferias.xlsx",{bookSST:!0})},jn=N.useMemo(()=>Array.from(new Set(t.map($=>$.anoReferencia))).sort(($,se)=>se-$),[t]);return i.jsxs("div",{className:"container mx-auto",children:[v&&i.jsx(SC,{message:v.message,type:v.type}),i.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Controle de Férias"}),c==="ADMIN"&&i.jsxs("button",{onClick:()=>ne(),className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md flex items-center shadow-sm",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[i.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),i.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Agendar Férias"]})]}),i.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:i.jsxs("div",{className:`grid grid-cols-1 ${c==="ADMIN"?"md:grid-cols-3":"md:grid-cols-2"} gap-4`,children:[i.jsxs("select",{name:"ano",value:u.ano,onChange:W,className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Todos Anos"}),jn.map($=>i.jsx("option",{value:$,children:$},$))]}),c==="ADMIN"&&i.jsxs("select",{name:"pelotao",value:u.pelotao,onChange:W,className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Todos os Grupos"}),G.map($=>i.jsx("option",{value:$.nome,children:$.nome},$.id))]}),i.jsxs("select",{name:"status",value:u.status,onChange:W,className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Todos Status"}),Object.entries(Ku).map(([$,se])=>i.jsx("option",{value:$,children:se},$))]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:[i.jsxs("table",{className:"w-full text-sm text-left text-pm-gray-600",children:[i.jsx("thead",{className:"text-xs uppercase bg-pm-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3",children:"Policial"}),i.jsx("th",{className:"px-6 py-3",children:"Período"}),i.jsx("th",{className:"px-6 py-3",children:"Ano Ref."}),i.jsx("th",{className:"px-6 py-3",children:"Status"}),i.jsx("th",{className:"px-6 py-3 text-right",children:"Ações"})]})}),i.jsx("tbody",{children:k.map($=>i.jsxs("tr",{className:"bg-white border-b hover:bg-pm-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 font-medium",children:[$.nome,i.jsx("br",{}),i.jsxs("span",{className:"text-xs text-pm-gray-500",children:["RE: ",$.re," - ",$.pelotao]})]}),i.jsxs("td",{className:"px-6 py-4",children:[new Date($.dataInicio+"T12:00").toLocaleDateString()," a ",new Date($.dataFim+"T12:00").toLocaleDateString(),i.jsx("br",{}),i.jsxs("span",{className:"text-xs text-pm-gray-500",children:["(",$.duracaoDias," dias)"]})]}),i.jsx("td",{className:"px-6 py-4",children:$.anoReferencia}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${YT[$.status]}`,children:Ku[$.status]})}),i.jsxs("td",{className:"px-6 py-4 text-right space-x-2 whitespace-nowrap",children:[c==="ADMIN"&&$.status===Ze.AGENDADA&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ne($),className:"font-medium text-pm-blue hover:underline",children:"Editar"}),i.jsx("button",{onClick:()=>re($),className:"font-medium text-red-600 hover:underline",children:"Cancelar"})]}),c==="ADMIN"&&$.status===Ze.SOLICITANDO_ALTERACAO&&i.jsx("button",{onClick:()=>ne($),className:"font-medium text-pm-blue hover:underline animate-pulse",children:"Revisar"}),((a==null?void 0:a.policialId)===$.policialId||c==="SARGENTO"&&(a==null?void 0:a.pelotao)===$.pelotao)&&$.status===Ze.AGENDADA&&i.jsx("button",{onClick:()=>Re($),className:"font-medium text-yellow-600 hover:underline",children:"Solicitar Alteração"})]})]},$.id))})]}),k.length===0&&i.jsx("p",{className:"text-center p-4",children:"Nenhum registro encontrado."})]}),c==="ADMIN"&&i.jsxs("div",{className:"mt-8",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Relatório Mensal"}),i.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"reportMonth",className:"block text-sm",children:"Mês"}),i.jsx("input",{type:"month",id:"reportMonth",value:L,onChange:$=>B($.target.value),className:"mt-1 w-full border rounded-md p-2"})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{onClick:Yt,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md w-full md:w-auto",children:"Gerar Relatório"})})]})})]}),i.jsx(cn,{isOpen:m,onClose:()=>f(!1),title:p!=null&&p.id?"Editar Férias":"Agendar Férias",children:p&&i.jsxs("form",{onSubmit:$=>{$.preventDefault(),oe()},className:"space-y-4",children:[i.jsxs("div",{className:"relative",ref:j,children:[i.jsx("label",{className:"block text-sm",children:"Policial"}),i.jsx("input",{type:"text",placeholder:"Buscar por nome ou RE...",value:M,onChange:$=>{S($.target.value),w(se=>({...se,policialId:void 0})),y(!0)},onFocus:()=>{p.id||y(!0)},className:"mt-1 w-full border rounded-md p-2",disabled:!!p.id,autoComplete:"off"}),_&&!p.id&&i.jsx("ul",{className:"absolute z-10 w-full bg-white border mt-1 max-h-60 overflow-y-auto shadow-lg",children:Z.length>0?Z.map($=>i.jsxs("li",{className:"px-3 py-2 cursor-pointer hover:bg-pm-blue-light hover:text-white",onClick:()=>{w(se=>({...se,policialId:$.id})),S(`${$.postoGrad} ${$.nome} (${$.re})`),y(!1)},children:[$.postoGrad," ",$.nome]},$.id)):i.jsx("li",{className:"px-3 py-2 italic",children:"Nenhum policial encontrado."})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Ano Ref."}),i.jsx("input",{type:"number",value:p.anoReferencia,onChange:$=>w({...p,anoReferencia:Number($.target.value)}),className:"mt-1 w-full border rounded-md p-2",required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Início"}),i.jsx("input",{type:"date",value:p.dataInicio||"",onChange:$=>w({...p,dataInicio:$.target.value}),className:`mt-1 w-full border rounded-md p-2 ${p.id?"bg-yellow-50":""}`,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Duração"}),i.jsxs("select",{value:p.duracaoDias||"",onChange:$=>w({...p,duracaoDias:Number($.target.value)}),className:`mt-1 w-full border rounded-md p-2 ${p.id?"bg-yellow-50":""}`,required:!0,disabled:!!p.id||D.length===0&&!p.id,children:[i.jsx("option",{value:"",disabled:!0,children:D.length===0&&!p.id?"Sem saldo":"Selecione..."}),p.id?i.jsxs("option",{value:p.duracaoDias,children:[p.duracaoDias," dias"]}):D.map($=>i.jsxs("option",{value:$,children:[$," dias"]},$))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Fim (Calculada)"}),i.jsx("input",{type:"date",value:p.dataFim||"",readOnly:!0,className:`mt-1 w-full border rounded-md p-2 bg-pm-gray-100 cursor-not-allowed ${p.id?"bg-yellow-50":""}`})]}),p.id&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Status"}),i.jsx("select",{value:p.status||"",onChange:$=>w({...p,status:$.target.value}),className:"mt-1 w-full border rounded-md p-2",children:Object.entries(Ku).map(([$,se])=>i.jsx("option",{value:$,children:se},$))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Observação"}),i.jsx("textarea",{value:p.observacao||"",onChange:$=>w({...p,observacao:$.target.value}),rows:3,className:"mt-1 w-full border rounded-md p-2"})]}),i.jsxs("div",{className:"flex items-center justify-end pt-4 space-x-2",children:[p.id&&i.jsx("button",{type:"button",onClick:tt,className:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-md mr-auto",children:"Restaurar Datas"}),i.jsx("button",{type:"button",onClick:()=>f(!1),className:"bg-pm-gray-200 hover:bg-pm-gray-300 font-bold py-2 px-4 rounded-md",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:"Salvar"})]})]})}),i.jsx(cn,{isOpen:b,onClose:()=>T(!1),title:"Solicitar Alteração de Férias",children:P&&i.jsxs("form",{onSubmit:$=>{$.preventDefault(),pe()},className:"space-y-4",children:[i.jsxs("p",{children:["Solicitando alteração para as férias de ",i.jsx("strong",{children:P.nome})," (início em ",new Date(P.dataInicio+"T12:00:00").toLocaleDateString(),")."]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Motivo / Sugestão"}),i.jsx("textarea",{value:E,onChange:$=>Q($.target.value),rows:4,className:"mt-1 w-full border rounded-md p-2",required:!0,placeholder:"Ex: Adiar o início para a segunda quinzena..."})]}),i.jsxs("div",{className:"flex justify-end pt-4 space-x-2",children:[i.jsx("button",{type:"button",onClick:()=>T(!1),className:"bg-pm-gray-200 hover:bg-pm-gray-300 font-bold py-2 px-4 rounded-md",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md",children:"Enviar Solicitação"})]})]})})]})},IC=({message:t,type:e="success"})=>{const n=e==="success"?"bg-green-600":"bg-red-600";return i.jsxs("div",{className:`fixed top-20 right-8 text-white py-3 px-5 rounded-lg shadow-xl z-50 flex items-center ${n}`,role:"alert","aria-live":"assertive",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M12 16v-4"}),i.jsx("path",{d:"M12 8h.01"})]}),i.jsx("span",{children:t})]})},TC={[ve.CURSO]:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-indigo-600",children:i.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20v2H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v15H6.5A2.5 2.5 0 0 1 4 4.5z"})}),[ve.EAP]:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-purple-600",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("circle",{cx:"12",cy:"12",r:"6"}),i.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),[ve.OPERACAO]:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-red-600",children:i.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),[ve.LICENCA_PREMIO]:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-teal-600",children:[i.jsx("circle",{cx:"12",cy:"8",r:"7"}),i.jsx("polyline",{points:"8.21 13.89 7 23 12 17 17 23 15.79 13.88"})]}),[ve.OUTRO]:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-gray-600",children:[i.jsx("circle",{cx:"12",cy:"12",r:"1"}),i.jsx("circle",{cx:"19",cy:"12",r:"1"}),i.jsx("circle",{cx:"5",cy:"12",r:"1"})]})},jC=()=>{const{agendaEventos:t,policiais:e,addAgendaEvento:n,updateAgendaEvento:r,deleteAgendaEvento:s,ferias:o}=Fe(),{currentUser:a}=be(),[c,u]=N.useState(!1),[d,m]=N.useState(null),[f,p]=N.useState(new Set),[w,C]=N.useState(null),[R,D]=N.useState(""),[x,v]=N.useState(!1),[I,L]=N.useState(null),B=N.useMemo(()=>new Map(e.map(P=>[P.id,P])),[e]),M=aj(),S=N.useMemo(()=>new Set(t.filter(P=>P.tipo===ve.EAP).flatMap(P=>P.policiaisIds)),[t]),_=N.useMemo(()=>new Set(t.filter(P=>P.tipo===ve.CURSO).flatMap(P=>P.policiaisIds)),[t]),y=N.useMemo(()=>{let P=e.filter(F=>F.ativo);if(R.trim()){const F=R.toLowerCase();P=P.filter(O=>O.re.toLowerCase().includes(F)||O.nome.toLowerCase().includes(F)||O.pelotao.toLowerCase().includes(F))}if(c&&d&&(d.tipo===ve.EAP||d.tipo===ve.CURSO)){const F=d.tipo===ve.EAP?S:_,O=new Set(d.policiaisIds||[]);P=P.filter(k=>!F.has(k.id)||O.has(k.id))}return P.sort((F,O)=>F.nome.localeCompare(O.nome))},[e,R,c,d,S,_]);N.useEffect(()=>{if(w){const P=setTimeout(()=>C(null),4e3);return()=>clearTimeout(P)}},[w]);const j=P=>{L(P),v(!0)},b=(P=null)=>{P?(m({...P}),p(new Set(P.policiaisIds||[]))):(m({tipo:ve.OPERACAO,titulo:"",data:new Date().toISOString().split("T")[0],horaInicio:"08:00",horaFim:"17:00",local:"",observacoes:""}),p(new Set)),D(""),u(!0)},T=P=>{p(F=>{const O=new Set(F);return O.has(P)?O.delete(P):O.add(P),O})},E=async P=>{!a||!window.confirm(`Excluir evento "${P.titulo}"?`)||(await s(P.id,a),C({message:"Evento excluído!",type:"success"}))},Q=async()=>{var P,F;if(!(!d||!a))try{if(!((P=d.titulo)!=null&&P.trim()))throw new Error("Título é obrigatório.");if(!((F=d.local)!=null&&F.trim()))throw new Error("Local é obrigatório.");if(f.size===0)throw new Error("Selecione ao menos um policial.");const O={...d,policiaisIds:Array.from(f)},k=new Date(O.data+"T12:00:00");for(const G of f){const W=B.get(G);if(!W)continue;if(o.find(oe=>oe.policialId===G&&oe.status===Ze.AGENDADA&&k>=new Date(oe.dataInicio+"T12:00")&&k<=new Date(oe.dataFim+"T12:00")))throw new Error(`Conflito: ${W.postoGrad} ${W.nome} está de férias.`);if(t.filter(oe=>oe.data===O.data&&oe.id!==O.id&&oe.policiaisIds.includes(G)).length>0)throw new Error(`Conflito: ${W.postoGrad} ${W.nome} já está em outro evento no dia.`)}O.id?(await r(String(O.id),O,a),C({message:"Evento atualizado!",type:"success"})):(await n(O,a),C({message:"Evento criado!",type:"success"})),u(!1)}catch(O){C({message:O.message,type:"error"})}};return i.jsxs("div",{className:"container mx-auto",children:[w&&i.jsx(IC,{message:w.message,type:w.type}),i.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-center mb-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Agenda"}),i.jsxs("button",{onClick:()=>b(),className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md flex items-center",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"mr-2",children:[i.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),i.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Adicionar Evento"]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:[i.jsxs("table",{className:"w-full text-sm text-left",children:[i.jsx("thead",{className:"text-xs uppercase bg-pm-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3",children:"Evento"}),i.jsx("th",{className:"px-6 py-3",children:"Data/Hora"}),i.jsx("th",{className:"px-6 py-3",children:"Efetivo"}),i.jsx("th",{className:"px-6 py-3 text-right",children:"Ações"})]})}),i.jsx("tbody",{children:M.map(P=>i.jsxs("tr",{className:"bg-white border-b hover:bg-pm-gray-50 cursor-pointer",onClick:()=>j(P),children:[i.jsx("td",{className:"px-6 py-4 align-top",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{children:TC[P.tipo]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-base",children:P.titulo}),i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${bi[P.tipo]}`,children:vs[P.tipo]}),i.jsxs("span",{className:"text-xs text-pm-gray-500",children:["Local: ",P.local]})]}),P.observacoes&&i.jsxs("div",{className:"mt-2 text-xs bg-pm-gray-50 p-2 rounded border",children:[i.jsx("p",{className:"font-semibold",children:"Obs:"}),i.jsx("p",{className:"whitespace-pre-wrap",children:P.observacoes})]})]})]})}),i.jsxs("td",{className:"px-6 py-4 align-top",children:[new Date(P.data+"T12:00").toLocaleDateString(),i.jsx("br",{}),i.jsxs("span",{className:"text-xs",children:[P.horaInicio," - ",P.horaFim]})]}),i.jsx("td",{className:"px-6 py-4 align-top",children:i.jsx("ul",{className:"space-y-1",children:P.policiaisIds.map(F=>{const O=B.get(F);return O?i.jsxs("li",{className:"text-xs whitespace-nowrap",children:[i.jsxs("span",{className:"font-semibold",children:[O.postoGrad," ",O.nome]})," (",O.re,")"]},F):null})})}),i.jsxs("td",{className:"px-6 py-4 text-right space-x-2 align-top",onClick:F=>F.stopPropagation(),children:[i.jsx("button",{onClick:()=>b(P),className:"font-medium text-pm-blue hover:underline",children:"Editar"}),i.jsx("button",{onClick:()=>E(P),className:"font-medium text-red-600 hover:underline",children:"Excluir"})]})]},P.id))})]}),M.length===0&&i.jsx("p",{className:"text-center p-4",children:"Nenhum evento agendado."})]}),i.jsx(cn,{isOpen:c,onClose:()=>u(!1),title:d!=null&&d.id?"Editar Evento":"Adicionar Evento",children:d&&i.jsxs("form",{onSubmit:P=>{P.preventDefault(),Q()},className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Tipo"}),i.jsx("select",{name:"tipo",value:d.tipo,onChange:P=>m({...d,tipo:P.target.value}),className:"mt-1 w-full border rounded-md p-2",required:!0,children:Object.entries(vs).map(([P,F])=>i.jsx("option",{value:P,children:F},P))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Título"}),i.jsx("input",{type:"text",value:d.titulo||"",onChange:P=>m({...d,titulo:P.target.value}),className:"mt-1 w-full border rounded-md p-2",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm mb-1",children:"Data/Hora"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 border rounded-md bg-pm-gray-50",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs",children:"Data"}),i.jsx("input",{type:"date",value:d.data||"",onChange:P=>m({...d,data:P.target.value}),className:"mt-1 w-full border rounded-md p-2",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs",children:"Início"}),i.jsx("input",{type:"time",value:d.horaInicio||"",onChange:P=>m({...d,horaInicio:P.target.value}),className:"mt-1 w-full border rounded-md p-2",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs",children:"Fim"}),i.jsx("input",{type:"time",value:d.horaFim||"",onChange:P=>m({...d,horaFim:P.target.value}),className:"mt-1 w-full border rounded-md p-2",required:!0})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Local"}),i.jsx("input",{type:"text",value:d.local||"",onChange:P=>m({...d,local:P.target.value}),className:"mt-1 w-full border rounded-md p-2",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Efetivo"}),i.jsxs("div",{className:"mt-1 p-3 border rounded-md space-y-3 bg-pm-gray-50",children:[i.jsx("input",{type:"text",placeholder:"Buscar...",value:R,onChange:P=>D(P.target.value),className:"w-full border rounded-md p-2"}),(d.tipo===ve.EAP||d.tipo===ve.CURSO)&&i.jsx("div",{className:"text-xs text-blue-700 bg-blue-100 p-2 rounded-md border",children:"Apenas policiais que ainda não participaram são listados."}),i.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-md p-2 space-y-1 bg-white",children:y.length>0?y.map(P=>i.jsxs("label",{className:"flex items-center space-x-3 p-2 rounded hover:bg-pm-gray-100 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:f.has(P.id),onChange:()=>T(P.id),className:"h-5 w-5"}),i.jsxs("span",{className:"text-base",children:[P.postoGrad," ",P.nome," (",P.re,")"]})]},P.id)):i.jsx("p",{className:"text-center text-sm p-4",children:"Nenhum policial."})}),f.size>0&&i.jsxs("div",{children:[i.jsxs("h4",{className:"text-xs font-semibold uppercase mt-2",children:["Selecionados (",f.size,")"]}),i.jsx("div",{className:"flex flex-wrap gap-2 p-2 mt-1 rounded-md bg-white border",children:Array.from(f).map(P=>{const F=B.get(P);return F?i.jsxs("span",{className:"bg-pm-blue text-white text-sm font-medium px-3 py-1 rounded-full flex items-center shadow",children:[F.nome,i.jsx("button",{type:"button",onClick:()=>T(P),className:"ml-2 font-bold opacity-75 hover:opacity-100",children:"×"})]},P):null})})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Observações"}),i.jsx("textarea",{value:d.observacoes||"",onChange:P=>m({...d,observacoes:P.target.value}),rows:3,className:"mt-1 w-full border rounded-md p-2"})]}),i.jsxs("div",{className:"flex justify-end pt-4 space-x-2",children:[i.jsx("button",{type:"button",onClick:()=>u(!1),className:"bg-pm-gray-200 hover:bg-pm-gray-300 font-bold py-2 px-4 rounded-md",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:"Salvar"})]})]})}),i.jsx(cn,{isOpen:x,onClose:()=>v(!1),title:"Detalhes do Evento",children:I&&i.jsxs("div",{className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:`px-2 py-1 text-xs rounded-full float-right ${bi[I.tipo]}`,children:vs[I.tipo]}),i.jsx("h2",{className:"text-xl font-bold",children:I.titulo}),i.jsx("p",{className:"text-pm-gray-500",children:I.local})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-3 bg-pm-gray-50 rounded-md border",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:"Data:"}),i.jsx("p",{children:new Date(I.data+"T12:00").toLocaleDateString()})]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:"Horário:"}),i.jsxs("p",{children:[I.horaInicio," às ",I.horaFim]})]})]}),I.observacoes&&i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:"Observações:"}),i.jsx("p",{className:"p-3 bg-pm-gray-50 rounded-md mt-1 whitespace-pre-wrap border",children:I.observacoes})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"font-semibold mb-2",children:["Efetivo (",I.policiaisIds.length,")"]}),i.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto p-2 bg-pm-gray-50 rounded-md border",children:I.policiaisIds.map(P=>{const F=B.get(P);return F?i.jsxs("li",{className:"flex justify-between items-center bg-white p-2 rounded-md shadow-sm",children:[i.jsxs("span",{children:[F.postoGrad," ",F.nome]}),i.jsx("span",{className:"font-mono text-xs bg-pm-gray-200 px-2 py-0.5 rounded-full",children:F.re})]},P):null})})]}),i.jsx("div",{className:"flex justify-end pt-4",children:i.jsx("button",{type:"button",onClick:()=>v(!1),className:"bg-pm-gray-200 hover:bg-pm-gray-300 font-bold py-2 px-4 rounded-md",children:"Fechar"})})]})})]})},Tx=({className:t})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"9",cy:"7",r:"4"}),i.jsx("polyline",{points:"16 11 18 13 22 9"})]}),CC=()=>{const{currentUser:t,role:e}=be(),{grupos:n}=Fe(),[r,s]=N.useState(ve.EAP),[o,a]=N.useState(e==="SARGENTO"&&(t==null?void 0:t.pelotao)||""),{participantes:c,pendentes:u}=lj({tipoFiltro:r,pelotaoFiltro:o}),d=N.useMemo(()=>[...n].sort((f,p)=>f.nome.localeCompare(p.nome)),[n]),m=()=>{const f=`Relatório de ${r} - ${o||"Todos os Pelotões"}`,p={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},w={font:{sz:16,bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"1D4ED8"}},alignment:{horizontal:"center",vertical:"center"}},C={font:{sz:12,bold:!0},fill:{fgColor:{rgb:"E5E7EB"}},alignment:{horizontal:"center"}},R={font:{bold:!0},fill:{fgColor:{rgb:"F3F4F6"}},border:p},D={border:p},x=["Policial","RE","Posto/Grad","Pelotão","Data Participação","Título do Evento"],v=c.map(Q=>[Q.policial.nome,Q.policial.re,Q.policial.postoGrad,Q.policial.pelotao,new Date(Q.evento.data+"T12:00:00").toLocaleDateString("pt-BR"),Q.evento.titulo]),I=["Policial","RE","Posto/Grad","Pelotão"],L=u.map(Q=>[Q.nome,Q.re,Q.postoGrad,Q.pelotao]),B=[[f],[],["Participantes"],x,...v,[],["Pendentes"],I,...L],M=XLSX.utils.aoa_to_sheet(B),S=(Q,P,F)=>{const O=XLSX.utils.encode_cell({r:Q,c:P});M[O]||(M[O]={v:""}),M[O].s=F};M["!rows"]=[{hpt:25}],M["!merges"]=[],S(0,0,w),M["!merges"].push({s:{r:0,c:0},e:{r:0,c:x.length-1}});const _=2;S(_,0,C),M["!merges"].push({s:{r:_,c:0},e:{r:_,c:x.length-1}});const y=_+1;for(let Q=0;Q<x.length;Q++)S(y,Q,R);for(let Q=0;Q<v.length;Q++)for(let P=0;P<x.length;P++)S(y+1+Q,P,D);const j=y+1+v.length+1;S(j,0,C),M["!merges"].push({s:{r:j,c:0},e:{r:j,c:I.length-1}});const b=j+1;for(let Q=0;Q<I.length;Q++)S(b,Q,R);for(let Q=0;Q<L.length;Q++)for(let P=0;P<I.length;P++)S(b+1+Q,P,D);const T=x.map((Q,P)=>{let F=0;return B.forEach(O=>{if(O[P]){const k=String(O[P]).length;k>F&&(F=k)}}),{wch:F+2}});M["!cols"]=T;const E=XLSX.utils.book_new();XLSX.utils.book_append_sheet(E,M,`Relatorio_${r}`),XLSX.writeFile(E,`Relatorio_${r}_${new Date().toISOString().split("T")[0]}.xlsx`)};return i.jsxs("div",{className:"container mx-auto",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-2",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Relatório de EAP e Cursos"}),i.jsx("button",{onClick:m,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md flex items-center",children:"Exportar Excel"})]}),i.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de Evento"}),i.jsxs("select",{value:r,onChange:f=>s(f.target.value),className:"mt-1 w-full border border-gray-300 rounded-md p-2",children:[i.jsx("option",{value:ve.EAP,children:"EAP"}),i.jsx("option",{value:ve.CURSO,children:"Curso"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Grupo/Pelotão"}),i.jsxs("select",{value:o,onChange:f=>a(f.target.value),className:"mt-1 w-full border border-gray-300 rounded-md p-2",disabled:e==="SARGENTO",children:[i.jsx("option",{value:"",children:"Todos os Grupos"}),d.map(f=>i.jsx("option",{value:f.nome,children:f.nome},f.id))]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-semibold text-pm-gray-800 mb-4 flex items-center",children:[i.jsx(Tx,{className:"h-6 w-6 mr-2 text-green-600"}),"Policiais que Participaram (",c.length,")"]}),i.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:i.jsxs("div",{className:"overflow-x-auto max-h-[60vh]",children:[i.jsxs("table",{className:"w-full text-sm text-left text-pm-gray-600",children:[i.jsx("thead",{className:"text-xs text-pm-gray-700 uppercase bg-pm-gray-50 sticky top-0",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3",children:"Policial"}),i.jsx("th",{className:"px-6 py-3",children:"Data"})]})}),i.jsx("tbody",{className:"divide-y",children:c.map(({policial:f,evento:p})=>i.jsxs("tr",{children:[i.jsxs("td",{className:"px-6 py-4 font-medium",children:[f.postoGrad," ",f.nome,i.jsx("br",{}),i.jsxs("span",{className:"text-xs text-pm-gray-500",children:[f.re," - ",f.pelotao]})]}),i.jsxs("td",{className:"px-6 py-4",children:[new Date(p.data+"T12:00:00").toLocaleDateString(),i.jsx("br",{}),i.jsx("span",{className:"text-xs text-pm-gray-500 truncate",title:p.titulo,children:p.titulo})]})]},f.id))})]}),c.length===0&&i.jsx("p",{className:"text-center p-4",children:"Nenhum participante encontrado."})]})})]}),i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-semibold text-pm-gray-800 mb-4 flex items-center",children:[i.jsx(Tx,{className:"h-6 w-6 mr-2 text-orange-500"}),"Policiais Pendentes (",u.length,")"]}),i.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:i.jsxs("div",{className:"overflow-x-auto max-h-[60vh]",children:[i.jsxs("table",{className:"w-full text-sm text-left text-pm-gray-600",children:[i.jsx("thead",{className:"text-xs text-pm-gray-700 uppercase bg-pm-gray-50 sticky top-0",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3",children:"Policial"}),i.jsx("th",{className:"px-6 py-3",children:"Pelotão"})]})}),i.jsx("tbody",{className:"divide-y",children:u.map(f=>i.jsxs("tr",{children:[i.jsxs("td",{className:"px-6 py-4 font-medium",children:[f.postoGrad," ",f.nome,i.jsx("br",{}),i.jsx("span",{className:"text-xs text-pm-gray-500",children:f.re})]}),i.jsx("td",{className:"px-6 py-4",children:f.pelotao})]},f.id))})]}),u.length===0&&i.jsx("p",{className:"text-center p-4",children:"Nenhum policial pendente."})]})})]})]})]})},bC=({message:t,type:e="success"})=>{const n=e==="success"?"bg-green-600":"bg-red-600";return i.jsxs("div",{className:`fixed top-20 right-8 text-white py-3 px-5 rounded-lg shadow-xl z-50 flex items-center ${n}`,role:"alert","aria-live":"assertive",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M12 16v-4"}),i.jsx("path",{d:"M12 8h.01"})]}),i.jsx("span",{children:t})]})},RC=()=>{const{grupos:t,addGrupo:e,updateGrupo:n,deleteGrupo:r,policiais:s}=Fe(),{currentUser:o}=be(),[a,c]=N.useState(!1),[u,d]=N.useState(null),[m,f]=N.useState(null),p=N.useMemo(()=>{const D=s.reduce((x,v)=>(x[v.pelotao]=(x[v.pelotao]||0)+1,x),{});return[...t].map(x=>({...x,count:D[x.nome]||0})).sort((x,v)=>x.nome.localeCompare(v.nome))},[t,s]);N.useEffect(()=>{if(m){const D=setTimeout(()=>f(null),3e3);return()=>clearTimeout(D)}},[m]);const w=(D=null)=>{d(D?{...D}:{nome:""}),c(!0)},C=async()=>{if(!(u!=null&&u.nome)||!o){f({message:"O nome do grupo é obrigatório.",type:"error"});return}try{u.id?await n(u,o):await e(u.nome,o),f({message:"Grupo salvo com sucesso!",type:"success"}),c(!1)}catch(D){f({message:D.message||"Erro ao salvar grupo",type:"error"})}},R=async D=>{if(!(!o||!window.confirm("Tem certeza que deseja excluir este grupo?")))try{await r(D,o),f({message:"Grupo excluído com sucesso!",type:"success"})}catch(x){f({message:x.message||"Erro ao excluir grupo",type:"error"})}};return i.jsxs("div",{className:"container mx-auto",children:[m&&i.jsx(bC,{message:m.message,type:m.type}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Gerenciar Grupos"}),i.jsx("button",{onClick:()=>w(),className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:"Adicionar Grupo"})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:i.jsxs("table",{className:"w-full text-sm text-left text-pm-gray-600",children:[i.jsx("thead",{className:"text-xs text-pm-gray-700 uppercase bg-pm-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Nome do Grupo"}),i.jsx("th",{scope:"col",className:"px-6 py-3",children:"Policiais no Grupo"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Ações"})]})}),i.jsx("tbody",{children:p.map(D=>i.jsxs("tr",{className:"bg-white border-b hover:bg-pm-gray-50",children:[i.jsx("td",{className:"px-6 py-4 font-medium text-pm-gray-900",children:D.nome}),i.jsx("td",{className:"px-6 py-4",children:D.count}),i.jsxs("td",{className:"px-6 py-4 text-right space-x-2 whitespace-nowrap",children:[i.jsx("button",{onClick:()=>w(D),className:"font-medium text-pm-blue hover:underline",children:"Editar"}),i.jsx("button",{onClick:()=>R(D.id),className:"font-medium text-red-600 hover:underline",children:"Excluir"})]})]},D.id))})]})}),i.jsx(cn,{isOpen:a,onClose:()=>c(!1),title:u!=null&&u.id?"Editar Grupo":"Adicionar Grupo",children:u&&i.jsxs("form",{onSubmit:D=>{D.preventDefault(),C()},className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nome do Grupo"}),i.jsx("input",{type:"text",value:u.nome||"",onChange:D=>d({...u,nome:D.target.value}),className:"mt-1 w-full border border-gray-300 rounded-md p-2",required:!0})]}),i.jsx("div",{className:"flex justify-end pt-4",children:i.jsx("button",{type:"submit",className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:"Salvar"})})]})})]})},DC=({message:t,type:e="success"})=>{const n=e==="success"?"bg-green-600":"bg-red-600";return i.jsxs("div",{className:`fixed top-20 right-8 text-white py-3 px-5 rounded-lg shadow-xl z-50 flex items-center ${n}`,role:"alert","aria-live":"assertive",children:[i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M12 16v-4"}),i.jsx("path",{d:"M12 8h.01"})]}),i.jsx("span",{children:t})]})},kC=({className:t})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("path",{d:"M3 2v6h6"}),i.jsx("path",{d:"M21 12A9 9 0 0 0 6 5.3L3 8"}),i.jsx("path",{d:"M21 22v-6h-6"}),i.jsx("path",{d:"M3 12a9 9 0 0 0 15 6.7l3-2.7"})]}),PC=({className:t})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),i.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),i.jsx("rect",{x:"6",y:"14",width:"12",height:"8"})]}),OC=({className:t})=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[i.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),i.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),LC=()=>{const{protocoloDocs:t,addProtocoloDoc:e,adminResetProtocoloCounter:n}=Fe(),{currentUser:r,role:s}=be(),[o,a]=N.useState(!1),[c,u]=N.useState({}),[d,m]=N.useState(null),[f,p]=N.useState({termo:"",tipo:"",dataInicio:"",dataFim:""}),[w,C]=N.useState(new Set),[R,D]=N.useState(!1),[x,v]=N.useState(null);N.useEffect(()=>{if(d){const T=setTimeout(()=>m(null),4e3);return()=>clearTimeout(T)}},[d]),N.useEffect(()=>{if(R&&x){const T=document.getElementById("details-qrcode");if(T){T.innerHTML="";const Q=`${window.location.href.split("#")[0]}#/protocolo/view/${x.id}`;new QRCode(T,{text:Q,width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})}}},[R,x]);const I=N.useMemo(()=>t.filter(T=>{const E=f.termo.toLowerCase(),Q=!f.termo||T.numero.toLowerCase().includes(E)||T.assunto.toLowerCase().includes(E)||T.destino.toLowerCase().includes(E)||T.interessadoRE.toLowerCase().includes(E),P=!f.tipo||T.tipo===f.tipo,F=!f.dataInicio||T.dataEmissao>=f.dataInicio,O=!f.dataFim||T.dataEmissao<=f.dataFim;return Q&&P&&F&&O}).sort((T,E)=>E.sequencial-T.sequencial).sort((T,E)=>E.ano-T.ano),[t,f]),L=T=>p(E=>({...E,[T.target.name]:T.target.value})),B=()=>{u({dataEmissao:new Date().toISOString().split("T")[0],tipo:st.OFICIO,destino:"",assunto:"",docReferencia:"",interessadoRE:"",observacoes:"",vinculoId:null}),a(!0)},M=T=>{v(T),D(!0)},S=async()=>{if(r)try{if(!c.tipo||!c.assunto.trim()||!c.destino.trim())throw new Error("Tipo, Assunto e Destino são obrigatórios.");const T=await e({...c,elaboradoPorId:r.id,elaboradoPorNome:r.nome},r);m({message:`Documento protocolado com o número ${T.numero}!`,type:"success"}),a(!1)}catch(T){m({message:T.message,type:"error"})}},_=async()=>{if(!(!r||!window.confirm(`Tem certeza que deseja REINICIAR a contagem de documentos para o ano de ${new Date().getFullYear()}? Esta ação não pode ser desfeita.`)))try{await n(r),m({message:"Contador do ano reiniciado com sucesso!",type:"success"})}catch(T){m({message:T.message,type:"error"})}},y=T=>C(E=>{const Q=new Set(E);return Q.has(T)?Q.delete(T):Q.add(T),Q}),j=T=>C(T.target.checked?new Set(I.map(E=>E.id)):new Set),b=()=>{const T=I.filter(O=>w.has(O.id)).sort((O,k)=>O.ano-k.ano||O.sequencial-k.sequencial);if(T.length===0){m({message:"Selecione ao menos um documento para gerar a guia.",type:"error"});return}const E=window.open("","_blank");if(!E){m({message:"Não foi possível abrir uma nova janela. Verifique seu bloqueador de pop-ups.",type:"error"});return}const Q=T.map(O=>`
      <tr class="border-b break-inside-avoid">
        <td class="p-2 align-top font-mono">${O.numero}</td>
        <td class="p-2 align-top">${O.tipo}</td>
        <td class="p-2 align-top">${O.assunto}</td>
        <td class="p-2 align-top">
            <div class="flex justify-center items-center">
                <div id="qrcode-${O.id}"></div>
            </div>
        </td>
      </tr>
    `).join(""),P=`
      document.addEventListener('DOMContentLoaded', function() {
        try {
          const data = ${JSON.stringify(T)};
          const baseUrl = '${window.location.href.split("#")[0]}';
          
          data.forEach(doc => {
              const container = document.getElementById('qrcode-' + doc.id);
              if (container) {
                  const url = \`\${baseUrl}#/protocolo/view/\${doc.id}\`;
                  new QRCode(container, {
                      text: url,
                      width: 96,
                      height: 96,
                      colorDark : "#000000",
                      colorLight : "#ffffff",
                      correctLevel : QRCode.CorrectLevel.M
                  });
              }
          });

          document.getElementById('print-button').addEventListener('click', () => {
              window.print();
          });
        } catch (e) {
          console.error('Erro ao gerar QR Codes:', e);
          document.body.innerHTML = '<h1>Erro ao gerar a guia. Por favor, tente novamente.</h1><p>' + (e instanceof Error ? e.message : String(e)) + '</p>';
        }
      });
    `,F=`
      <!DOCTYPE html>
      <html lang="pt-BR">
        <head>
          <meta charset="UTF-8" />
          <meta name="viewport" content="width=device-width, initial-scale=1.0" />
          <title>Guia de Recebimento de Documentos</title>
          <script src="https://cdn.tailwindcss.com"><\/script>
          <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"><\/script>
          <style>
            @media print {
              body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
              .no-print { display: none !important; }
              @page { size: A4; margin: 2cm; }
            }
          </style>
        </head>
        <body class="bg-gray-100 font-sans">
          <div class="fixed top-4 right-4 no-print">
            <button id="print-button" class="bg-blue-600 text-white py-2 px-4 rounded-lg shadow-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
              Imprimir / Salvar PDF
            </button>
          </div>
          <div class="container mx-auto my-8 p-8 bg-white shadow-lg" id="printable-area">
            <header class="text-center mb-8 border-b pb-4">
              <h1 class="text-2xl font-bold text-gray-800">GUIA DE RECEBIMENTO DE DOCUMENTOS</h1>
              <p class="text-sm text-gray-500">Gerado em: ${new Date().toLocaleString("pt-BR")}</p>
            </header>
            <main>
              <table class="w-full text-sm border-collapse">
                <thead>
                  <tr class="border-b-2 border-black">
                    <th class="p-2 text-left font-bold" style="width: 20%;">NÚMERO</th>
                    <th class="p-2 text-left font-bold" style="width: 20%;">TIPO</th>
                    <th class="p-2 text-left font-bold" style="width: 45%;">ASSUNTO</th>
                    <th class="p-2 text-center font-bold" style="width: 15%;">QR CODE</th>
                  </tr>
                </thead>
                <tbody>
                  ${Q}
                </tbody>
              </table>
            </main>
            <footer class="mt-16 pt-8 text-sm">
              <div class="flex justify-between items-center break-inside-avoid">
                <div>
                  <p class="mb-12">Recebido por: _________________________________________</p>
                  <p class="border-t pt-2 w-full">Assinatura do Responsável</p>
                </div>
                <div>
                  <p>Data/Hora: ______/______/________, ______:______hs</p>
                </div>
              </div>
            </footer>
          </div>
          <script>${P}<\/script>
        </body>
      </html>
    `;E.document.write(F),E.document.close()};return i.jsxs("div",{className:"container mx-auto",children:[d&&i.jsx(DC,{message:d.message,type:d.type}),i.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-pm-gray-800",children:"Protocolo de Documentos"}),i.jsxs("div",{className:"flex items-center gap-2",children:[s==="ADMIN"&&i.jsxs("button",{onClick:_,className:"bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-md flex items-center gap-2",children:[i.jsx(kC,{className:"h-4 w-4"}),"Reiniciar Numeração Anual"]}),i.jsxs("button",{onClick:b,className:"bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-md disabled:bg-teal-300 flex items-center gap-2",disabled:w.size===0,children:[i.jsx(PC,{className:"h-4 w-4"}),"Gerar Guia (",w.size,")"]}),i.jsxs("button",{onClick:B,className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md flex items-center gap-2",children:[i.jsx(OC,{className:"h-4 w-4"}),"Novo Documento"]})]})]}),i.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("input",{type:"text",name:"termo",placeholder:"Buscar por nº, assunto...",value:f.termo,onChange:L,className:"w-full px-3 py-2 border rounded-md"}),i.jsxs("select",{name:"tipo",value:f.tipo,onChange:L,className:"w-full px-3 py-2 border rounded-md",children:[i.jsx("option",{value:"",children:"Todos os Tipos"}),wx.map(T=>i.jsx("option",{value:T,children:T},T))]}),i.jsx("input",{type:"date",name:"dataInicio",value:f.dataInicio,onChange:L,className:"w-full px-3 py-2 border rounded-md"}),i.jsx("input",{type:"date",name:"dataFim",value:f.dataFim,onChange:L,className:"w-full px-3 py-2 border rounded-md"})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:[i.jsxs("table",{className:"w-full text-sm text-left",children:[i.jsx("thead",{className:"text-xs uppercase bg-pm-gray-50 text-pm-gray-700",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3",children:i.jsx("input",{type:"checkbox",onChange:j,checked:w.size===I.length&&I.length>0})}),i.jsx("th",{className:"px-6 py-3",children:"Número"}),i.jsx("th",{className:"px-6 py-3",children:"Data"}),i.jsx("th",{className:"px-6 py-3",children:"Tipo"}),i.jsx("th",{className:"px-6 py-3",children:"Assunto"}),i.jsx("th",{className:"px-6 py-3",children:"Destino"}),i.jsx("th",{className:"px-6 py-3",children:"Elaborado por"})]})}),i.jsx("tbody",{children:I.map(T=>i.jsxs("tr",{className:"bg-white border-b hover:bg-pm-gray-50 cursor-pointer",onClick:()=>M(T),children:[i.jsx("td",{className:"px-6 py-4",onClick:E=>E.stopPropagation(),children:i.jsx("input",{type:"checkbox",checked:w.has(T.id),onChange:()=>y(T.id)})}),i.jsx("td",{className:"px-6 py-4 font-mono font-semibold text-pm-gray-900",children:T.numero}),i.jsx("td",{className:"px-6 py-4 text-pm-gray-700",children:new Date(T.dataEmissao+"T12:00").toLocaleDateString()}),i.jsx("td",{className:"px-6 py-4 text-pm-gray-700",children:T.tipo}),i.jsx("td",{className:"px-6 py-4 font-medium text-pm-gray-900",children:T.assunto}),i.jsx("td",{className:"px-6 py-4 text-pm-gray-700",children:T.destino}),i.jsx("td",{className:"px-6 py-4 text-pm-gray-700",children:T.elaboradoPorNome})]},T.id))})]}),I.length===0&&i.jsx("p",{className:"text-center p-4 text-pm-gray-600",children:"Nenhum documento encontrado."})]}),i.jsxs(cn,{isOpen:o,onClose:()=>a(!1),title:"Novo Protocolo de Documento",children:[i.jsx("h3",{className:"text-lg font-semibold text-pm-gray-800 mb-4 border-b pb-2",children:"Campos do Registro"}),i.jsxs("form",{onSubmit:T=>{T.preventDefault(),S()},className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Número"}),i.jsx("input",{type:"text",value:"Automático",disabled:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-pm-gray-100"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Data de Emissão"}),i.jsx("input",{type:"date",value:c.dataEmissao,onChange:T=>u(E=>({...E,dataEmissao:T.target.value})),className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Elaborado por"}),i.jsx("input",{type:"text",value:(r==null?void 0:r.nome)||"",disabled:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-pm-gray-100"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Tipo de Documento"}),i.jsxs("select",{value:c.tipo,onChange:T=>u(E=>({...E,tipo:T.target.value})),className:"w-full p-2 border border-gray-300 rounded-md",required:!0,children:[i.jsx("option",{value:"",children:"Selecione..."}),wx.map(T=>i.jsx("option",{value:T,children:T},T))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Destino"}),i.jsx("input",{type:"text",value:c.destino,onChange:T=>u(E=>({...E,destino:T.target.value})),className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Assunto"}),i.jsx("textarea",{value:c.assunto,onChange:T=>u(E=>({...E,assunto:T.target.value})),rows:3,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Documento de Referência"}),i.jsx("input",{type:"text",value:c.docReferencia,onChange:T=>u(E=>({...E,docReferencia:T.target.value})),className:"w-full p-2 border border-gray-300 rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Vínculo (opcional)"}),i.jsx("input",{type:"text",value:c.vinculoId||"",onChange:T=>u(E=>({...E,vinculoId:T.target.value})),placeholder:"Nº do doc. vinculado",className:"w-full p-2 border border-gray-300 rounded-md"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Interessado / RE"}),i.jsx("input",{type:"text",value:c.interessadoRE,onChange:T=>u(E=>({...E,interessadoRE:T.target.value})),className:"w-full p-2 border border-gray-300 rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-pm-gray-800 mb-1",children:"Observações"}),i.jsx("textarea",{value:c.observacoes,onChange:T=>u(E=>({...E,observacoes:T.target.value})),rows:2,className:"w-full p-2 border border-gray-300 rounded-md"})]}),i.jsxs("div",{className:"flex justify-end pt-4 space-x-2",children:[i.jsx("button",{type:"button",onClick:()=>a(!1),className:"bg-pm-gray-200 hover:bg-pm-gray-300 font-bold py-2 px-4 rounded-md",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"bg-pm-blue hover:bg-pm-blue-dark text-white font-bold py-2 px-4 rounded-md",children:"Protocolar"})]})]})]}),i.jsx(cn,{isOpen:R,onClose:()=>D(!1),title:"Detalhes do Documento",children:x&&i.jsxs("div",{className:"space-y-4 text-sm",children:[i.jsxs("div",{className:"p-4 bg-pm-gray-50 rounded-lg border",children:[i.jsx("p",{className:"text-xs text-pm-gray-500",children:"Número"}),i.jsx("p",{className:"font-mono text-xl font-bold text-pm-gray-800",children:x.numero}),i.jsx("p",{className:"text-xs text-pm-gray-500 mt-2",children:"Assunto"}),i.jsx("p",{className:"font-semibold text-pm-gray-900",children:x.assunto})]}),i.jsxs("dl",{className:"divide-y divide-pm-gray-200",children:[i.jsxs("div",{className:"py-2 grid grid-cols-3 gap-4",children:[i.jsx("dt",{className:"text-pm-gray-500",children:"Tipo"}),i.jsx("dd",{className:"col-span-2 text-pm-gray-800",children:x.tipo})]}),i.jsxs("div",{className:"py-2 grid grid-cols-3 gap-4",children:[i.jsx("dt",{className:"text-pm-gray-500",children:"Data Emissão"}),i.jsx("dd",{className:"col-span-2 text-pm-gray-800",children:new Date(x.dataEmissao+"T12:00").toLocaleDateString()})]}),i.jsxs("div",{className:"py-2 grid grid-cols-3 gap-4",children:[i.jsx("dt",{className:"text-pm-gray-500",children:"Destino"}),i.jsx("dd",{className:"col-span-2 text-pm-gray-800",children:x.destino})]}),i.jsxs("div",{className:"py-2 grid grid-cols-3 gap-4",children:[i.jsx("dt",{className:"text-pm-gray-500",children:"Elaborado por"}),i.jsx("dd",{className:"col-span-2 text-pm-gray-800",children:x.elaboradoPorNome})]}),i.jsxs("div",{className:"py-2 grid grid-cols-3 gap-4",children:[i.jsx("dt",{className:"text-pm-gray-500",children:"Doc. Referência"}),i.jsx("dd",{className:"col-span-2 text-pm-gray-800",children:x.docReferencia||"-"})]}),i.jsxs("div",{className:"py-2 grid grid-cols-3 gap-4",children:[i.jsx("dt",{className:"text-pm-gray-500",children:"Interessado"}),i.jsx("dd",{className:"col-span-2 text-pm-gray-800",children:x.interessadoRE||"-"})]}),i.jsxs("div",{className:"py-2 grid grid-cols-3 gap-4",children:[i.jsx("dt",{className:"text-pm-gray-500",children:"Observações"}),i.jsx("dd",{className:"col-span-2 text-pm-gray-800 whitespace-pre-wrap",children:x.observacoes||"-"})]})]}),i.jsxs("div",{className:"border-t pt-4",children:[i.jsx("p",{className:"text-center font-semibold text-pm-gray-600 mb-2",children:"Link de Verificação Pública"}),i.jsx("div",{id:"details-qrcode",className:"flex justify-center p-2 bg-white border rounded-lg"})]}),i.jsx("div",{className:"flex justify-end pt-4",children:i.jsx("button",{type:"button",onClick:()=>D(!1),className:"bg-pm-gray-200 hover:bg-pm-gray-300 font-bold py-2 px-4 rounded-md",children:"Fechar"})})]})})]})},VC=150,MC=[{id:"1",nome:"CARLOS ALBERTO DE NOBREGA",re:"123456-7",postoGrad:"Cb",ativo:!0,pelotao:"PEL-A"},{id:"2",nome:"SILVIO SANTOS",re:"987654-3",postoGrad:"3º Sgt",ativo:!0,pelotao:"PEL-B"},{id:"3",nome:"FAUSTO SILVA",re:"112233-4",postoGrad:"Sd 1ª Cl",ativo:!1,pelotao:"ADM"},{id:"4",nome:"ANA MARIA BRAGA",re:"445566-7",postoGrad:"Cap",ativo:!0,pelotao:"ADM"},{id:"5",nome:"RODRIGO FARO",re:"778899-0",postoGrad:"2º Ten",ativo:!0,pelotao:"ROCAM"},{id:"6",nome:"USUARIO TESTE SUBORDINADO",re:"123123-1",postoGrad:"Sd 2ª Cl",ativo:!0,pelotao:"PEL-A"}],FC=[{id:"101",policialId:null,nome:"Administrador do Sistema",reLogin:"000000",role:"ADMIN",acessoLiberado:!0,senha:"admin123",ativo:!0,criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString()},{id:"102",policialId:null,nome:"Sargento Mestre (TESTE)",reLogin:"132155",role:"SARGENTO",acessoLiberado:!0,senha:"132155",ativo:!0,criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString(),pelotao:"TODOS",postoGrad:"1º Sgt"},{id:"103",policialId:"6",nome:"USUARIO TESTE SUBORDINADO",reLogin:"123123",role:"SUBORDINADO",acessoLiberado:!0,senha:"123123",ativo:!0,criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString(),pelotao:"PEL-A",postoGrad:"Sd 2ª Cl"}],BC=[{folgald:"1",policialld:"1",nome:"CARLOS ALBERTO DE NOBREGA",re:"123456-7",data:"2024-07-20",status:we.ATIVA,aprovacao:le.VALIDADA_ADMIN,criadaPorld:"101",criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString(),pelotao:"PEL-A",trocadaPara:null,motivo:null,adminld:"101",adminParecer:"Ok"},{folgald:"2",policialld:"2",nome:"SILVIO SANTOS",re:"987654-3",data:"2024-07-22",status:we.ATIVA,aprovacao:le.VALIDADA_ADMIN,criadaPorld:"101",criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString(),pelotao:"PEL-B",trocadaPara:null,motivo:null,adminld:"101",adminParecer:"Ok"}],UC=[{id:"fer1",policialId:"1",anoReferencia:2024,dataInicio:"2024-09-01",dataFim:"2024-09-30",duracaoDias:30,status:Ze.AGENDADA,criadoEm:new Date().toISOString(),criadoPorId:"101",atualizadoEm:new Date().toISOString()},{id:"fer2",policialId:"2",anoReferencia:2024,dataInicio:"2024-10-15",dataFim:"2024-10-29",duracaoDias:15,status:Ze.AGENDADA,criadoEm:new Date().toISOString(),criadoPorId:"101",atualizadoEm:new Date().toISOString()}],$C=[{id:"1",nome:"PEL-A"},{id:"2",nome:"PEL-B"},{id:"3",nome:"ADM"},{id:"4",nome:"ROCAM"}],wh={policiais:MC,folgas:BC,historico:[],users:FC,leaveLedger:[],ferias:UC,agendaEventos:[],notificacoes:[],comentarios:[],grupos:$C,protocoloDocs:[],protocoloContador:{}};let Y=wh;const zC=()=>{try{const t=localStorage.getItem("appData");Y=t?JSON.parse(t):wh}catch(t){console.error("Failed to load DB from localStorage",t),Y=wh}},Be=()=>localStorage.setItem("appData",JSON.stringify(Y));zC();const Ce=(t,e=VC)=>new Promise(n=>setTimeout(()=>n(JSON.parse(JSON.stringify(t))),e)),rt=t=>Promise.reject(new Error(t)),kt=(t,e,n)=>({id:String(Date.now()),evento:t,actorId:e.id,actorNome:e.nome,timestamp:new Date().toISOString(),pelotao:e.pelotao||"N/A",dataOriginal:null,dataNova:null,motivo:null,antesDepois:null,...n}),GC={getAllData:()=>Ce(Y),login:(t,e)=>{if(t==="143468"&&e==="143468"){const r=Y.users.find(s=>s.role==="ADMIN");if(r)return Ce(r)}const n=Y.users.find(r=>r.reLogin===t);return n?n.acessoLiberado?n.senha!==e?rt("Senha incorreta"):Ce(n):rt("Acesso não liberado"):rt("Usuário não encontrado")},grantAccess:(t,e,n,r,s)=>{if(!(t!=null&&t.id)||!e)return rt("Dados inválidos.");if(n==="ADMIN"&&(!r||r!==(s==null?void 0:s.senha)&&r!=="143468"))return rt("Senha de admin incorreta.");const o=(t.re||"").split("-")[0].replace(/\D/g,"");if(!o)return rt("RE do policial inválido.");const a=Y.users.find(d=>d.policialId===t.id),c=a?{...a}:{id:String(Date.now()),policialId:t.id,criadoEm:new Date().toISOString(),ativo:!0,nome:"",reLogin:"",role:"SUBORDINADO",senha:"",acessoLiberado:!1,atualizadoEm:""};Object.assign(c,{nome:t.nome,reLogin:o,role:n,senha:e,acessoLiberado:!0,atualizadoEm:new Date().toISOString(),pelotao:t.pelotao,postoGrad:t.postoGrad});const u=Y.users.findIndex(d=>d.id===c.id);return u>-1?Y.users[u]=c:Y.users.push(c),Be(),Ce(c)},resetPassword:(t,e)=>{if(e.length<3)return rt("Senha muito curta.");const n=Y.users.find(r=>r.policialId===t);return n?(n.senha=e,n.acessoLiberado=!0,n.atualizadoEm=new Date().toISOString(),Be(),Ce(n)):rt("Usuário não encontrado.")},revokeAccess:t=>{const e=Y.users.find(n=>n.policialId===t);return e?(e.acessoLiberado=!1,e.atualizadoEm=new Date().toISOString(),Be(),Ce(e)):rt("Usuário não encontrado.")},createFolga:(t,e)=>{const n={...t,folgald:`f${Date.now()}`,criadoEm:new Date().toISOString()},r=kt(Ve.ACIONAR_FOLGA,e,{folgald:n.folgald,policialld:n.policialld,nome:n.nome,re:n.re,motivo:`Acionada: ${n.motivo}`,antesDepois:{depois:n}});return Y.folgas.push(n),Y.historico.unshift(r),Be(),Ce(n)},updateFolga:(t,e,n)=>{const r=Y.folgas.findIndex(c=>c.folgald===t);if(r===-1)return rt("Folga não encontrada.");const s={...Y.folgas[r]},o={...s,...e,atualizadoEm:new Date().toISOString(),atualizadoPorld:n.id};Y.folgas[r]=o;const a=kt(Ve.UPDATE_USER,n,{folgald:t,motivo:"Atualização de folga",antesDepois:{antes:s,depois:o}});return Y.historico.unshift(a),Be(),Ce(o)},createPolicial:(t,e)=>{const n={...t,id:String(Date.now())};return Y.policiais.push(n),Y.historico.unshift(kt(Ve.CREATE_POLICIAL,e,{policialld:n.id,nome:n.nome,re:n.re,antesDepois:{depois:n}})),Be(),Ce(n)},updatePolicial:(t,e)=>{const n=Y.policiais.findIndex(s=>s.id===t.id);if(n===-1)return rt("Policial não encontrado.");const r=Y.policiais[n];return Y.policiais[n]=t,Y.historico.unshift(kt(Ve.UPDATE_POLICIAL,e,{policialld:t.id,antesDepois:{antes:r,depois:t}})),Be(),Ce(t)},deletePolicial:(t,e)=>{const n=Y.policiais.find(r=>r.id===t);return n?(Y.policiais=Y.policiais.filter(r=>r.id!==t),Y.users=Y.users.filter(r=>r.policialId!==t),Y.historico.unshift(kt(Ve.DELETE_POLICIAL,e,{policialld:t,antesDepois:{antes:n}})),Be(),Ce({ok:!0})):rt("Policial não encontrado.")},bulkUpsertPoliciais:(t,e)=>{const n=new Map(Y.policiais.map(r=>[r.re.split("-")[0],r]));return t.forEach(r=>{const s=n.get(r.re.split("-")[0]);s?Object.assign(s,r):Y.policiais.push({...r,id:String(Date.now()+Math.random())})}),Y.historico.unshift(kt(Ve.BULK_UPSERT_POLICIAIS,e,{motivo:`Importados/Atualizados: ${t.length}`})),Be(),Ce({ok:!0})},addLeaveCredit:(t,e)=>{const n={id:`ll-${Date.now()}`,...t,createdAt:new Date().toISOString(),createdById:e.id,createdByNome:e.nome};return Y.leaveLedger.unshift(n),Be(),Ce(n)},createFerias:(t,e)=>{const n={...t,id:`ferias-${Date.now()}`,criadoPorId:e.id,criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString()};return Y.ferias.push(n),Y.historico.unshift(kt(Ve.CREATE_FERIAS,e,{policialld:n.policialId,antesDepois:{depois:n}})),Be(),Ce(n)},updateFerias:(t,e,n)=>{const r=Y.ferias.findIndex(a=>a.id===t);if(r===-1)return rt("Férias não encontradas.");const s=Y.ferias[r],o={...s,...e,atualizadoPorId:n.id,atualizadoEm:new Date().toISOString()};return Y.ferias[r]=o,Y.historico.unshift(kt(Ve.UPDATE_FERIAS,n,{policialld:o.policialId,antesDepois:{antes:s,depois:o}})),Be(),Ce(o)},createAgendaEvento:(t,e)=>{const n={...t,id:`agenda-${Date.now()}`,criadoPorId:e.id,criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString()};return Y.agendaEventos.push(n),Y.historico.unshift(kt(Ve.CREATE_AGENDA_EVENTO,e,{motivo:`Criado evento: ${n.titulo}`,antesDepois:{depois:n}})),Be(),Ce(n)},updateAgendaEvento:(t,e,n)=>{const r=Y.agendaEventos.findIndex(a=>a.id===t);if(r===-1)return rt("Evento não encontrado.");const s=Y.agendaEventos[r],o={...s,...e,atualizadoPorId:n.id,atualizadoEm:new Date().toISOString()};return Y.agendaEventos[r]=o,Y.historico.unshift(kt(Ve.UPDATE_AGENDA_EVENTO,n,{antesDepois:{antes:s,depois:o}})),Be(),Ce(o)},deleteAgendaEvento:(t,e)=>{const n=Y.agendaEventos.find(r=>r.id===t);return n?(Y.agendaEventos=Y.agendaEventos.filter(r=>r.id!==t),Y.historico.unshift(kt(Ve.DELETE_AGENDA_EVENTO,e,{antesDepois:{antes:n}})),Be(),Ce({ok:!0})):rt("Evento não encontrado.")},addNotificacoes:t=>(Y.notificacoes.unshift(...t),Be(),Ce({ok:!0})),markNotificacoesAsRead:t=>(Y.notificacoes.forEach(e=>{e.policialId===t&&(e.lida=!0)}),Be(),Ce({ok:!0})),createComentario:(t,e)=>{const n={id:`c-${Date.now()}`,folgald:t.folgald,actorId:e.id,actorNome:e.nome,actorPostoGrad:e.postoGrad,mensagem:t.mensagem.trim(),timestamp:new Date().toISOString()};return Y.comentarios.push(n),Be(),Ce(n)},createGrupo:(t,e)=>{if(Y.grupos.some(r=>r.nome.toLowerCase()===t.toLowerCase()))return rt("Um grupo com este nome já existe.");const n={id:String(Date.now()),nome:t};return Y.grupos.push(n),Y.historico.unshift(kt(Ve.CREATE_GRUPO,e,{antesDepois:{depois:n}})),Be(),Ce(n)},updateGrupo:(t,e)=>{const n=Y.grupos.findIndex(s=>s.id===t.id);if(n===-1)return rt("Grupo não encontrado.");const r=Y.grupos[n];return Y.policiais.forEach(s=>{s.pelotao===r.nome&&(s.pelotao=t.nome)}),Y.grupos[n]=t,Y.historico.unshift(kt(Ve.UPDATE_GRUPO,e,{antesDepois:{antes:r,depois:t}})),Be(),Ce(t)},deleteGrupo:(t,e)=>{const n=Y.grupos.find(s=>s.id===t);return n?Y.policiais.some(s=>s.pelotao===n.nome)?rt("Não é possível excluir um grupo que está em uso por policiais."):(Y.grupos=Y.grupos.filter(s=>s.id!==t),Y.historico.unshift(kt(Ve.DELETE_GRUPO,e,{antesDepois:{antes:n}})),Be(),Ce({ok:!0})):rt("Grupo não encontrado.")},createProtocoloDoc:(t,e)=>{const n=new Date(t.dataEmissao+"T12:00:00").getFullYear(),r=String(n).slice(-2);Y.protocoloContador||(Y.protocoloContador={});const s=(Y.protocoloContador[n]||0)+1;Y.protocoloContador[n]=s;const o=`${String(s).padStart(3,"0")}/${Bw}/${r}`,a={...t,id:`proto-${Date.now()}`,numero:o,ano:n,sequencial:s,criadoEm:new Date().toISOString()};return Y.protocoloDocs.unshift(a),Y.historico.unshift(kt(Ve.CREATE_PROTOCOLO,e,{motivo:`Protocolado doc nº ${o}`,antesDepois:{depois:a}})),Be(),Ce(a)},resetProtocoloCounter:t=>{const e=new Date().getFullYear(),n=Y.protocoloContador[e]||0;return Y.protocoloContador[e]=0,Y.historico.unshift(kt(Ve.RESET_PROTOCOLO_COUNTER,t,{motivo:`Contador de ${e} reiniciado. Valor anterior: ${n}`})),Be(),Ce({ok:!0})},getProtocoloDocById:t=>{const e=Y.protocoloDocs.find(n=>n.id===t);return e?Ce(e):rt("Documento não encontrado.")}},qC=({className:t})=>i.jsx("div",{className:`flex items-center justify-center ${t}`,children:i.jsx("svg",{viewBox:"0 0 80 88",className:"h-20 w-auto",children:i.jsxs("g",{children:[i.jsx("path",{d:"M40 0 L80 16 V56 C80 78 40 88 40 88 C40 88 0 78 0 56 V16 Z",fill:"#19398A"}),i.jsx("path",{d:"M40 4 L76 18.4 V54.8 C76 74.8 40 84 40 84 C40 84 4 74.8 4 54.8 V18.4 Z",strokeWidth:"3",stroke:"white",fill:"none"}),i.jsx("text",{x:"32",y:"62",fontFamily:"Verdana, sans-serif",fontSize:"42",fontWeight:"bold",fill:"white",textAnchor:"middle",children:"Σ"}),i.jsx("text",{x:"55",y:"48",fontFamily:"Verdana, sans-serif",fontSize:"22",fontWeight:"bold",fill:"white",children:"E"})]})})}),gr=({label:t,value:e})=>i.jsxs("div",{className:"py-3 sm:grid sm:grid-cols-3 sm:gap-4",children:[i.jsx("dt",{className:"text-sm font-medium text-pm-gray-500",children:t}),i.jsx("dd",{className:"mt-1 text-sm text-pm-gray-900 sm:mt-0 sm:col-span-2",children:e||i.jsx("span",{className:"italic text-pm-gray-400",children:"Não informado"})})]}),WC=()=>{const{docId:t}=p2(),[e,n]=N.useState(null),[r,s]=N.useState(!0),[o,a]=N.useState(null);return N.useEffect(()=>{t?GC.getProtocoloDocById(t).then(c=>{n(c)}).catch(c=>{a(c.message||"Erro ao buscar documento.")}).finally(()=>{s(!1)}):(a("ID do documento não fornecido."),s(!1))},[t]),i.jsxs("div",{className:"min-h-screen bg-pm-gray-100 p-4 sm:p-8 flex flex-col items-center",children:[i.jsxs("header",{className:"w-full max-w-4xl mx-auto flex flex-col items-center mb-6",children:[i.jsx(qC,{}),i.jsx("h1",{className:"text-2xl font-bold text-pm-blue mt-2",children:"SIGMA-E"}),i.jsx("p",{className:"text-pm-gray-600",children:"Verificação de Documento Protocolado"})]}),i.jsxs("main",{className:"w-full max-w-4xl mx-auto bg-white shadow-lg rounded-xl p-6 sm:p-8",children:[r&&i.jsx("div",{className:"flex justify-center items-center py-10",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-pm-blue"})}),o&&i.jsxs("div",{className:"text-center py-10",children:[i.jsx("h2",{className:"text-xl font-semibold text-red-600",children:"Erro"}),i.jsx("p",{className:"text-pm-gray-600 mt-2",children:o})]}),!r&&!o&&!e&&i.jsxs("div",{className:"text-center py-10",children:[i.jsx("h2",{className:"text-xl font-semibold text-pm-gray-700",children:"Documento não encontrado"}),i.jsx("p",{className:"text-pm-gray-600 mt-2",children:"O documento com o ID fornecido não foi localizado em nosso sistema."})]}),e&&i.jsxs("div",{children:[i.jsxs("div",{className:"border-b border-pm-gray-200 pb-4 mb-4",children:[i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-pm-gray-900",children:e.assunto}),i.jsxs("p",{className:"text-sm text-pm-gray-500 mt-1",children:["Protocolado em ",new Date(e.criadoEm).toLocaleString("pt-BR")]})]}),i.jsxs("dl",{className:"divide-y divide-pm-gray-200",children:[i.jsx(gr,{label:"Número do Protocolo",value:i.jsx("span",{className:"font-mono font-bold",children:e.numero})}),i.jsx(gr,{label:"Tipo de Documento",value:e.tipo}),i.jsx(gr,{label:"Data de Emissão",value:new Date(e.dataEmissao+"T12:00:00").toLocaleDateString("pt-BR")}),i.jsx(gr,{label:"Destino",value:e.destino}),i.jsx(gr,{label:"Elaborado por",value:e.elaboradoPorNome}),i.jsx(gr,{label:"Documento de Referência",value:e.docReferencia}),i.jsx(gr,{label:"Interessado / RE",value:e.interessadoRE}),i.jsx(gr,{label:"Observações",value:i.jsx("p",{className:"whitespace-pre-wrap",children:e.observacoes})})]})]})]}),i.jsx("footer",{className:"w-full max-w-4xl mx-auto text-center mt-8 text-xs text-pm-gray-500",children:i.jsx("p",{children:"Este é um documento gerado pelo sistema SIGMA-E. A validade pode ser confirmada através do QR Code."})})]})},HC=()=>{const{logout:t}=be();return N.useEffect(()=>{t()},[t]),i.jsx(yo,{to:"/login",replace:!0})},QC=({children:t})=>{const{isAuthenticated:e,currentUser:n}=be();return!e||!n?i.jsx(yo,{to:"/login",replace:!0}):n.acessoLiberado?i.jsx(i.Fragment,{children:t}):i.jsx(HC,{})},tl=({children:t})=>{const{role:e}=be();return e!=="ADMIN"?i.jsx(yo,{to:"/dashboard",replace:!0}):i.jsx(i.Fragment,{children:t})},Yu=({children:t})=>{const{role:e}=be();return e!=="ADMIN"&&e!=="SARGENTO"?i.jsx(yo,{to:"/dashboard",replace:!0}):i.jsx(i.Fragment,{children:t})},KC=()=>{const{isAuthenticated:t}=be();return i.jsxs(D2,{children:[i.jsx(dt,{path:"/login",element:i.jsx(ej,{})}),i.jsx(dt,{path:"/protocolo/view/:docId",element:i.jsx(WC,{})}),i.jsxs(dt,{path:"/",element:i.jsx(QC,{children:i.jsx(uC,{})}),children:[i.jsx(dt,{index:!0,element:i.jsx(yo,{to:"/dashboard",replace:!0})}),i.jsx(dt,{path:"dashboard",element:i.jsx(Cj,{})}),i.jsx(dt,{path:"folgas",element:i.jsx(Rj,{})}),i.jsx(dt,{path:"ferias",element:i.jsx(NC,{})}),i.jsx(dt,{path:"calendario",element:i.jsx(vC,{})}),i.jsx(dt,{path:"protocolo",element:i.jsx(LC,{})}),i.jsx(dt,{path:"agenda",element:i.jsx(tl,{children:i.jsx(jC,{})})}),i.jsx(dt,{path:"policiais",element:i.jsx(tl,{children:i.jsx(Pj,{})})}),i.jsx(dt,{path:"grupos",element:i.jsx(tl,{children:i.jsx(RC,{})})}),i.jsx(dt,{path:"creditos",element:i.jsx(tl,{children:i.jsx(AC,{})})}),i.jsx(dt,{path:"historico",element:i.jsx(Yu,{children:i.jsx(Mj,{})})}),i.jsx(dt,{path:"relatorio",element:i.jsx(Yu,{children:i.jsx(_C,{})})}),i.jsx(dt,{path:"relatorio-eap",element:i.jsx(Yu,{children:i.jsx(CC,{})})}),i.jsx(dt,{path:"ajuda",element:i.jsx(Fj,{})})]}),i.jsx(dt,{path:"*",element:i.jsx(yo,{to:t?"/dashboard":"/login"})})]})},XC=()=>{const{loading:t}=Fe();return t?i.jsx("div",{className:"flex h-screen w-screen items-center justify-center bg-pm-gray-100","aria-label":"Carregando sistema SIGMA-E",children:i.jsx("div",{className:"animate-spin rounded-full h-24 w-24 border-t-4 border-b-4 border-pm-blue"})}):i.jsx(KC,{})},YC=()=>(N.useEffect(()=>{"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(t=>{console.log("Service Worker registrado com sucesso:",t)}).catch(t=>{console.log("Falha ao registrar o Service Worker:",t)})})},[]),i.jsx(KT,{children:i.jsx(JT,{children:i.jsx(U2,{children:i.jsx(XC,{})})})})),$w=document.getElementById("root");if(!$w)throw new Error("Could not find root element to mount to");const JC=Ju.createRoot($w);JC.render(i.jsx(Nh.StrictMode,{children:i.jsx(YC,{})}));
